<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Placewise Performance Cloud APIs Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <a href="/">
        <img src="images/logo.svg" alt="Logo" />
      </a>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://accounts.boostcom.com'>Performance Cloud</a></li>
            <li><a href='https://accounts.apac.boostcom.com'>Performance Cloud APAC</a></li>
            <li><a href='https://placewise.com/'>Placewise</a></li>
            <li><hr/></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>This documentation describes Placewise&rsquo;s MPC APIs that allow to manage Loyalty Club, its members and content.</p>

<h2 id="hosts">Hosts</h2>

<p>Production: <a href="https://api.mpc.placewise.com">https://api.mpc.placewise.com</a></p>

<p>Production (APAC region): <a href="https://api.mpc.apac.placewise.com">https://api.mpc.apac.placewise.com</a></p>

<p>Staging: <a href="https://api.mpc.dev.placewise.com">https://api.mpc.dev.placewise.com</a></p>

<h3 id="https-tls-requirement">HTTPS (TLS) requirement</h3>

<p>To make connection to Placewise&rsquo;s MPC APIs you have to use HTTPS with TLS encryption.
Your client has to support TLS1.2+ with strong ciphers.</p>

<h2 id="common-params-and-headers">Common params and headers</h2>

<h3 id="content-type-header">&ldquo;content-type&rdquo; header</h3>

<p>This API supports <code class="prettyprint">application/json</code> only. </p>

<p>Both payload and response body are supposed to be a valid JSON so when making a request send a <code class="prettyprint">content-type: application/json</code> header.</p>

<p>If payload is not a valid JSON, then <code class="prettyprint">406 Not Acceptable</code> HTTP code and empty response body are returned.</p>

<h3 id="x-client-authorization-header">&ldquo;x-client-authorization&rdquo; header</h3>

<blockquote>
<p>Example header: <code class="prettyprint">x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM</code></p>
</blockquote>

<p>All of the endpoints <strong>require</strong> a client authorization header - <code class="prettyprint">x-client-authorization</code>.</p>

<p>It should be used only on backend and never exposed in frontend code.</p>

<p>Each token has are permits assigned to it. Depending what permits are assigned, access to some of the endpoints
may be restricted.</p>

<p>If you miss your authentication token, please <a href="https://placewise.com">let us know</a>.</p>

<h3 id="x-user-agent-header">&ldquo;x-user-agent&rdquo; header</h3>

<blockquote>
<p>Example header: <code class="prettyprint">x-user-agent: Infinity Mall Android App</code></p>
</blockquote>

<p><code class="prettyprint">x-user-agent</code> is <strong>required</strong> to distinguish specific client for information and debugging purposes so we better know who uses the service.</p>

<p>It should be arbitrarily chosen to represent client specifics (e.g. &lsquo;Infinity Mall Android App v1.2&rsquo; or &lsquo;Infinity Mall Backend Service&rsquo;)</p>

<h3 id="x-product-name-header">&ldquo;x-product-name&rdquo; header</h3>

<blockquote>
<p>Example header: <code class="prettyprint">x-product-name: android-app</code></p>
</blockquote>

<p>Each system that is communicating with us should uniquely identify itself so it is possible to distinguish optin/update channels.
That will allow further targeting members by communication channel.</p>

<p>For that we use product name. It should be passed as <strong>required</strong> header <code class="prettyprint">x-product-name</code> that is intended to provide the necessary granularity.</p>

<p>If you miss your product name, please <a href="https://placewise.com">let us know</a>.</p>

<h3 id="authorization-header">&ldquo;authorization&rdquo; header</h3>

<blockquote>
<p>Example header: <code class="prettyprint">authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522</code></p>
</blockquote>

<p>See: <a href="#oauth2">OAuth2</a></p>

<h3 id="loyalty-club-slug-param">Loyalty club slug param</h3>

<blockquote>
<p>Example slug: &lsquo;infinity-mall&rsquo;</p>
</blockquote>

<p>As all of the API endpoints work in the context of specific Loyalty Club, they&rsquo;re scoped within it&rsquo;s identifier - <code class="prettyprint">:loyalty_club_slug</code></p>

<p>It&rsquo;s an unique slugified name of the Loyalty Club.</p>

<h3 id="msisdn-param"><a name="msisdn-param"></a> Msisdn param</h3>

<p>Members in our systems may be identified with their phone numbers (msisdns) according to <a href="https://en.wikipedia.org/wiki/E.164">E.164</a>
We use format without leading <code class="prettyprint">00</code> or <code class="prettyprint">+</code> and without spaces, so that it contains only digits, i.e. <code class="prettyprint">4740485124</code>.</p>

<h2 id="common-http-error-codes">Common HTTP error codes</h2>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">401</code></td>
<td><code class="prettyprint">x-client-authorization</code> is invalid (or doesn&rsquo;t match provided loyalty club or product)</td>
</tr>
<tr>
<td><code class="prettyprint">402</code></td>
<td>Feature is not enabled for the Loyalty Club</td>
</tr>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Not authorized to perform this action (provided <code class="prettyprint">x-client-authorization</code> doesn&rsquo;t have required permit)</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>The requested resource doesn&rsquo;t exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters are provided (e.g. incorrect properties on member creation)</td>
</tr>
<tr>
<td><code class="prettyprint">460</code></td>
<td>OAuth token required for the action is invalid (applies only to OAuth-related actions - see <a href="#oauth2">OAuth2</a>)</td>
</tr>
<tr>
<td><code class="prettyprint">470</code></td>
<td>Some of required header is missing</td>
</tr>
<tr>
<td><code class="prettyprint">471</code></td>
<td>Some of headers is incorrect</td>
</tr>
<tr>
<td><code class="prettyprint">503</code></td>
<td>Server is down for maintenance</td>
</tr>
</tbody></table>

<p>Also, most of handled errors have JSON response body like this:</p>

<p><code class="prettyprint">{&quot;error&quot;: &quot;Message describing what went wrong&quot;}</code></p>

<h2 id="pagination-json-model"><a name="pagination-model"></a> Pagination JSON model</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2050</span><span class="p">,</span><span class="w">
    </span><span class="s2">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"prev_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_first_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_last_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_out_of_range"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Used to present information about paginated pages</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>total_count</td>
<td>integer</td>
<td>Number of all available results</td>
</tr>
<tr>
<td>per_page</td>
<td>integer</td>
<td>Number of results returned per request</td>
</tr>
<tr>
<td>total_pages</td>
<td>integer</td>
<td>Number of all available pages</td>
</tr>
<tr>
<td>current_page</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>next_page</td>
<td>integer</td>
<td>Next available page (<code class="prettyprint">null</code> when it&rsquo;s a last page)</td>
</tr>
<tr>
<td>prev_page</td>
<td>integer</td>
<td>Previous available page (<code class="prettyprint">null</code> when it&rsquo;s a first page)</td>
</tr>
<tr>
<td>is_first_page</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>is_last_page</td>
<td>boolean</td>
<td></td>
</tr>
<tr>
<td>is_out_of_range</td>
<td>boolean</td>
<td>Is given <code class="prettyprint">per_page</code> param out of range?</td>
</tr>
</tbody></table>

<h2 id="invalid-parameters-errors-422"><a name="invalid-parameters-errors-model"></a> Invalid parameters errors (422)</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight javascript"><code><span class="c1">// Considering that request with following payload has been sent:</span>
<span class="p">{</span>
  <span class="s2">"member"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"first_name"</span><span class="p">:</span> <span class="s2">"s"</span><span class="p">,</span>
    <span class="s2">"msisdns"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"123"</span><span class="p">,</span>
      <span class="s2">"4740769126"</span><span class="p">,</span>
      <span class="s2">""</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Following response is returned: </span>
<span class="p">{</span>
  <span class="s2">"error"</span><span class="p">:</span> <span class="s2">"Invalid parameters"</span><span class="p">,</span>
  <span class="s2">"details"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"member"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"name"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"s"</span><span class="p">,</span>
          <span class="s2">"error"</span><span class="p">:</span> <span class="s2">"too_short"</span><span class="p">,</span>
          <span class="s2">"options"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"min_length"</span><span class="p">:</span> <span class="mi">0</span>
          <span class="p">},</span>
          <span class="s2">"message"</span><span class="p">:</span> <span class="s2">"is too short"</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"s"</span><span class="p">,</span>
          <span class="s2">"error"</span><span class="p">:</span> <span class="s2">"invalid_format"</span><span class="p">,</span>
          <span class="s2">"options"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"format"</span><span class="p">:</span> <span class="s2">"/[A-Z][a-z]+/"</span>
          <span class="p">},</span>
          <span class="s2">"message"</span><span class="p">:</span> <span class="s2">"has invalid format"</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">"msisdns"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"0"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">"value"</span><span class="p">:</span> <span class="s2">"32"</span><span class="p">,</span>
            <span class="s2">"error"</span><span class="p">:</span> <span class="s2">"invalid_msisdn"</span><span class="p">,</span>
            <span class="s2">"options"</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">"message"</span><span class="p">:</span> <span class="s2">"is not a valid MSISDN"</span>
          <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">"2"</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">"value"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
            <span class="s2">"error"</span><span class="p">:</span> <span class="s2">"blank"</span><span class="p">,</span>
            <span class="s2">"options"</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">"message"</span><span class="p">:</span> <span class="s2">"cannot be blank"</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// It means that in given payload:</span>
<span class="c1">// * member.name is too short </span>
<span class="c1">// * member.name has invalid format</span>
<span class="c1">// * member.msisdns[0] is not a valid MSISDN</span>
<span class="c1">// * member.msisdns[2] is blank</span>
</code></pre>
<p>Some of the endpoints (it&rsquo;s noted on specific request&rsquo;s description) return invalid parameters errors in the standardized way.</p>

<p>For them, when some of parameter (either JSON body or URL/Query) is invalid, server responds with 422 with a following 
object:  </p>

<table><thead>
<tr>
<th>key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>error</td>
<td>String</td>
<td>Always &ldquo;Invalid parameters&rdquo;</td>
</tr>
<tr>
<td>details</td>
<td>Errors object</td>
<td>See <a href="#errors-object">Errors</a> below</td>
</tr>
<tr>
<td>details.(path.0.to.)parameter_name</td>
<td>Array<ParameterError></td>
<td>See <a href="#parameter-error-object">ParameterError</a> below</td>
</tr>
</tbody></table>

<h4 id="errors-object"><a name="errors-object"></a> Errors object</h4>

<p>It&rsquo;s a recursive tree structure, corresponding to the structure original payload.
Objects being parts of arrays are represented by their array indexes.</p>

<p>Each leaf node is an array of <a href="#parameter-error-object">ParameterError</a> objects for given parameter.</p>

<h4 id="parametererror-object"><a name="parameter-error-object""></a> ParameterError object</h4>

<table><thead>
<tr>
<th>key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>Mixed</td>
<td>Value of given parameter</td>
</tr>
<tr>
<td>error</td>
<td>String</td>
<td>Symbol of error that relates to this parameter</td>
</tr>
<tr>
<td>options</td>
<td>Object</td>
<td>Contains options of specific validation rule. For example <code class="prettyprint">{&quot;max&quot;: 15}</code>.</td>
</tr>
<tr>
<td>message</td>
<td>String</td>
<td>Human-readable error message</td>
</tr>
</tbody></table>

<h4 id="common-validation-errors"><a name="common-validation-errors"></a> Common validation errors</h4>

<table><thead>
<tr>
<th>Error key</th>
<th>Options</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>presence</td>
<td></td>
<td>When not present</td>
</tr>
<tr>
<td>inclusion</td>
<td><code class="prettyprint">in</code> - contains permitted values</td>
<td>When doesn&rsquo;t match list of permitted values</td>
</tr>
<tr>
<td>must_be_an_object</td>
<td></td>
<td></td>
</tr>
<tr>
<td>must_be_an_array</td>
<td></td>
<td></td>
</tr>
<tr>
<td>must_be_an_array_of_objects</td>
<td></td>
<td></td>
</tr>
<tr>
<td>must_have_elements_of_type</td>
<td><code class="prettyprint">type</code> - required type</td>
<td></td>
</tr>
<tr>
<td>not_an_integer</td>
<td></td>
<td></td>
</tr>
<tr>
<td>invalid_msisdn</td>
<td></td>
<td>When cannot be processed as a valid <a href="#msisdn-param">MSISDN</a></td>
</tr>
<tr>
<td>invalid_email</td>
<td></td>
<td></td>
</tr>
<tr>
<td>invalid_iso_8601_time</td>
<td></td>
<td>When not valid according to <a href="#https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a></td>
</tr>
<tr>
<td>attribute_cannot_be_present_with</td>
<td><code class="prettyprint">with</code> - other attribute name</td>
<td>Mutually exclusive with another attribute</td>
</tr>
<tr>
<td>size_too_small</td>
<td><code class="prettyprint">number</code> - min size</td>
<td>When array has not enough elements</td>
</tr>
<tr>
<td>size_too_large</td>
<td><code class="prettyprint">number</code> - max size</td>
<td>When array has too many elements</td>
</tr>
<tr>
<td>size_not_match</td>
<td><code class="prettyprint">number</code> - exact size</td>
<td>When array has not exactly required number of elements</td>
</tr>
<tr>
<td>taken</td>
<td></td>
<td>When another record already uses this value</td>
</tr>
<tr>
<td>not_a_number</td>
<td></td>
<td></td>
</tr>
<tr>
<td>greater_than</td>
<td><code class="prettyprint">number</code> - min value</td>
<td>When not &gt; <code class="prettyprint">number</code></td>
</tr>
<tr>
<td>greater_or_equal_to</td>
<td><code class="prettyprint">number</code> - min value</td>
<td>When not &gt;= <code class="prettyprint">number</code></td>
</tr>
<tr>
<td>less_than</td>
<td><code class="prettyprint">number</code> - max value</td>
<td>When not &lt; <code class="prettyprint">number</code></td>
</tr>
<tr>
<td>less_or_equal_to</td>
<td><code class="prettyprint">number</code> - max value</td>
<td>When not &lt;= <code class="prettyprint">number</code></td>
</tr>
<tr>
<td>invalid</td>
<td><code class="prettyprint">format</code> - regex</td>
<td>When does not match regex</td>
</tr>
<tr>
<td>liquid_syntax_error</td>
<td><code class="prettyprint">syntax_error</code> - error description</td>
<td>When not valid <a href="https://shopify.github.io/liquid/">liquid</a> syntax</td>
</tr>
<tr>
<td>must_be_in_the_future</td>
<td></td>
<td>When date is not in the future</td>
</tr>
<tr>
<td>must_be_in_the_past</td>
<td></td>
<td>When date is not in the past</td>
</tr>
</tbody></table>

          <h1 id="loyalty-clubs-api">Loyalty Clubs API</h1>

<h2 id="loyalty-clubs">Loyalty Clubs</h2>

<h3 id="loyalty-club-model"><a name="loyalty-club-model"></a> Loyalty Club model</h3>

<blockquote>
<p>Loyalty Club example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">235</span><span class="p">,</span><span class="w">
    </span><span class="s2">"community_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3433</span><span class="p">,</span><span class="w">
    </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">447</span><span class="p">,</span><span class="w">
    </span><span class="s2">"main_slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"infinity-mall"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"short_slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iml"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"other_slugs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"infinity"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity Mall"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NO"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"timezone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Europe/Oslo"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"member_identifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"msisdn"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"new_offers_api_enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>community_id</td>
<td>integer</td>
<td>ID of community assigned to the Loyalty Club</td>
</tr>
<tr>
<td>customer_id</td>
<td>integer</td>
<td>ID of customer that the Loyalty Club belongs to</td>
</tr>
<tr>
<td>main_slug</td>
<td>slug</td>
<td>Main LC&rsquo;s slug</td>
</tr>
<tr>
<td>short_slug</td>
<td>slug</td>
<td>Short LC&rsquo;s slug, used in Placewise Shortener</td>
</tr>
<tr>
<td>other_slugs</td>
<td>array<string></td>
<td>May be empty</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>country</td>
<td>string</td>
<td><a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">ISO 3166-1 alpha-2 code</a></td>
</tr>
<tr>
<td>timezone</td>
<td>string</td>
<td><a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">TZ database name</a></td>
</tr>
<tr>
<td>member_identifiers</td>
<td>array<string></td>
<td>May consist of following values: <code class="prettyprint">msisdn</code> and <code class="prettyprint">email</code></td>
</tr>
<tr>
<td>new_offers_api_enabled</td>
<td>bool</td>
<td>Is <a href="#endpoints-offers">New Offers API</a> enabled for this Loyalty Club?</td>
</tr>
</tbody></table>

<h3 id="list"><a name="loyalty-clubs-list"></a> List</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/loyalty_clubs"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"loyalty_clubs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Loyalty</span><span class="w"> </span><span class="err">Club</span><span class="w"> </span><span class="err">model</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">model</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/loyalty_clubs/</code></p>

<p>Returns <a href="#loyalty-club-model">Loyalty Clubs</a> accessible by API client.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>type</td>
<td>enum: [&lsquo;REGULAR&rsquo;, &lsquo;TENANTS&rsquo;, &lsquo;ICOM&rsquo;]</td>
<td>null</td>
<td>When present, filters results by this type</td>
</tr>
<tr>
<td>customer_id</td>
<td>integer</td>
<td>null</td>
<td>When present, filters results by this customer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Loyalty Club</td>
<td>Array<Loyalty Club></td>
<td>Array of <a href="#loyalty-club-model">Loyalty Clubs</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:LoyaltyClubs:ListMine</code> permit
</aside>

<h3 id="get"><a name="loyalty-clubs-get"></a> Get</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/loyalty_clubs/infinity-mall/"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Loyalty</span><span class="w"> </span><span class="err">Club</span><span class="w"> </span><span class="err">model</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/loyalty_clubs/:loyalty_club_slug</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/loyalty_clubs/by_community_id/:community_id</code></p>

<p>Returns basic information about the <a href="#loyalty-club-model">Loyalty Clubs</a>, by one of it&rsquo;s slugs or by it&rsquo;s <code class="prettyprint">community_id</code>.</p>

<aside class="notice">
Requires <code>BL:Api:LoyaltyClubs:Get</code> permit
</aside>

<h2 id="schema">Schema</h2>

<h3 id="get"><a name="loyalty-clubs-schema"></a> Get</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/member_schema"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-04/schema#"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"identifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"email"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"consent1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"required"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"show_in_profile"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"show_at_registration"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"consent2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"required"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"show_in_profile"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"show_at_registration"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"languages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"en"</span><span class="p">,</span><span class="w"> </span><span class="s2">"no"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"default_language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"birthday"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"interests"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"enum"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"bikes_and_cars"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"sportwear"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"birthday"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/member_schema</code></p>

<p>Properties for members are defined as part of the loyalty club they belong to.</p>

<p>To describe member properties we use <a href="http://json-schema.org/documentation.html">JSON Schema</a> definition.
Properties of each member must conform to the defined schema.</p>

<p>We support <strong>JSON schema Draft V4</strong> with format extension for <code class="prettyprint">date</code> (YYYY-MM-DD).</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>identifiers</td>
<td>Fields that are set to identify member</td>
<td>Array<string></td>
</tr>
<tr>
<td>consents</td>
<td>Definition of available consents. Versions are now <code class="prettyprint">&#39;&#39;</code>.</td>
<td>JSON Object</td>
</tr>
<tr>
<td>languages</td>
<td>Languages set up in loyalty club</td>
<td>Array<string></td>
</tr>
<tr>
<td>default_language</td>
<td>Default language used in loyalty club and also used for mappings to Api v2</td>
<td>string</td>
</tr>
<tr>
<td>version</td>
<td>Version of schema, currently the newest is <code class="prettyprint">v2</code></td>
<td>string</td>
</tr>
<tr>
<td>products</td>
<td>Properties scoping and ordering by product name, default one is <code class="prettyprint">default</code></td>
<td>object</td>
</tr>
<tr>
<td>required</td>
<td>Required properties for member</td>
<td>integer (timestamp)</td>
</tr>
<tr>
<td>properties</td>
<td>Properties describing member</td>
<td>object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Schema:Get</code> permit
</aside>

<h2 id="products">Products</h2>

<h3 id="list"><a name="loyalty-clubs-products"></a> List</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/products"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Webforms"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"webforms"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"filtered_member_properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"msisdn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"last_name"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"subproducts"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"is_webform"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Default"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"filtered_member_properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"subproducts"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
        </span><span class="s2">"is_webform"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/products</code></p>

<p>Returns list of Products (AKA Channels, AKA Sources) defined for Loyalty Club.</p>

<h4 id="product-response-model-in-json-array">Product response model (in JSON array)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Product name</td>
<td>string</td>
</tr>
<tr>
<td>slug</td>
<td>Product slug</td>
<td>string</td>
</tr>
<tr>
<td>filtered_member_properties</td>
<td>Member that are available to access (CRUD) for this product. When empty, all properties are available.</td>
<td>Array<string></td>
</tr>
<tr>
<td>subproducts</td>
<td>Subproducts/Subchannels available for the product</td>
<td>Array<string></td>
</tr>
<tr>
<td>is_webform</td>
<td>Is the product also a webform?</td>
<td>boolean</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Products:Index</code> permit
</aside>

<h2 id="translations">Translations</h2>

<h3 id="list"><a name="list-translations"></a> List</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/translations?language=en"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns a response structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"member_properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E-mail"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gender"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"msisdn"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"birthday"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Birthday"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"zip_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Zip code"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Interests"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Last name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"First name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"gender.man"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Man"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"gender.woman"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Woman"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonus_points"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bonus points"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.skincare"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Skincare"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.baby_child"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Baby/Child"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.good_offers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Good offers"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.travel_and_leisure"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Travel and leisure"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.dietary_and_nutrition"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dietary and nutrition"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"interests.health_and_pharmaceuticals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Health and pharmaceuticals"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dmp_profiling"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Would you like to receive personalised offers?"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dmp_profiling.title"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dmp_profiling.no_alt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Are you sure? Ved Ã¥ si nei kan mottar du ikke informasjon og tilbud i andre medier"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dmp_profiling.read_more"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Profiling is our way of personalising offers, info and discounts. Please see our Privacy Policy for more info on how we use data for profiling."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dmp_profiling.__yes__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes, I accept profiling to receive personalised exclusive offers, info and discounts"</span><span class="p">,</span><span class="w">        
        </span><span class="s2">"dmp_profiling.__no__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No, I do not accept profiling to receive personalised exclusive offers, info and discounts"</span><span class="p">,</span><span class="w">                
        </span><span class="s2">"sms_marketing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Do you want to receive exclusive offers via SMS?"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sms_marketing.title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SMS Marketing"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sms_marketing.no_alt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? Are you sure? "</span><span class="p">,</span><span class="w">        
        </span><span class="s2">"sms_marketing.read_more"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">                
        </span><span class="s2">"sms_marketing.__yes__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes, I want to receive exclusive offers via SMS."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sms_marketing.__no__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No, I don't want to receive exclusive offers."</span><span class="p">,</span><span class="w">        
        </span><span class="s2">"email_marketing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Do you want to receive exclusive offers via email? "</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email_marketing.title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Email Marketing"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email_marketing.no_alt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Are you sure? Ved Ã¥ si nei kan mottar du ikke informasjon og tilbud i andre medier"</span><span class="p">,</span><span class="w">        
        </span><span class="s2">"email_marketing.__yes__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email_marketing.__no__"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No, I don't want to receive exclusive offers."</span><span class="p">,</span><span class="w">        
        </span><span class="s2">"email_marketing.read_more"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"doggo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dog"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"piggo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pig"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"terms"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;p&gt;&lt;h3&gt;Privacy Policy&lt;/h3&gt;We strive to protect your privacy&lt;/p&gt;"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/translations</code></p>

<p>Returns translations for the Loyalty Club.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>language</td>
<td>String</td>
<td>(default language configured for Loyalty Club)</td>
<td>Desired language of translations</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>member_properties</td>
<td>Object</td>
<td>no (may be empty)</td>
<td>Translations of member properties</td>
</tr>
<tr>
<td>consents</td>
<td>Object</td>
<td>no (may be empty)</td>
<td>Translations of member consents</td>
</tr>
<tr>
<td>tags</td>
<td>Object</td>
<td>no (may be empty)</td>
<td>Translations of Loyalty Club tags</td>
</tr>
<tr>
<td>terms</td>
<td>string</td>
<td>yes</td>
<td>Translation of Loyalty Club terms</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Translations:Api:Index</code> permit
</aside>

          <h2 id="links"><a name="links"> Links</h2>

<h3 id="link-model"><a name="link-model"></a> Link model</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"about"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"About"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/about"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"push_message_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bar"</span><span class="w"> </span><span class="p">},</span><span class="w">
            </span><span class="s2">"optional_params"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"global"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>slug</td>
<td>string</td>
<td>no</td>
<td>Identifier or Link. Generated from name.</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>no</td>
<td>Must be unique</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>no</td>
<td>Must be unique</td>
</tr>
<tr>
<td>scheme</td>
<td>string</td>
<td>no</td>
<td>When present, link will be generated with this scheme</td>
</tr>
<tr>
<td>push_message_data</td>
<td>Object</td>
<td>yes</td>
<td>When present, it will be sent along push messages that contain this link</td>
</tr>
<tr>
<td>optional_params</td>
<td>array<string></td>
<td>yes</td>
<td>Contains information which link params are optional</td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td>no</td>
<td>Is this a system link?</td>
</tr>
<tr>
<td>global</td>
<td>boolean</td>
<td>no</td>
<td>Is this a global link?</td>
</tr>
<tr>
<td>enabled</td>
<td>boolean</td>
<td>no</td>
<td>Is this link enabled for specific LC?</td>
</tr>
</tbody></table>

<h4 id="enabled-links"><a name="enabled-links"></a> Enabled links</h4>

<p>When link is enabled, it&rsquo;s available in MPC&rsquo;s UI for being used within sending (unless the link is parameterized).</p>

<h4 id="global-links">Global links</h4>

<p>Global links are standard links used within MPC apps. Every LC may be configured to have each of them <a href="#links-enable">enabled</a>.</p>

<p>Non-global links are links created specifically for the Loyalty Club.</p>

<h4 id="system-links">System links</h4>

<p>System links are global links that are essential for LC to operate and are always <a href="#links-enable">enabled</a>..</p>

<h3 id="list"><a name="links-list"></a> List</h3>

<p>Returns all links available within Loyalty Club.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns list of <a href="#link-model">links</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">links</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/links</code></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>links</td>
<td><a href="#link-model">Links</a>[]</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Index</code> permit
</aside>

<h3 id="get"><a name="links-list"></a> Get</h3>

<p>Returns specific link.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links/about"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns <a href="#link-model">link</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Link</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/links/:link_slug</code></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td><a href="#link-model">Link</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Link could not be found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Get</code> permit
</aside>

<h3 id="enable"><a name="links-enable"></a> Enable</h3>

<p>Enables given link - see <a href="#enabled-links">enabled links</a></p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links/about/enable"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns <a href="#link-model">link</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Link</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/infinity-mall/links/:link_slug/enable</code></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td><a href="#link-model">Link</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Link could not be found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Enable</code> permit
</aside>

<h3 id="disable"><a name="links-disable"></a> Disable</h3>

<p>Disables given link - see <a href="#enabled-links">enabled links</a></p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links/about/disable"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns <a href="#link-model">link</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Link</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/infinity-mall/links/:link_slug/disable</code></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td><a href="#link-model">Link</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Link could not be found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Enable</code> permit
</aside>

<h3 id="create"><a name="links-create"></a> Create</h3>

<p>Create a new link for the Loyalty Club. Created link is always <a href="#enabled-links">enabled</a> by default.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    --data-raw <span class="s1">'{
        "link": {
            "name": "My Link",
            "url": "some/url",
            "description": "Oh long johnson",
            "scheme": "my-app"
        }
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns created <a href="#link-model">link</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Link</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>This link <a href="#links-generate">generated</a> by MPC backend will then look like this:</p>
</blockquote>
<pre class="highlight plaintext"><code>my-app://some/url
</code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/infinity-mall/links</code></p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
</tr>
</thead><tbody>
<tr>
<td>link.name</td>
<td>string</td>
<td>yes</td>
</tr>
<tr>
<td>link.url</td>
<td>string</td>
<td>yes</td>
</tr>
<tr>
<td>link.scheme</td>
<td>string</td>
<td>no</td>
</tr>
<tr>
<td>link.description</td>
<td>string</td>
<td>no</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td><a href="#link-model">Link</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Create</code> permit
</aside>

<h3 id="delete"><a name="links-delete"></a> Delete</h3>

<p>Destroys Loyalty Club link.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/links/articles"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns deleted <a href="#link-model">link</a>:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"link"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Link</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Link model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/infinity-mall/links/:link_slug</code></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td><a href="#link-model">Link</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Link could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">405</code></td>
<td>Link cannot be deleted</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Links:Delete</code> permit
</aside>

<h3 id="generate"><a name="links-generate"></a> Generate</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/links/offer_page/generate"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "link_params": {
            "offer_id": 1000487
        }
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a generated link</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://member.dev.bstcm.no/infinity-mall/offers/1000487"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/links/(:link_slug)/generate</code></p>

<p>Returns a generated link to given functionality in MPC, so it may be reached by member.</p>

<p>In standard setup, the returned link is generated in a &ldquo;universal&rdquo; form: it points to our Webforms, but it will be captured by mobile app if 
it&rsquo;s installed on member system.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>link_slug</td>
<td>string</td>
<td>A slug that identifies the link to generate</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>link_params</td>
<td>Object</td>
<td>Params for link generation dependent on specific link definition</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String</td>
<td>The generated link</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Link could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
    Requires <code>BL:Api:Links:Generate</code> permit
</aside> 

          <h1 id="members-api">Members API</h1>

<h2 id="members">Members</h2>

<h3 id="introduction">Introduction</h3>

<h4 id="authentication">Authentication</h4>

<p>Actions related to specific member (the one that is using your application) require to have member authenticated and we implement
OAuth2 flow for this.</p>

<p>See <a href="#oauth2">Members OAuth</a> to see how to authenticate the member with OAuth2.</p>

<h4 id="member-model"><a name="member-model"></a> Member model</h4>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
  </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ola"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nordmann"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"birthday"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1990-10-23"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"interests"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"bikes_and_cars"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sportwear"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"child_birth_years"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">2010</span><span class="p">,</span><span class="w">
      </span><span class="mi">2011</span><span class="p">,</span><span class="w">
      </span><span class="mi">2011</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"consent1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-12-14T21:57:20.063Z"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"consent2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-25T21:57:43.738Z"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"sms_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enabled"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hard_bounced"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"push_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"optin_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"webforms"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"optin_subchannel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"campaign-10-2017"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-01-19T10:07:08.336+01:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-03T09:35:19.313+02:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"banned_until"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2137-04-03T09:35:19.313+02:00"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">99</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Standard member JSON model returned from many API endpoints.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member ID</td>
<td>integer</td>
</tr>
<tr>
<td>properties</td>
<td>Object with member&rsquo;s properties</td>
<td>JSON Object</td>
</tr>
<tr>
<td>properties[&lsquo;language&rsquo;]</td>
<td>Language used by user</td>
<td>string</td>
</tr>
<tr>
<td>consents</td>
<td>Member&rsquo;s consents JSON model (see below)</td>
<td>JSON Object</td>
</tr>
<tr>
<td>sms_status</td>
<td>Status of sms channel</td>
<td>string</td>
</tr>
<tr>
<td>email_status</td>
<td>Status of email channel</td>
<td>string</td>
</tr>
<tr>
<td>push_status</td>
<td>Status of push channel</td>
<td>string</td>
</tr>
<tr>
<td>optin_channel</td>
<td>Channel (<code class="prettyprint">x-product-name</code> header) which had been used to register member</td>
<td>string</td>
</tr>
<tr>
<td>optin_subchannel</td>
<td>Subchannel (<code class="prettyprint">X-Subproduct-Name</code> header) which had been used to register member</td>
<td>string</td>
</tr>
<tr>
<td>created_at</td>
<td>Time when the user was firstly created</td>
<td>string</td>
</tr>
<tr>
<td>updated_at</td>
<td>Time when the user was last updated</td>
<td>string</td>
</tr>
<tr>
<td>banned_until</td>
<td>Time since member was/is banned (not updatable through OAuth)</td>
<td>string</td>
</tr>
<tr>
<td>person_id</td>
<td>Unique Member&rsquo;s identifier (set internally)</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="members-consents-json-model"><a name="member-consents-model"></a> Member&rsquo;s consents JSON model</h4>

<p>JSON model for consents. Keys can be dynamically created based on customer&rsquo;s need.</p>

<p>It consists of: <code class="prettyprint">&#39;consent-slug&#39;: { &quot;status&quot;: &lt;boolean_value&gt;, &quot;updated_at&quot;: &lt;time&gt; }</code></p>

<ul>
<li>If status is <code class="prettyprint">true</code> - Member approved consent.</li>
<li>If status is <code class="prettyprint">false</code> - Member disapproved consent.</li>
<li>If you can&rsquo;t find slug on Member: he/she haven&rsquo;t disapproved or approved consent.</li>
</ul>

<p><code class="prettyprint">updated_at</code> is the time of last consent update. It can be also not provided or null.</p>

<p>Available consents for Loyalty Club are described in <a href="#loyalty-clubs-schema">schema</a>.</p>

<h4 id="validation-on-members">Validation on members</h4>

<p>All members&rsquo; endpoints have properties validation. Properties are validated to conform loyalty club&rsquo;s schema.</p>

<p>If something is wrong, you will receive explanation of errors in response.</p>

<h5 id="schema-validation-errors">Schema validation errors</h5>
<pre class="highlight shell tab-shell"><code>curl -X PUT -H <span class="s2">"x-product-name: custom-product-name"</span> <span class="se">\</span>
    -H <span class="s2">"X-Customer-Private-Token: token"</span> <span class="se">\</span>
    -H <span class="s2">"content-type: application/json"</span> -d <span class="s1">'{
    "properties": {
        "first_name": "",
        "last_name": "err",
        "gender": "man",
        "birthday": "201X-01-01"
    }
}'</span> <span class="s2">"https://tbp.bstcm.no/api/v2/loyalty_clubs/:loyalty_club_slug/members/:msisdn"</span>
</code></pre>
<blockquote>
<p>Example response (with code 400):</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_not_match"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"een"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en, no"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"language"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"optin_channel"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"not_contain_required_property"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optin_channel"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Error</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>invalid_date_format</td>
<td>Invalid date format</td>
</tr>
<tr>
<td>invalid_time_format</td>
<td>Invalid time format</td>
</tr>
<tr>
<td>invalid_date_time_format</td>
<td>Invalid date with time format</td>
</tr>
<tr>
<td>must_be_valid_RFC3339_date_time_string</td>
<td>Format beyond the RFC3339 standard</td>
</tr>
<tr>
<td>invalid_URI</td>
<td>Invalid URI</td>
</tr>
<tr>
<td>additional_array_elements</td>
<td>Additional elements in the array</td>
</tr>
<tr>
<td>additional_properties</td>
<td>Additional properties</td>
</tr>
<tr>
<td>property_not_match_all_of</td>
<td>The property did not match all of the required schemas</td>
</tr>
<tr>
<td>property_not_match_any_of</td>
<td>The property did not match any of the required schema</td>
</tr>
<tr>
<td>property_matched_more_than_one</td>
<td>The property matched more than one of the required schemas</td>
</tr>
<tr>
<td>depends_on_a_missing_property</td>
<td>The validated property has a property that depends on the other missing property</td>
</tr>
<tr>
<td>value_not_match</td>
<td>The property value did not match one of the given values.</td>
</tr>
<tr>
<td>schema_cannot_be_found</td>
<td>The extended schema cannot be found</td>
</tr>
<tr>
<td>not_a_valid_schema</td>
<td>The property was not a valid schema</td>
</tr>
<tr>
<td>minimum_string_length</td>
<td>The property was not of a minimum string length of minimum limit.</td>
</tr>
<tr>
<td>maximum_string_length</td>
<td>The property was not of a maximum string length of maximum limit.</td>
</tr>
<tr>
<td>less_item_than_minimum</td>
<td>The property did not contain a minimum number of minimum items limit</td>
</tr>
<tr>
<td>more_item_than_maximum</td>
<td>The property had more items than the allowed items limit</td>
</tr>
<tr>
<td>less_properties_than_minimum</td>
<td>The property did not contain a minimum number of properties</td>
</tr>
<tr>
<td>more_properties_than_maximum</td>
<td>The property had more properties than allowed</td>
</tr>
<tr>
<td>not_have_value_of_exclusively</td>
<td>The property did not have value of exclusively</td>
</tr>
<tr>
<td>not_have_value_of_inclusively</td>
<td>The property did not have value of inclusively</td>
</tr>
<tr>
<td>more_decimal_places_than_maximum</td>
<td>The property had more decimal places than the allowed maximum</td>
</tr>
<tr>
<td>matched_the_disallowed_schema</td>
<td>The property matched the disallowed schema</td>
</tr>
<tr>
<td>the_regex_not_match</td>
<td>The property did not match the regex</td>
</tr>
<tr>
<td>not_contain_required_property</td>
<td>The validated property did not contain a required property</td>
</tr>
<tr>
<td>contained_undefined_properties</td>
<td>The validated property contained undefined properties</td>
</tr>
<tr>
<td>referenced_schema_cannot_be_found</td>
<td>The referenced schema cannot be found</td>
</tr>
<tr>
<td>invalid_schema</td>
<td>The property was not a valid schema</td>
</tr>
<tr>
<td>matched_one_or_more_types</td>
<td>The property matched one or more of the given types</td>
</tr>
<tr>
<td>one_or_more_types_not_match</td>
<td>The property did not match one or more of the given types</td>
</tr>
<tr>
<td>type_not_match</td>
<td>The property did not match the given type</td>
</tr>
<tr>
<td>contained_duplicated_array_values</td>
<td>The property contained duplicated array values</td>
</tr>
<tr>
<td>invalid_email</td>
<td>Invalid email format</td>
</tr>
<tr>
<td>invalid_mx</td>
<td>Invalid (inaccessible) email domain</td>
</tr>
<tr>
<td>disposable_email</td>
<td>The email was <a href="https://github.com/lisinge/valid_email2/blob/master/vendor/disposable_emails.yml">disposable</a></td>
</tr>
<tr>
<td>duplicated_email</td>
<td>The email was duplicated in community</td>
</tr>
</tbody></table>

<h3 id="list"><a name="members-index"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members?per_page=100&amp;page=1&amp;ids[]=1&amp;ids[]=2"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#member-model">members</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">members</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Member model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members?per_page=:per_page&amp;page=:page</code></p>

<p>Returns paginated list of all Loyalty Club members, sorted by <code class="prettyprint">created_at ASC</code>.</p>

<p>Every returned member is represented by <a href="#member-model">Member model</a>.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>no</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>no</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>ids</td>
<td>Array<integer></td>
<td>no</td>
<td>null</td>
<td>IDs of members that will be returned</td>
</tr>
<tr>
<td>properties[:property_name]</td>
<td>Array<any></td>
<td>no</td>
<td>null</td>
<td>Properties of members that will be returned. A property must be enabled for querying in the Loyalty Club configuration before it can be used here. Please contact us if you need this feature.</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members</td>
<td>Array<Member></td>
<td>Array of <a href="#member-model">Members</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>:per_page param exceeds the limit</td>
</tr>
</tbody></table>

<h4 id="example-queries">Example queries</h4>

<ul>
<li><code class="prettyprint">/members?properties[gender]=man&amp;properties[language][]=en&amp;properties[language][]=pl</code> - returns members with <code class="prettyprint">gender=&quot;man&quot; AND language IN (&quot;en&quot;, &quot;pl&quot;)</code></li>
<li><code class="prettyprint">/members?ids[]=1&amp;ids[]=2</code> - returns members with <code class="prettyprint">id IN (1, 2)</code></li>
</ul>

<aside class="notice">
Requires <code>BL:Api:Members:Index</code> permit
</aside>

<h3 id="get"><a name="members-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/:id"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, returns member object as depicted <a href="#member-model">here</a></p>
</blockquote>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Get</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_msisdn/:msisdn</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Get</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_email/:email</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Get</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth:Get</code> permit
</aside>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
<tr>
<td>msisdn</td>
<td>Member&rsquo;s msisdn</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>See: <a href="#member-model">Member model</a></p>

<h5 id="error-responses">Error responses</h5>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member with given identifier could not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid MSISDN param</td>
</tr>
</tbody></table>

<h3 id="get-public-info"><a name="members-public-info"></a> Get public info</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/:id/public_info"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns hash structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"exists"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"can_login"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">deprecated</span><span class="w">
  </span><span class="s2">"available_identifiers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"email"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"has_password"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id/public_info</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_msisdn/:msisdn/public_info</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_email/:email/public_info</code></p>

<p>Returns basic info for given member. If member does not exist, returns `null&rsquo;.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
<tr>
<td>msisdn</td>
<td>Member&rsquo;s msisdn</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>exists</td>
<td>boolean</td>
<td>Does member with given identifier exist in given Loyalty Club?</td>
</tr>
<tr>
<td>can_login</td>
<td>boolean</td>
<td>Is this member able to sign? (deprecated)</td>
</tr>
<tr>
<td>available_identifiers</td>
<td>string[]</td>
<td>Identifiers that are set on member</td>
</tr>
<tr>
<td>has_password</td>
<td>boolean</td>
<td>Was password set by member?</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Check</code> permit
</aside>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid MSISDN param</td>
</tr>
</tbody></table>

<!--- ############################################################################################################# --->

<h3 id="get-person-id"><a name="members-person-id"></a> Get person id</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/:id/person_id"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns hash structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"storage"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">92</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id/person_id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_msisdn/:msisdn/person_id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_email/:email/person_id</code></p>

<p>Returns <code class="prettyprint">person_id</code> for given member. Please note that <code class="prettyprint">person_id</code> cannot be preset in member payload and will be silently ignored. Also, it cannot be updated.</p>

<blockquote>
<p>There are 4 possible successful responses:</p>

<p>If member currently exists in database:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">92</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>If member does not exist but was deleted in last 30 days:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"storage"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">92</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>If member had existed, was deleted (in last 30 days) and was created again so it exists now:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db_and_cache"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>If member does not exist and never existed or did not exist in last 30 days:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"not_found"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
<tr>
<td>msisdn</td>
<td>Member&rsquo;s msisdn</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>boolean</td>
<td>If query was successful?</td>
</tr>
<tr>
<td>source</td>
<td>string</td>
<td>Source of <code class="prettyprint">person_id</code> (possible values are: <code class="prettyprint">not_found</code>, <code class="prettyprint">db</code>, <code class="prettyprint">storage</code>)</td>
</tr>
<tr>
<td>person_id</td>
<td>integer</td>
<td>Member&rsquo;s <code class="prettyprint">person_id</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Check</code> permit
</aside>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid MSISDN param</td>
</tr>
</tbody></table>

<!--- ############################################################################################################# --->

<h3 id="create"><a name="members-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
curl -X POST <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/members <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: facebook'</span> <span class="se">\</span>
  -H <span class="s1">'X-Subproduct-Name: campaign-10-2017'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'{
    "properties": {
        "email": "dev+6@example.com",
        "msisdn": "4740485124",
        "first_name": "The",
        "last_name": "Doge"
    },
    "consents": {
        "consent1": { "status": true },
        "consent2": { "status": false }
    },
    "send_sms_welcome_message": false
}'</span>

</code></pre>
<blockquote>
<p>When successful, the above command returns created member object as depicted <a href="#member-model">here</a></p>

<p>When payload is invalid, validation errors like this are returned:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">

            </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"duplicated_email_in_community"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members</code></p>

<p>Create member with given properties.</p>

<p>Available properties and their validation rules are defined by Loyalty Club schema (see: <a href="#loyalty-clubs-schema">here</a>).</p>

<p>Actual welcome messages sending depends on Loyalty Club and Product configuration.
For example, even if send_email_welcome_message:true param is provided, message may not be sent because either Product 
or Loyalty has disabled welcome messages or Loyalty Club has no e-mails configured at all.</p>

<p>There is also a possibility to have multiple SMS welcome messages sent. The one that matches Product or default one will be sent.</p>

<h4 id="registration-password"><a name="members-create-registration-password"></a> Registration Password</h4>

<p>Some API clients (depends on Permit assigned to given <code class="prettyprint">x-client-authorization</code> token) may be required to provide 
valid <code class="prettyprint">registration_password</code> param that is sent to user with <a href="#members-send-registration-password">Members &bull; Send registration password</a> </p>

<h4 id="headers">Headers</h4>

<table><thead>
<tr>
<th>Header name</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>X-Subproduct-Name</td>
<td>no</td>
<td>Additional source/optin channel information</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json"><a name="members-create-post-parameters"></a> POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>properties</td>
<td><strong>yes</strong></td>
<td>none</td>
<td>JSON with properties for member</td>
<td>JSON Object</td>
</tr>
<tr>
<td>properties[&lsquo;language&rsquo;]</td>
<td>no</td>
<td>&ldquo;default_language&rdquo; from schema</td>
<td>Language used by user</td>
<td>string</td>
</tr>
<tr>
<td>properties[&lsquo;msisdn&rsquo;]</td>
<td>yes*</td>
<td>none</td>
<td>Unique member&rsquo;s msisdn as defined <a href="#msisdn-param">here</a>) Example: <code class="prettyprint">4740485124</code>.</td>
<td>string</td>
</tr>
<tr>
<td>properties[&lsquo;email&rsquo;]</td>
<td>yes*</td>
<td>none</td>
<td>Member&rsquo;s email</td>
<td>string</td>
</tr>
<tr>
<td>consents</td>
<td>no</td>
<td>{}</td>
<td>Member&rsquo;s consents (similar to <a href="#member-consents-model">Member&rsquo;s consents JSON model</a>)</td>
<td>JSON Object</td>
</tr>
<tr>
<td>sms_enabled</td>
<td>no</td>
<td>true</td>
<td>Should SMS channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>email_enabled</td>
<td>no</td>
<td>true</td>
<td>Should email channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>push_enabled</td>
<td>no</td>
<td>true</td>
<td>Should push channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>send_sms_welcome_message</td>
<td>no</td>
<td>true</td>
<td>Should SMS welcome message be sent to member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>send_email_welcome_message</td>
<td>no</td>
<td>true</td>
<td>Should email welcome be sent to member</td>
<td>Boolean</td>
</tr>
<tr>
<td>password</td>
<td>depends</td>
<td>none</td>
<td>Member&rsquo;s password. Not required, but user won&rsquo;t be able to log in without this when only its email is provided</td>
<td>string</td>
</tr>
<tr>
<td>registration_password</td>
<td>depends</td>
<td>none</td>
<td>Password for registration for member MSISDN verification, see <a href="#members-create-registration-password">above</a></td>
<td></td>
</tr>
</tbody></table>

<p>&ast; At least one of those properties must be provided</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Created member properties - see: <a href="#member-model">Member model</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td><a href="#validation-on-members">validation errors</a> JSON object.</td>
</tr>
<tr>
<td><code class="prettyprint">465</code></td>
<td><code class="prettyprint">registration_password</code> or <code class="prettyprint">password</code> param is missing</td>
</tr>
<tr>
<td><code class="prettyprint">466</code></td>
<td><code class="prettyprint">registration_password</code> param is invalid</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Create</code> or <code>BL:Api:Members:CreateWithVerification</code>permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="update"><a name="members-update"></a> Update</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
curl -X PUT <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/members/:id <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
  <span class="s1">'{
    "properties": {
      "last_name": "Doge"
    },
    "password": "new_password"
  }'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns updated member object as depicted <a href="#member-model">here</a></p>

<p>When payload is invalid, validation errors as depicted <a href="#members-create">here</a></p>
</blockquote>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Update</code> permit
</aside>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me</code> <a href="#oauth2">OAuth</a></p>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth:Update</code> permit.
</aside>

<p>Update member&rsquo;s properties, consents and other with given ones.</p>

<p>It is intended for partial updates:
* not given properties are neither deleted nor overwritten,
* not given attributes (like consents) won&rsquo;t be changed in any way.</p>

<p>If deleting properties is intended, their value should be sent as <code class="prettyprint">null</code>.</p>

<p>This endpoint may return validation errors (<code class="prettyprint">422</code>) even for current member properties. 
That&rsquo;s because loyalty club schema may get changed over time which results in invalidating existing users.</p>

<p>To bypass such validation errors, you may provide <code class="prettyprint">validate_partially: true</code> param which will validate and update only 
attributes that were provided in payload. </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="put-parameters-json">PUT Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>properties</td>
<td>JSON with properties for member</td>
<td>JSON Object</td>
<td>null</td>
</tr>
<tr>
<td>consents</td>
<td>Member&rsquo;s consents (similar to <a href="#member-consents-model">Member&rsquo;s consents JSON model</a>)</td>
<td>JSON Object</td>
<td>null</td>
</tr>
<tr>
<td>password</td>
<td>Member&rsquo;s password</td>
<td>string</td>
<td>null</td>
</tr>
<tr>
<td>sms_enabled</td>
<td>Should SMS channel be enabled for member?</td>
<td>Boolean</td>
<td>null</td>
</tr>
<tr>
<td>email_enabled</td>
<td>Should email channel be enabled for member?</td>
<td>Boolean</td>
<td>null</td>
</tr>
<tr>
<td>push_enabled</td>
<td>Should push channel will be enabled for member?</td>
<td>Boolean</td>
<td>null</td>
</tr>
<tr>
<td>validate_partially</td>
<td>Should only provided data be validated?</td>
<td>Boolean</td>
<td>false</td>
</tr>
<tr>
<td>event_occurred_at</td>
<td>See: <a href="#member-event-occured-at-param"><code class="prettyprint">event_occurred_at</code> param</a></td>
<td>Date</td>
<td>(current time)</td>
</tr>
</tbody></table>

<h5 id="event_occurred_at-param"><a name="member-event-occured-at-param"></a> <code class="prettyprint">event_occurred_at</code> param</h5>

<p>When actual member data change occurred at the time different than request&rsquo;s time, you can utilize the `event_occurred_at&rsquo; param to pass
the actual update time.</p>

<p>This may be relevant when you want this to be reflected in the member&rsquo;s changes history.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Member properties after update - see: <a href="#member-model">Member model</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><a href="#validation-on-members">validation errors</a> JSON object.</td>
</tr>
</tbody></table>

<!--- ############################################################################################################# --->

<h3 id="update-password"><a name="me-update-password"></a> Update password</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/members/me/update_password <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
  -d <span class="se">\</span>
  <span class="s1">'{
      "current_password": "123"
      "password": "SuperStrongP4ssw0rd"
  }'</span>
</code></pre>
<blockquote>
<p>Always returns an empty object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/update_password</code> <a href="#oauth2">OAuth</a></p>

<p>Updates members&rsquo;s password.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>password</td>
<td>Member&rsquo;s new password</td>
<td>string</td>
</tr>
<tr>
<td>current_password</td>
<td>Member&rsquo;s current password</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member associated with given Authorization token does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid password - returns <a href="#validation-on-members">validation errors</a> JSON object.</td>
</tr>
<tr>
<td><code class="prettyprint">460</code></td>
<td>Member not authorized (Invalid or expired OAuth token)</td>
</tr>
<tr>
<td><code class="prettyprint">464</code></td>
<td>Invalid current_password</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth:UpdatePassword</code> permit.
</aside>

<h3 id="update-app-token"><a name="members-update-app-token"></a> Update app token</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
curl -X PUT <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/members/:id/update_app_token <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
  <span class="s1">'{
     "app_token": "tok3n",
     "app_platform": "android"
   }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid, returns error response (422)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid parameters"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"app_token"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"must be a string"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"app_platform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"must be one of: android, ios"</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id/update_app_token</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:UpdateAppToken</code> permit
</aside>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/update_app_token</code> <a href="#oauth2">OAuth</a></p>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth:UpdateAppToken</code> permit
</aside>

<p>Updates member&rsquo;s Firebase token, along with platform it&rsquo;s that it&rsquo;s associated with. </p>

<p>Token may be removed by sending it as empty string or null, empty payload will also be treated as token removal.
Platform is automatically removed when token is empty.</p>

<h4 id="put-parameters-json">PUT Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>app_token</td>
<td>string</td>
<td>Firebase push token</td>
</tr>
<tr>
<td>app_platform</td>
<td>string</td>
<td>One of: <code class="prettyprint">[&#39;android&#39;, &#39;ios&#39;]</code></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<!--- ############################################################################################################# --->

<h3 id="destroy"><a name="members-destroy"></a> Destroy</h3>

<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:id</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Destroy</code> permit
</aside>

<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me</code> <a href="#oauth2">OAuth</a></p>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth:Destroy</code> permit.
</aside>

<p>Permanently removes member.</p>

<p>It is possible to trigger optout message by setting <code class="prettyprint">send_unsubscribe_message=true</code> query string parameter.
Same as welcome messages, optout messages sending also depends on Loyalty Club and Product configuration.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
    <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/:id"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, the above command returns destroyed member object as depicted <a href="#member-model">here</a></p>
</blockquote>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>send_email_unsubscribe_message</td>
<td>no</td>
<td>true</td>
<td>Should optout email be sent to member?</td>
<td>Boolean</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Properties of member that has been destroyed - see: <a href="#member-model">Member model</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><a href="#validation-on-members">validation errors</a> JSON object.</td>
</tr>
</tbody></table>

<!--- ############################################################################################################# --->

<h3 id="validate"><a name="members-validate"></a> Validate</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
curl -X POST <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/members/validate <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: android-app'</span> <span class="se">\</span>
  -H <span class="s1">'X-Subproduct-Name: campaign-10-2017'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'{
    "properties": {
        "gender": "wrong",
        "email": "foo@ba.r.ba.z"
    },
    "registration_password": "a145"
  }'</span>

</code></pre>
<blockquote>
<p>When data is valid, returns JSON object structured like this </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"valid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When data is not valid, returns JSON object structured like this </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"valid"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="p">{</span><span class="w"> </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_not_match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gender"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wrong"</span><span class="p">,</span><span class="w"> </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="s2">"man, woman"</span><span class="w"> </span><span class="p">}</span><span class="w">
                    </span><span class="p">]</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid_mx"</span><span class="p">,</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"registration_password"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invalid"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/validate</code></p>

<p>Checks if given data is valid for new member registration. Returns successful response (200), regardless of data validity.</p>

<h4 id="about-partial-validation-mechanism">About partial validation mechanism</h4>

<p>Only properties which keys are present in given payload will be checked against presence validation.</p>

<p>For example, let&rsquo;s say that Loyalty Club configuration requires member to have <code class="prettyprint">msisdn</code> property set.</p>

<ul>
<li>if <code class="prettyprint">&quot;msisdn&quot;: &quot;&quot;</code> or<code class="prettyprint">&quot;msisdn&quot;: null</code>&ldquo; is present in the payload, the validation will return error stating that <code class="prettyprint">msisdn</code> must be present.</li>
<li>however, when payload doesn&rsquo;t include the <code class="prettyprint">msisdn</code> key, such error will not be returned.</li>
</ul>

<p>This behaviour has been designed to allow validate member partially, property by property. This way you can choose 
what values should be validated at specific point of registration.</p>

<h4 id="post-parameters-json"><a name="members-validate-post-parameters"></a> POST Parameters (JSON)</h4>

<p>Following keys of <a href="#members-create-post-parameters">Members &bull; Create</a> payload are supported when validating:</p>

<ul>
<li>properties</li>
<li>consents</li>
<li>registration_password</li>
</ul>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>valid</td>
<td>boolean</td>
<td>Is the data valid?</td>
</tr>
<tr>
<td>errors</td>
<td>object</td>
<td><a href="#validation-on-members">validation errors</a> JSON object, <code class="prettyprint">null</code> when data is valid</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Validate</code> permit
</aside>

<h3 id="reset-password"><a name="members-reset-password"></a> Reset password</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/members/by_email/:email/reset_password"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "password": "new_password",
      "token": "k4wort03j2"
    }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_email/:email/reset_password</code></p>

<p>Updates given member password if token is valid.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>password</td>
<td>Member&rsquo;s new password</td>
<td>string</td>
</tr>
<tr>
<td>token</td>
<td>Confirmation token generated and sent with <a href="#members-send-password-reset-token">Members &bull; Send password reset token</a></td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td><code class="prettyprint">password</code> or <code class="prettyprint">token</code> param is missing</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member could not be found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid password - returns <a href="#validation-on-members">validation errors</a> JSON object.</td>
</tr>
<tr>
<td><code class="prettyprint">463</code></td>
<td>Invalid confirmation token</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:ResetPassword</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="send-password-reset-token"><a name="members-send-password-reset-token"></a> Send password reset token</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/by_email/joe@example.com/send_password_reset_token"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Always returns an empty JSON object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_email/:email/send_password_reset_token</code></p>

<p>Sends password reset link to given e-mail address if it is associated with member in given loyalty club.</p>

<p>The e-mail contains a token generated for member, valid for 24 hours.</p>

<p>The token can be then used to reset password with <a href="#members-reset-password">Members &bull; Reset password</a>.
It also may be verified with <a href="#members-verify-token">Members &bull; Verify token</a></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Tokens:Create</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="send-one-time-password-sms"><a name="members-send-one-time-password"></a> Send one time password SMS</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/by_msisdn/4740485124/send_one_time_password"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_one_time_password</code></p>

<p>Sends an SMS to given msisdn if it is associated with member in given loyalty club.</p>

<p>The SMS contains 4-digit One-Time-Password generated for member, valid for 1 hour.</p>

<p>This password then can be used to sign in, just as &quot;regular&rdquo; member password - see:  <a href="#token-create">OAuth Token &bull; Create</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>msisdn</td>
<td>Member&rsquo;s msisdn</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:CreateOneTimePassword</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="send-one-time-password-e-mail"><a name="members-send-one-time-password-email"></a> Send one time password E-mail</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/by_email/user@example.com/send_one_time_password"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Always returns an empty JSON object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_one_time_password</code></p>

<p>Sends a &ldquo;Login&rdquo; e-mail to given address if it is associated with member in given loyalty club. The e-mail contains a deep link to the mobile app.</p>

<p>The link scheme is: <code class="prettyprint">https://&lt;app_scheme&gt;.al.bstcm.no/lgn?member_id=&lt;member_id&gt;&amp;otp=&lt;otp&gt;</code> and contains member id and 16-digit password generated for member, valid for 1 hour.  </p>

<p>Those params then can be used to sign in the user, just as &ldquo;regular&rdquo; member password - see:  <a href="#token-create">OAuth Token &bull; Create</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>e-mail</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid e-mail param</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:CreateOneTimePassword</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="send-registration-password"><a name="members-send-registration-password"></a> Send registration password</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/by_msisdn/4740485124/send_registration_password"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "language": "en"
     }'</span>
</code></pre>
<blockquote>
<p>Always returns an empty JSON object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_registration_password</code></p>

<p>Sends SMS to given MSISDN.</p>

<p>The sent message contains 4-digit registration password, valid for 10 minutes.</p>

<p>This password may be required for member registration - see: <a href="#members-create-registration-password">Registration password</a></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>msisdn</td>
<td>MSISDN</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
</tbody></table>

<h4 id="post-parameters">POST Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>language</td>
<td>Language of the registration password message. When not provided, default LC language will be used</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid MSISDN param</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:CreateRegistrationPassword</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="verify-token"><a name="members-verify-token"></a> Verify token</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/by_email/joe@example.com/verify_token/password_reset/k4wort03j2"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"valid"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/by_email/:email/verify_token/:type/:token</code></p>

<p>Verifies given member token. Returns response indicating if given token is (still) valid.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
<tr>
<td>type</td>
<td>Token type</td>
<td><code class="prettyprint">password_reset</code> (more types in future)</td>
</tr>
<tr>
<td>token</td>
<td>Token</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>valid</td>
<td>boolean</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td>Invalid <code class="prettyprint">type</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Tokens:Verify</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="send-msisdn-verification-sms"><a name="members-send-verification-sms"></a> Send MSISDN verification SMS</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/channels/msisdn/4740485124/send_verification"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "for_mobile_app": false
    }'</span>
</code></pre>
<p><strong>PUT</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/channels/msisdn/:msisdn/send_verification</code></p>

<p>Generates a verification token for member identified by given MSISDN and sends it to him with an SMS message.
The token is valid for 30 days.</p>

<p>By default, a link to Webforms is sent.
When <code class="prettyprint">for_mobile_app = true</code> param is provided, a deep link to mobile app is generated instead.</p>

<h4 id="put-body-parameters">PUT body parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>for_mobile_app</td>
<td>boolean</td>
<td>no</td>
<td>false</td>
<td>Should a deep-link to mobile app be generated?</td>
</tr>
</tbody></table>

<h4 id="response">Response</h4>

<p>Always returns <code class="prettyprint">204 (No content)</code></p>

<aside class="notice">
Requires <code>BL:Api:Members:Msisdns:Verify</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="verify-msisdn"><a name="members-verify-msisdn"></a> Verify MSISDN</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/channels/msisdn/4740485124/verify"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "token": "shNWPezzYoIuJV2qDIcQrdFQqUdlVdquwUJrNb2Nuw"
    }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/channels/msisdn/:msisdn/verify</code></p>

<p>Uses given token (sent with <a href="#members-send-verification-sms">Members &bull; Send MSISDN verification SMS</a>) to verify
user identified with given MSISDN.</p>

<h4 id="put-body-parameters">PUT body parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>token</td>
<td>string</td>
<td>yes</td>
<td>Token generated and sent with <a href="#members-send-verification-sms">Members &bull; Send MSISDN verification SMS</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td>Token missing</td>
</tr>
<tr>
<td><code class="prettyprint">463</code></td>
<td>Invalid token (it may not exist, or not match the user or be expired)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Msisdns:Verify</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="get-id-of-stores-assigned-to-member"><a name="members-stores-get"></a> Get id of stores assigned to member</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/12345/stores"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"stores_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/:member_id/stores</code></p>

<p>Show id of stores assigned to member</p>

<aside class="notice">
Requires <code>BL:Api:Members:Stores:Index</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="assign-member-to-stores"><a name="members-stores-add"></a> Assign member to stores</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/12345/stores"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "stores_ids": [1, 2]
    }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"stores_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/:member_id/stores</code></p>

<p>Assing stores to member using stores ids</p>

<h4 id="post-body-parameters">POST body parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>stores_ids</td>
<td>array</td>
<td>yes</td>
<td>Id of stores</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td>Stores ids missing</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Stores:Create</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="remove-stores-to-member"><a name="members-stores-remove"></a> Remove stores to member</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/12345/stores"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "stores_ids": [1, 2]
    }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"stores_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/:member_id/stores</code></p>

<p>Remove stores assigned from member</p>

<h4 id="delete-body-parameters">DELETE body parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>stores_ids</td>
<td>array</td>
<td>yes</td>
<td>Id of stores</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td>Stores ids missing</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Stores:Destroy</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="transform-member-to-user"><a name="members-user-create"></a> Transform member to user</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
  <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/12345/user"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Bearer B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "role": "role"
    }'</span>
</code></pre>
<blockquote>
<p>When successful, returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created-user-id"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">/v3/:loyalty_club_slug/members/:member_id/user</code></p>

<p>Transform member (tenant contact) to user and return user id</p>

<h4 id="post-body-parameters">POST body parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>role</td>
<td>string</td>
<td>yes</td>
<td>role</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">400</code></td>
<td>Role missing</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:User:Create</code> permit
</aside>

          <h2 id="members-oauth"><a name="oauth2"></a> Members OAuth</h2>

<blockquote>
<p>Example header: <code class="prettyprint">authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522</code></p>
</blockquote>

<p>Actions related to specific member (the one that is using your application) require to have member authenticated and we implement
OAuth2 flow for this.</p>

<p>To authorize those actions, we <strong>require</strong> <code class="prettyprint">authorization</code> header that should contain: <code class="prettyprint">Bearer :access_token</code>. </p>

<p>Look at <a href="#token-create">OAuth Token &bull; Create</a> to see how to obtain the :access_token.</p>

<h3 id="create-token"><a name="token-create"></a> Create token</h3>

<blockquote>
<p>Create token example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/oauth/token"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'{
      "grant_type": "password",
      "identifier_type": "id",
      "identifier": 42,
      "password": "123"
    }'</span>
</code></pre>
<blockquote>
<p>Refresh token example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/oauth/token"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'{
      "grant_type": "refresh_token",
      "refresh_token": "36c636e4290d28488a13691afce351397bec21b1246c2c7896a8262d9bfbc4c4"
    }'</span>
</code></pre>
<blockquote>
<p>When successful, both commands return JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"af9e5361cd7e083dfa4132df3ea7ab82fac21496991632a9994a8c2a9f33884f"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
  </span><span class="s2">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"36c636e4290d28488a13691afce351397bec21b1246c2c7896a8262d9bfbc4c4"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1506523094</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resource_owner_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/oauth/token</code></p>

<p>Creates a new access token by one of two methods (grant types):</p>

<ul>
<li><code class="prettyprint">password</code> - token is issued by providing user credentials</li>
<li><code class="prettyprint">refresh_token</code> - token is issued by providing refresh token obtained from <code class="prettyprint">password</code> grant type </li>
</ul>

<h4 id="creating-token-password-grant">Creating token (<code class="prettyprint">password</code> grant)</h4>

<p>When creating new access token, <code class="prettyprint">&quot;grant_type&quot;: &quot;password&quot;</code> should be given along with member credentials (see example on the right).</p>

<p>In response, two tokens are returned:</p>

<ul>
<li><code class="prettyprint">access_token</code> that is valid for <strong>24 hours</strong> - may be used to authenticate member in member-related actions (see: <a href="#oauth2">OAuth2</a>).</li>
<li><code class="prettyprint">refresh_token</code> which is valid for <strong>1 year</strong> - may be used to get a new access token (with <code class="prettyprint">refresh_token</code> grant)</li>
</ul>

<p>Also, <code class="prettyprint">resource_owner_id</code> is returned, is an ID of member that the token has been issued for. </p>

<h4 id="refreshing-token-refresh_token-grant">Refreshing token (<code class="prettyprint">refresh_token</code> grant)</h4>

<p>You can obtain a new token after (or before) it&rsquo;s expiration time, by using <code class="prettyprint">refresh_token</code> grant.</p>

<p>Param <code class="prettyprint">grant_type: &quot;refresh_token&quot;</code> must be provided along with <code class="prettyprint">refresh_token: &quot;:refresh_token&quot;</code>  (see example on the right).</p>

<p>It returns a token response, same as for <code class="prettyprint">password</code> grant, but with new tokens.</p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
<th>For grant type</th>
</tr>
</thead><tbody>
<tr>
<td>grant_type</td>
<td>type of grant</td>
<td>enum: <code class="prettyprint">password</code>, <code class="prettyprint">refresh_token</code></td>
<td>-</td>
</tr>
<tr>
<td>identifier_type</td>
<td>identifier type that user should be retrieved by</td>
<td>enum: <code class="prettyprint">id</code>, <code class="prettyprint">email</code>, <code class="prettyprint">msisdn</code></td>
<td><code class="prettyprint">password</code></td>
</tr>
<tr>
<td>identifier</td>
<td>value of member identifier</td>
<td>mixed (e.g. <code class="prettyprint">134123123</code>, <code class="prettyprint">+47123456789</code> or <code class="prettyprint">alice@example.com</code>)</td>
<td><code class="prettyprint">password</code></td>
</tr>
<tr>
<td>password</td>
<td>member password, One-Time-Password or Registration Password</td>
<td>string</td>
<td><code class="prettyprint">password</code></td>
</tr>
<tr>
<td>refresh_token</td>
<td>refresh token</td>
<td>string</td>
<td><code class="prettyprint">access_token</code></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>Token that member can be authenticated with</td>
<td>string</td>
</tr>
<tr>
<td>token_type</td>
<td>Always &ldquo;bearer&rdquo;</td>
<td>string</td>
</tr>
<tr>
<td>expires_in</td>
<td>Seconds for how long token will be valid</td>
<td>integer (seconds)</td>
</tr>
<tr>
<td>refresh_token</td>
<td>Token that may be used to issue a new :access_token</td>
<td>string</td>
</tr>
<tr>
<td>created_at</td>
<td>When the token has been created</td>
<td>integer (timestamp)</td>
</tr>
<tr>
<td>resource_owner_id</td>
<td>ID of member that the token has been for</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">461</code></td>
<td>Invalid member credentials provided for <code class="prettyprint">password</code> grant. Either member could not be found or password is wrong</td>
</tr>
<tr>
<td><code class="prettyprint">462</code></td>
<td>Invalid refresh_token provided for <code class="prettyprint">refresh_token</code> grant (may be expired)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="revoke-token"><a name="token-revoke"></a> Revoke token</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/oauth/revoke"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'{
      "token": "36c636e4290d28488a13691afce351397bec21b1246c2c7896a8262d9bfbc4c4" 
    }'</span>
</code></pre>
<blockquote>
<p>Always returns an empty JSON object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/oauth/revoke</code></p>

<p>Revokes a token (access or refresh). </p>

<p>Always returns an empty JSON object (even if given token is invalid).</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>token</td>
<td>access or refresh token obtained from <a href="#token-create">OAuth Token &bull; Create</a></td>
<td>string</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="get-token-info"><a name="token-info"></a> Get token info</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/oauth/token/info"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span>

</code></pre>
<blockquote>
<p>When successful, return JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"resource_owner_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ID</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">member</span><span class="w"> </span><span class="err">that</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">token</span><span class="w"> </span><span class="err">has</span><span class="w"> </span><span class="err">been</span><span class="w"> </span><span class="err">issued</span><span class="w"> </span><span class="err">for</span><span class="w">
    </span><span class="s2">"scopes"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"expires_in_seconds"</span><span class="p">:</span><span class="w"> </span><span class="mi">73614</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Seconds</span><span class="w"> </span><span class="err">until</span><span class="w"> </span><span class="err">expiration</span><span class="w">
    </span><span class="s2">"application"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"uid"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="mi">1506516784</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/oauth/token/info</code></p>

<p>Returns info of given token (not refresh token) from <code class="prettyprint">authorization</code> header.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>resource_owner_id</td>
<td>ID of member that the token has been for</td>
<td>integer</td>
</tr>
<tr>
<td>scopes</td>
<td>Not implemented</td>
<td>Array<string></td>
</tr>
<tr>
<td>expires_in_seconds</td>
<td>Seconds for how long token will be valid</td>
<td>integer (seconds)</td>
</tr>
<tr>
<td>application</td>
<td>Not implemented</td>
<td>Object</td>
</tr>
<tr>
<td>created_at</td>
<td>When the token has been created</td>
<td>integer (timestamp)</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">460</code></td>
<td>Token from <code class="prettyprint">authorization</code> is invalid (or expired)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:OAuth</code> permit
</aside>

<!--- ############################################################################################################# --->

          <h2 id="members-messages"><a name="members-messages"></a> Members Messages</h2>

<h3 id="introduction"><a name="member-messages-introduction"> Introduction</h3>

<h4 id="membermessage-model"><a name="member-message-model"></a> MemberMessage model</h4>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MTE0NTc1Mg"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"push"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-08-05T05:38:12"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"You have just received 9 points."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Required?</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Message ID</td>
<td>yes</td>
<td>string</td>
</tr>
<tr>
<td>type</td>
<td>Object with member&rsquo;s properties</td>
<td>yes</td>
<td>enum: [&ldquo;sms&rdquo;, &ldquo;email&rdquo;, &ldquo;push&rdquo;]</td>
</tr>
<tr>
<td>created_at</td>
<td>Time when the message has been sent</td>
<td>yes</td>
<td>string</td>
</tr>
<tr>
<td>content</td>
<td></td>
<td>yes</td>
<td>string</td>
</tr>
</tbody></table>

<h3 id="list-member-messages"><a name="members-messages-list"></a> List Member Messages</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/509134/messages"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#member-message-model">member messages</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">members</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Member message"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/messages</code></p>

<p>Returns messages sent to given Member from our system, after merging properties and shortening urls so this is the content Member received. 
Does not translate id to other identifiers and vice versa. If no messages are found, returns an empty <code class="prettyprint">messages</code> array. </p>

<p><strong>Messages are removed when Member is deleted.</strong></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required?</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>Member ID</td>
<td>yes</td>
<td>integer</td>
</tr>
<tr>
<td>per_page</td>
<td>Number of results to be returned per request</td>
<td>no</td>
<td>integer</td>
</tr>
<tr>
<td>page_no</td>
<td>Number of results page</td>
<td>no</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>messages</td>
<td>Array<MemberMessage></td>
<td>Array of <a href="#member-message-model">MemberMessages</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Pagination</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:MessagesHistory:List</code> permit
</aside>

<!--- ############################################################################################################# --->

<h3 id="get-member-message"><a name="members-message-get"></a> Get Member Message</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/509134/messages/MTE0NTc1Mg"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns <a href="#member-message-model">member message</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">MemberMessage</span><span class="w"> </span><span class="err">record</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberMessage model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/messages/:id</code></p>

<p>Returns specific message sent to member.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Required?</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>Member ID</td>
<td>yes</td>
<td>integer</td>
</tr>
<tr>
<td>id</td>
<td>Message ID</td>
<td>yes</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>MemberMessage</td>
<td><a href="#member-message-model">MemberMessage</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Message not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:MessagesHistory:Get</code> permit
</aside>

<!--- ############################################################################################################# --->

          <h2 id="members-imports">Members Imports</h2>

<h3 id="introduction"><a name="members-imports-import-flow"></a> Introduction</h3>

<h5 id="import-bulks">Import bulks</h5>

<p>At most 1000 member records may be sent in one request.</p>

<p>If you intend to import more than that, you may group them by <code class="prettyprint">import_id</code>, so multiple bulks will be grouped into one import.</p>

<p>Nevertheless, keep in mind, that import always consists of at least one bulk.</p>

<h5 id="import-statuses">Import statuses</h5>

<p>Each bulk is processed by an asynchronous job, so you need to check it&rsquo;s status some time after sending a request.</p>

<p>For that, you should firstly check the import status <a href="#members-imports-status">here</a> and then 
check bulks details for each bulk <a href="#members-imports-bulk-status">here</a>.</p>

<p>Please note that:</p>

<ul>
<li>We recommend to check status in intervals not smaller than 5 seconds</li>
<li>In extreme cases, it make take even few hours for bulk to be fully processed</li>
<li>24 hours after import request any potential personal data (contained in <code class="prettyprint">member_payloads</code> and <code class="prettyprint">errors</code>) is permanently removed from server</li>
</ul>

<h5 id="bulk-statuses">Bulk statuses</h5>

<p>When bulk is created, it gets <code class="prettyprint">waiting</code> status.</p>

<p>When bulk has been picked by asynchronous job, it transitions into <code class="prettyprint">working</code> status.
Depending on the server load, it may get picked instantly or even after few hours in extreme cases.</p>

<p>When the job has been executed successfully (which make take up to few minutes), bulk will have <code class="prettyprint">finished</code> status assigned.
Please note that it doesn&rsquo;t mean that members have been successfully processed (there may be even none), you&rsquo;ll need to check bulk status
for errors.</p>

<p>When job failed for some internal reason, it will have either <code class="prettyprint">failed</code> or <code class="prettyprint">waiting_for_retry</code> status. See below
for more details.  </p>

<h5 id="asynchronous-job-failures">Asynchronous job failures</h5>

<p>Jobs that couldn&rsquo;t be processed because of some internal reasons will be retried up to 5 times.</p>

<p>After each failure, the bulk will have <code class="prettyprint">waiting_for_retry</code> status assigned and it&rsquo;s <code class="prettyprint">retries</code> attribute will be incremented.</p>

<p>After 5th failure, the bulk will have <code class="prettyprint">failed</code> status assigned. In such case, please contact us, so we may identify 
and resolve the problem.</p>

<h3 id="send-import-request"><a name="members-imports"></a> Send import request</h3>

<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/imports</code></p>

<p>Creates new members or updates existing ones (based on <code class="prettyprint">msisdn</code> and <code class="prettyprint">e-mail</code> identifiers).</p>

<p>There is a maximum number of members that can be sent in one request (1000). So, if you intend to import more than 
that, you may want to identify all bulks with the same <code class="prettyprint">import_id</code> and pass consequent <code class="prettyprint">request_number</code> to each of them.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
    <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/imports"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
  -d <span class="se">\</span>
    <span class="s1">'{
      "import_id": "import_21",
      "request_number": 3,
      "only_create": false,
      "members": [
        {
          "properties": { "email": "foo@bar.baz" },
          "password": "pass",
          "sms_enabled": true,
          "email_enabled": true,
          "push_enabled": true,
          "optin_channel": true,
          "optin_subchannel": true,
          "created_at": "foo",
          "updated_at": "bar",
          "consents": { "email_marketing": { "status": true } }
        }
      ]
    }'</span>    
</code></pre>
<blockquote>
<p>When successful, JSON will be returned:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"import_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a9a00143-6488-4d4f-87d4-29c2da02d678"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When input is invalid, returns the error object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"duplicated_msisdns"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>import_id</td>
<td>no</td>
<td>auto-generated</td>
<td>When you&rsquo;re making more than one call you can consider adding it. Otherwise it will be auto-generated</td>
<td>String</td>
</tr>
<tr>
<td>request_number</td>
<td>no</td>
<td>-</td>
<td>A number that you can use for bulk identification in &ldquo;Status&rdquo; endpoint. It&rsquo;s up to you to provide it&rsquo;s uniqueness. Useless without specifying <code class="prettyprint">import_id</code></td>
<td>Integer</td>
</tr>
<tr>
<td>members</td>
<td>yes</td>
<td>-</td>
<td>Array with members payloads - See below</td>
<td>Array <JSON Object></td>
</tr>
<tr>
<td>only_create</td>
<td>no</td>
<td>false</td>
<td>When true, it does not update members</td>
<td>Boolean</td>
</tr>
</tbody></table>

<h5 id="members-array">Members Array</h5>

<p>General requirements:</p>

<ul>
<li>all members must have unique identifiers (<code class="prettyprint">msisdn</code> or <code class="prettyprint">email</code>)</li>
<li>maximum number of items in array is 1000</li>
</ul>

<table><thead>
<tr>
<th>Key</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>properties</td>
<td>yes</td>
<td>-</td>
<td>JSON with properties for member (see: <a href="#member-model">Member model</a></td>
<td>JSON Object</td>
</tr>
<tr>
<td>properties[&lsquo;msisdn&rsquo;]</td>
<td>yes*</td>
<td>none</td>
<td>Unique member&rsquo;s msisdn as defined <a href="#msisdn-param">here</a>) Example: <code class="prettyprint">4740485124</code>.</td>
<td>string</td>
</tr>
<tr>
<td>properties[&lsquo;email&rsquo;]</td>
<td>yes*</td>
<td>none</td>
<td>Member&rsquo;s email</td>
<td>string</td>
</tr>
<tr>
<td>password</td>
<td>no</td>
<td>null</td>
<td>Memberâs password. Not required, but user may not be able to log in without this</td>
<td>String</td>
</tr>
<tr>
<td>sms_enabled</td>
<td>no</td>
<td>true</td>
<td>Should SMS channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>email_enabled</td>
<td>no</td>
<td>true</td>
<td>Should email channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>push_enabled</td>
<td>no</td>
<td>true</td>
<td>Should push channel be enabled for member?</td>
<td>Boolean</td>
</tr>
<tr>
<td>optin_channel</td>
<td>no</td>
<td>&ldquo;import&rdquo;**</td>
<td>Source of member</td>
<td>String</td>
</tr>
<tr>
<td>optin_subchannel</td>
<td>no</td>
<td>import&rsquo;s id**</td>
<td>Subsource of member</td>
<td>String</td>
</tr>
<tr>
<td>consents</td>
<td>no</td>
<td>{}</td>
<td>Members consents</td>
<td>See <a href="#member-consents-model">Member&rsquo;s consents JSON model</a></td>
</tr>
</tbody></table>

<p>&ast; At least one of those properties must be provided</p>

<p>&ast;&ast; When those member attributes are missing on creation, defaults will be used. When on update, they won&rsquo;t be overwritten.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>import_id</td>
<td>Identifier for import status checking (either provided by you or auto-generated)</td>
<td>String</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid payload</td>
<td>Returns error object - see below</td>
</tr>
</tbody></table>

<h5 id="invalid-payload-error-json-object">Invalid Payload Error (JSON object)</h5>

<p>When payload is invalid, an object is returned: <code class="prettyprint">{&quot;error&quot; =&gt; &lt;reason&gt;}</code></p>

<p>Possible reasons are:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">duplicated_emails</code></td>
<td>At least two members in payload share same email</td>
</tr>
<tr>
<td><code class="prettyprint">duplicated_msisdns</code></td>
<td>At least two members in payload share same msisdn</td>
</tr>
<tr>
<td><code class="prettyprint">members_size_incorrect</code></td>
<td>Members number in payload exceeds maximum (1000)</td>
</tr>
<tr>
<td><code class="prettyprint">members_empty</code></td>
<td>Payload is empty</td>
</tr>
<tr>
<td><code class="prettyprint">missing_identifier</code></td>
<td>At least one member in payload misses required identifier (depends on Community)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Imports:Create</code> permit
</aside>

<h3 id="get-import-status"><a name="members-imports-status"></a> Get import status</h3>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/imports/:import_id</code></p>

<p>Returns status of import with a list of references to bulks (<code class="prettyprint">id</code> and <code class="prettyprint">request_number</code>). </p>

<p>You need to call <a href="#members-import-bulk-status">Members Imports &bull; Get bulk status</a> to see bulks details.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
    <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/imports/:import_id"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, JSON will be returned:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"members_in_payloads_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">4000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_created_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3020</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_updated_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">531</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_with_validation_errors_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">449</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-30T11:23:08.417Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"bulks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">83473</span><span class="p">,</span><span class="w"> </span><span class="s2">"request_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">83474</span><span class="p">,</span><span class="w"> </span><span class="s2">"request_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">83475</span><span class="p">,</span><span class="w"> </span><span class="s2">"request_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"working"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">83476</span><span class="p">,</span><span class="w"> </span><span class="s2">"request_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"waiting"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>import_id</td>
<td>Import identifier</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_in_payload_number</td>
<td>A total number of members that were requested for importing</td>
<td>Integer</td>
</tr>
<tr>
<td>members_created_number</td>
<td>A total number of members that were successfully created</td>
<td>Integer</td>
</tr>
<tr>
<td>members_updated_number</td>
<td>A total number of members that were successfully updated</td>
<td>Integer</td>
</tr>
<tr>
<td>members_with_validation_errors_number</td>
<td>A total number of members that had validation errors</td>
<td>Integer</td>
</tr>
<tr>
<td>created_at</td>
<td>The date of import creation</td>
<td>Date</td>
</tr>
<tr>
<td>bulks</td>
<td>A list of bulks in the import</td>
<td>Array<Object>, where Object consists: of <code class="prettyprint">id</code>, <code class="prettyprint">request_number</code> and <code class="prettyprint">status</code> attributes</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Job with such ID wasn&rsquo;t found.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Imports:Get</code> permit
</aside>

<h3 id="get-bulk-status"><a name="members-imports-bulk-status"></a> Get bulk status</h3>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/imports/:import_id/bulks/:bulk_id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/imports/:import_id/bulks/by_request_number/:request_number</code></p>

<p>Returns status of import bulk.</p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
    <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/imports/:import_id/bulks/:bulk_id"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, JSON will be returned:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="s2">"import_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"89405ae3-2dd5-46cb-a13b-840bc588199b"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"request_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"only_create"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_in_payload_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_created_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_updated_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_with_validation_errors_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retries"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"members_errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"joe@example.com"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                            </span><span class="p">{</span><span class="w"> 
                              </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_not_match"</span><span class="p">,</span><span class="w">
                              </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pl"</span><span class="p">,</span><span class="w">
                              </span><span class="s2">"values"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en, no"</span><span class="p">,</span><span class="w">
                              </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"language"</span><span class="w">
                            </span><span class="p">}</span><span class="w">
                        </span><span class="p">]</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-30T17:14:03.738Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>import_id</td>
<td>Import identifier</td>
</tr>
<tr>
<td>bulk_id</td>
<td>ID of the bulk</td>
</tr>
<tr>
<td>request_number</td>
<td>Request number of the bulk</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID of bulk</td>
<td>Integer</td>
</tr>
<tr>
<td>import_id</td>
<td>Import identifier</td>
<td>String</td>
</tr>
<tr>
<td>request_number</td>
<td>The number of the bulk</td>
<td>Integer</td>
</tr>
<tr>
<td>status</td>
<td>Job status - one of: &lsquo;waiting&rsquo;, &lsquo;working&rsquo;, &lsquo;finished&rsquo;, &lsquo;failed&rsquo; &lsquo;waiting_for_retry&rsquo; - see more <a href="#members-imports-import-flow">here</a> in &ldquo;Bulk statuses&rdquo; section</td>
<td>String</td>
</tr>
<tr>
<td>members_in_payload_number</td>
<td>A number of members that were requested for importing</td>
<td>Integer</td>
</tr>
<tr>
<td>members_created_number</td>
<td>A number of members that were successfully created</td>
<td>Integer</td>
</tr>
<tr>
<td>members_updated_number</td>
<td>A number of members that were successfully updated</td>
<td>Integer</td>
</tr>
<tr>
<td>members_with_validation_errors_number</td>
<td>A number of members that had validation errors</td>
<td>Integer</td>
</tr>
<tr>
<td>retries</td>
<td>A number of background job retries (max 5)</td>
<td>Integer</td>
</tr>
<tr>
<td>members_errors</td>
<td>Members errors. Each invalid member will be returned in this object, where key is his identifier (<code class="prettyprint">email</code> or <code class="prettyprint">msisdn</code>) and the value is a list of it&rsquo;s <a href="#validation-on-members">validation errors</a></td>
<td>Object</td>
</tr>
<tr>
<td>created_at</td>
<td>The date of bulk creation</td>
<td>Date</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Bulk with such ID wasn&rsquo;t found.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Imports:Get</code> permit
</aside>

          <h2 id="members-webhooks">Members Webhooks</h2>

<p>A Loyalty Club may be configured to send notifications (as HTTP POST requests) when a change occurs within its member 
database (e.g. when member registers).</p>

<p>If you wish to configure a Loyalty Club to have such notifications enabled, please contact us us.
You will need to provide us a HTTPS (for security reasons, we don&rsquo;t support HTTP) URL that notifications will
be sent to.</p>

<h3 id="subscription">Subscription</h3>

<p>As it is possible to have multiple endpoints configured for receiving notifications in one Loyalty Club, for each 
endpoint we setup a Subscription.</p>

<p>Each Subscription has its own Secret Token (see below) and may be configured to send notifications only on specific 
changes (<code class="prettyprint">import</code>, <code class="prettyprint">update</code>, <code class="prettyprint">delete</code>).</p>

<h3 id="authentication-token">Authentication token</h3>

<p>Each notification request is signed with <code class="prettyprint">X-Secret-Token</code> header that contains Secret Token configured for given 
Subscription.</p>

<p>In order to assure that notifications you receive are sent from us, you should check if its value matches 
the Secret Token that you received from us when the subscription has been set up.</p>

<h3 id="notifications-format">Notifications format</h3>

<p>Currently, notifications are generated in two versions. 
Version 1 is deprecated and new subscriptions are going to be configured to receive v2 notifications.</p>

<h4 id="notifications-v2">Notifications v2</h4>

<blockquote>
<p>Example for v2</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"events"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w"> </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-05T14:31:15.520Z"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"loyalty_club"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="s2">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"infinity-mall"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">11256</span><span class="p">,</span><span class="w">
        </span><span class="s2">"person_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">89103</span><span class="p">,</span><span class="w">
        </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w"> </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="p">,</span><span class="w"> </span><span class="s2">"zip_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"sms_marketing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-21T10:23:34.982Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="s2">"email_marketing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-05T14:31:15.520Z"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"sms_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"email_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enabled"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"push_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"optin_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"optin_subchannel"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-21T10:23:34.982Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-02-05T14:31:15.520Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"member_changes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4740769126"</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john@example.com"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"sms_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enabled"</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"push_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enabled"</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="s2">"disabled"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mark"</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">  </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="s2">"zip_code"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3300"</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"sms_marketing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"~"</span><span class="p">,</span><span class="w"> </span><span class="s2">"was"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Each change in the <code class="prettyprint">events</code> array consists of following objects:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>event</td>
<td>See <a href="#v2-event">Event model</a></td>
</tr>
<tr>
<td>loyalty_club</td>
<td>Information about member&rsquo;s Loyalty Club - it&rsquo;s ID and slug.</td>
</tr>
<tr>
<td>member</td>
<td>Member attributes after the event - See <a href="https://docs.mpc.placewise.com/#introduction36">Member JSON model</a>. For <code class="prettyprint">delete</code> events it contains only <code class="prettyprint">id</code> and <code class="prettyprint">person_id</code></td>
</tr>
<tr>
<td>member_changes</td>
<td>See <a href="#v2-event">Event model</a>. It&rsquo;s empty for <code class="prettyprint">delete</code> events</td>
</tr>
</tbody></table>

<h5 id="event-model"><a name="v2-event"></a> Event model</h5>

<p>Contains meta information about the change event. </p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td><code class="prettyprint">import</code>, <code class="prettyprint">update</code>, or <code class="prettyprint">delete</code></td>
<td>A type of the change event</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
<td>When the event occurred</td>
</tr>
</tbody></table>

<h5 id="changes-object"><a name="v2-changes"></a> Changes object</h5>

<p>Represents changes that happened to member within the event. Includes only properties that have been actually changed
within the event.</p>

<p>Changes object may contain following fields:</p>

<ul>
<li><code class="prettyprint">msisdn</code></li>
<li><code class="prettyprint">email</code></li>
<li><code class="prettyprint">sms_status</code></li>
<li><code class="prettyprint">email_status</code></li>
<li><code class="prettyprint">push_status</code></li>
<li><code class="prettyprint">optin_channel</code></li>
<li><code class="prettyprint">optin_subchannel</code></li>
<li><code class="prettyprint">consents</code>, which contains changes for consents </li>
<li><code class="prettyprint">properties</code>, which contains changes for properties</li>
</ul>

<p>Each change consists of three fields:</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>change</td>
<td><code class="prettyprint">~</code>, <code class="prettyprint">+</code> or <code class="prettyprint">-</code></td>
<td>Whether the property has been changed (<code class="prettyprint">~</code>), added (<code class="prettyprint">+</code>) or removed (<code class="prettyprint">-</code>)</td>
</tr>
<tr>
<td>before</td>
<td>mixed</td>
<td>The value of property before the change</td>
</tr>
<tr>
<td>after</td>
<td>mixed</td>
<td>The value of property after the change</td>
</tr>
</tbody></table>

<h4 id="notifications-v1-deprecated">Notifications v1 (deprecated)</h4>

<blockquote>
<p>Example for v1</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"bulk"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"customer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity Mall"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">447</span><span class="p">,</span><span class="w">
      </span><span class="s2">"event_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">44882174</span><span class="p">,</span><span class="w">
      </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"birthday"</span><span class="p">:{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="s2">"string"</span><span class="p">,</span><span class="s2">"value"</span><span class="p">:</span><span class="s2">"1990-01-01"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"woman"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doe"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"optin_channel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"webforms"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4740769126"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"j.doe@example.com"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"sms_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"verified"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"email_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unsubscribed"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"push_status"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"enabled"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"consents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"dmp_profiling"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"sms_marketing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"email_marketing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"custom_consent"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-05-28T08:34:59.231Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"optin_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-05-24T11:23:41.231Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Each change in the <code class="prettyprint">bulk</code> is identified by following attributes:</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>customer_name</td>
<td>String</td>
<td>Name of Loyalty Club</td>
</tr>
<tr>
<td>customer_id</td>
<td>Integer</td>
<td>ID of Loyalty Club</td>
</tr>
<tr>
<td>event_type</td>
<td><code class="prettyprint">import</code>, <code class="prettyprint">update</code>, or <code class="prettyprint">delete</code></td>
<td>A type of the change</td>
</tr>
<tr>
<td>external_id</td>
<td>Integer</td>
<td>ID of member</td>
</tr>
<tr>
<td>properties</td>
<td>Object</td>
<td>Member properties. Each of them has a <code class="prettyprint">type &lt;String&gt;</code> and <code class="prettyprint">value &lt;String&gt;</code>. When <code class="prettyprint">event_type</code> is <code class="prettyprint">delete</code>, contains only member identifiers (<code class="prettyprint">msisdn</code>, <code class="prettyprint">email</code>)</td>
</tr>
<tr>
<td>consents</td>
<td>Object</td>
<td>Member consents and their values. Empty when <code class="prettyprint">event_type</code> is <code class="prettyprint">delete</code>.</td>
</tr>
<tr>
<td>created_at</td>
<td>Date</td>
<td>When the change occurred</td>
</tr>
<tr>
<td>optin_date</td>
<td>Date</td>
<td>When the member has been created</td>
</tr>
</tbody></table>

<h3 id="notifications-delivery">Notifications delivery</h3>

<p>Your endpoint must return a <code class="prettyprint">2xx</code> (<code class="prettyprint">200</code> or <code class="prettyprint">201</code> preferably) HTTP status code. Only then the notification 
will be treated as delivered.</p>

<p>If your server returns <code class="prettyprint">5xx</code> code, the delivery will be treated as failed, and our system will make another attempt later.
On consequent failures, deliveries will be attempted up to 20 days.</p>

<p>If your server returns a <code class="prettyprint">4xx</code> code, the delivery will be ignored.</p>

          <h1 id="members-groups-api"><a name="members-groups"></a> Members Groups API</h1>

<aside class="warning">
This API is in development. Therefore, it may not be ready for use and is a subject to change at any time.
</aside>

<p>Members may be grouped into groups. It&rsquo;s up to API client / customer how they are utilized. </p>

<h2 id="introduction"><a name="members-groups-introduction"></a> Introduction</h2>

<h3 id="automatic-groups"><a name="automatic-members-groups"></a> Automatic groups</h3>

<p>Group is automatic (and has <code class="prettyprint">&quot;automatic&quot;: true</code> attribute ) when it has been created with <code class="prettyprint">audience_id</code> or 
<code class="prettyprint">audience_conditions</code> param.</p>

<p>Automatic group doesn&rsquo;t allow API client to manually manage its members - instead, those are fetched from the given audience.</p>

<p>See more <a href="#members-groups-create">here</a></p>

<h3 id="system-groups">System groups</h3>

<p>System groups (with <code class="prettyprint">&quot;system&quot;: true</code> attribute) are created automatically by system and are not editable
by API client - only MPC system can create, edit and destroy system groups.</p>

<p>The set of system groups present in given Loyalty Club depends on its configuration. An example of system group could be
&ldquo;All members&rdquo; group that would contain all Loyalty Club members.</p>

<h3 id="membersgroup-model"><a name="members-group-model"></a> MembersGroup model</h3>

<blockquote>
<p>JSON example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6813</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Red"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Color"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lorem ipsum dolor est"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"automatic"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"audience_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">351</span><span class="p">,</span><span class="w">
    </span><span class="s2">"audience_conditions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"members_group_ids"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">6813</span><span class="p">],</span><span class="w">
            </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"any"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"condition_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_properties"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"members_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>yes</td>
<td>Types are not predefined. It&rsquo;s up to API client to define them.</td>
</tr>
<tr>
<td>automatic</td>
<td>boolean</td>
<td>no</td>
<td>Is the group automatic?</td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td>no</td>
<td>Is the group system group?</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>members_count</td>
<td>integer</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>audience_id</td>
<td>integer</td>
<td>no</td>
<td>ID of related audience</td>
</tr>
<tr>
<td>audience_conditions</td>
<td>Object</td>
<td>no</td>
<td>Conditions of related audience - See <a href="https://dmp.boostcom.no/docs/#conditions">DMP docs</a></td>
</tr>
</tbody></table>

<h3 id="membersgroup-payload-model"><a name="members-group-payload-model"></a> MembersGroup payload model</h3>

<p>Used as an input of creations and updates.</p>

<blockquote>
<p>JSON example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Red"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Color"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lorem ipsum dolor est"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"audience_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">351</span><span class="p">,</span><span class="w">
    </span><span class="s2">"audience_conditions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"members_group_ids"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">6813</span><span class="p">],</span><span class="w">
            </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"any"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"condition_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_properties"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>yes</td>
<td>Types are not predefined. It&rsquo;s up to API client to define them.</td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td>no</td>
<td>Is the group system group?</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>audience_id</td>
<td>integer</td>
<td>no</td>
<td>ID of related audience</td>
</tr>
<tr>
<td>audience_conditions</td>
<td>Object</td>
<td>no</td>
<td>Conditions of related audience</td>
</tr>
</tbody></table>

<h2 id="members-groups">Members Groups</h2>

<h3 id="list"><a name="members-groups-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#members-group-model">members groups</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_groups"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups</code></p>

<p>Returns groups defined within Loyalty Club.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>null</td>
<td>When given, returns only group of given name</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>null</td>
<td>When given, returns only group of given type</td>
</tr>
<tr>
<td>automatic</td>
<td>boolean</td>
<td>null</td>
<td>When true - only automatic groups are returned, when false - only manual</td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td>null</td>
<td>When true - only system groups are returned, when false - only non-system</td>
</tr>
<tr>
<td>search</td>
<td>string</td>
<td>null</td>
<td>When given, returns groups that have name, type or description matching the query string</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_groups</td>
<td>Array<MembersGroup></td>
<td>Array of <a href="#members-group-model">MembersGroup</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Index</code> permit
</aside>

<h3 id="get"><a name="members-groups-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#members-group-model">members group</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_group"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id</code></p>

<p>Returns group identified by id.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td>MembersGroup</td>
<td><a href="#members-group-model">MembersGroup</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>MembersGroup does not exist</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Get</code> permit
</aside>

<h3 id="create"><a name="members-groups-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request POST <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
--data-raw <span class="s1">'{
    "members_group": {
        "name": "My Group 1",
        "type": "Store",
        "description": "Oh long johnson"
    }
}'</span>
</code></pre>
<blockquote>
<p>Returns object containing created <a href="#members-group-model">members group</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_group"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups</code></p>

<p>Creates a new group.</p>

<p>When <code class="prettyprint">audience_id</code> or <code class="prettyprint">audience_conditions</code> param is provided, the group is treated 
as <a href="#automatic-members-groups">automatic</a>.</p>

<p>Specifically:</p>

<ul>
<li>when <code class="prettyprint">audience_id</code> is given, the group relates to existing audience</li>
<li>when <code class="prettyprint">audience_conditions</code> is given, a new audience is created with specified conditions </li>
<li>when none of those parameters is given, a new audience is created with conditions that will return only members 
manually assigned to the group by API client</li>
</ul>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td><a href="#members-group-payload-model">MembersGroup Payload</a></td>
</tr>
<tr>
<td>members_group.audience_id</td>
<td>ID of audience that the group should relate to</td>
</tr>
<tr>
<td>members_group.audience_conditions</td>
<td>Conditions of audience that the group should relate to</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td>MembersGroup</td>
<td>Created <a href="#members-group-model">MembersGroup</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Create</code> permit
</aside>

<h3 id="update"><a name="members-groups-update"></a> Update</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request PUT <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/4321'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
--data-raw <span class="s1">'{
    "members_group": {
        "name": "My Group 1",
        "type": "Store",
        "description": "Oh long johnson"
    }
}'</span>
</code></pre>
<blockquote>
<p>Returns object containing updated <a href="#members-group-model">members group</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_group"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id</code></p>

<p>Updates given group.</p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td><a href="#members-group-payload-model">MembersGroup Payload</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td>MembersGroup</td>
<td>Created <a href="#members-group-model">MembersGroup</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>MembersGroup does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Update</code> permit
</aside>

<h3 id="destroy"><a name="members-groups-destroy"></a> Destroy</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request DELETE <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/4321'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span>
</code></pre>
<blockquote>
<p>Returns object containing deleted <a href="#members-group-model">members group</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_group"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id</code></p>

<p>Deletes given group.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_group</td>
<td>MembersGroup</td>
<td>The deleted <a href="#members-group-model">MembersGroup</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>MembersGroup does not exist</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Destroy</code> permit
</aside>

<h2 id="types">Types</h2>

<h3 id="list-types"><a name="members-groups-types"></a> List types</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/types'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#members-group-model">members groups</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_group_types"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Type"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">    
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"system"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">      
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/types</code></p>

<p>Returns all group types defined for groups in the Loyalty Club. 
It may (depends on Loyalty Club setup) include special system types.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_types</td>
<td>Array</td>
<td></td>
</tr>
<tr>
<td>members_group_types[].name</td>
<td>String</td>
<td></td>
</tr>
<tr>
<td>members_group_types[].system</td>
<td>Bool</td>
<td>Is a system type?</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Types:Index</code> permit
</aside>

<h2 id="members-management">Members Management</h2>

<h3 id="add-member"><a name="members-groups-add-member"></a> Add member</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request POST <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/512/members/123'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--data-raw <span class="s1">''</span>
</code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id/members/:member_id</code></p>

<p>Adds member to the group.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_id</td>
<td>Integer</td>
</tr>
<tr>
<td>member_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Returns empty object.</p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>MembersGroup does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Members:Add</code> permit
</aside>

<h3 id="remove-member"><a name="members-groups-remove-member"></a> Remove member</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request DELETE <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/512/members/123'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--data-raw <span class="s1">''</span>
</code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id/members/:member_id</code></p>

<p>Removes member from the group.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_id</td>
<td>Integer</td>
</tr>
<tr>
<td>member_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Returns empty object.</p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>MembersGroup does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Members:Remove</code> permit
</aside>

<h3 id="list-members-of-a-group"><a name="members-groups-list-group-members"></a> List members of a group</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members_groups/1/members'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--data-raw <span class="s1">''</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#member-model">members</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">members</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Member model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members_groups/:members_group_id/members</code></p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
</tbody></table>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>members_group_id</td>
<td>MembersGroup ID</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members</td>
<td>Array<Member></td>
<td>Array of <a href="#member-model">Members</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:MembersGroups:Members:List</code> permit
</aside>

<h3 id="list-groups-of-a-member"><a name="members-groups-list-member-groups"></a> List groups of a member</h3>

<blockquote>
<p>Example: </p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/members/549123/groups'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#members-group-model">members groups</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"members_groups"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">members</span><span class="w"> </span><span class="err">groups</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"MemberGroup model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/groups</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_email/:member_email/groups</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/by_msisdn/:member_msisdn/groups</code></p>

<p>Returns groups of given member.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
</tbody></table>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>Member&rsquo;s ID</td>
<td>integer</td>
</tr>
<tr>
<td>member_msisdn</td>
<td>Member&rsquo;s msisdn</td>
<td>string (format as defined <a href="#msisdn-param">here</a> - example: <code class="prettyprint">4740485124</code>)</td>
</tr>
<tr>
<td>member_email</td>
<td>Member&rsquo;s email</td>
<td>string (email)</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>members_groups</td>
<td>Array<MembersGroup></td>
<td>Array of <a href="#members-group-model">MembersGroup</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Member does not exist</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>BL:Api:Members:Groups</code> permit
</aside>

          <h1 id="messaging-api"><a name="messaging"></a> Messaging API</h1>

<aside class="warning">
This API is under development. Therefore, it may not be ready for use and is a subject to change at any time.
</aside>

<h2 id="common-models"><a name="messaging-models"></a> Common models</h2>

<h3 id="message-model"><a name="messaging-message-model"></a> Message model</h3>

<blockquote>
<p>Message example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">758131</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DD3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"shorten_urls"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"track_in_shortener"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"service"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T10:01:09.467Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T10:01:09.467Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"channels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">55781</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alphanumeric"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
        </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3491</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hei {{name}}"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"sendings_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sendings_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"latest_sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3920</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"audience_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">107103</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dispatches_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">9513</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-10-15T15:27:02.853Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Message stores business-level information and configuration.</p>

<p>It has <a href="#messaging-template-model">Templates</a> through <a href="#messaging-channel-model">Channels</a> (currently only one is supported). </p>

<p>It may be sent, more than once, by scheduling <a href="#messaging-sending-model">Sendings</a> to specific recipients.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td><strong>name</strong></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><strong>shorten_urls</strong></td>
<td>boolean</td>
<td>Should sendings for this message have URLs shortened with MPC Shortener?</td>
</tr>
<tr>
<td><strong>track_in_shortener</strong></td>
<td>boolean</td>
<td>Should MPC Shortener track users?</td>
</tr>
<tr>
<td>service</td>
<td>enum</td>
<td>MPC <a href="#messaging-message-service">Service</a> the Message is related to</td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer</td>
<td>MPC&rsquo;s campaign ID (applicable to <code class="prettyprint">campaigns</code> service)</td>
</tr>
<tr>
<td><strong>channels</strong></td>
<td><a href="#messaging-channel-model">Channel</a>[]</td>
<td>Channels the message is sent with</td>
</tr>
<tr>
<td><strong>sendings_status</strong></td>
<td>enum</td>
<td><a href="#messaging-message-sendings-status">Aggregated Sendings status</a></td>
</tr>
<tr>
<td><strong>sendings_count</strong></td>
<td>integer</td>
<td>Number of Sendings of Message</td>
</tr>
<tr>
<td><strong>latest_sending</strong></td>
<td><a href="#messaging-message-sending-model">MessageSending</a></td>
<td>Most recent Sending of Message</td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Time of creation</td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Time of last update</td>
</tr>
</tbody></table>

<h5 id="aggregated-sendings-status"><a name="messaging-message-sendings-status"></a> Aggregated Sendings status</h5>

<p>If all Message&rsquo;s Sendings are <code class="prettyprint">transmitted</code>, <code class="prettyprint">cancelled</code>, <code class="prettyprint">failed</code> or <code class="prettyprint">skipped</code>, then <code class="prettyprint">sendings_status</code> is <code class="prettyprint">finished</code>.</p>

<p>If all Message&rsquo;s Sendings are <code class="prettyprint">draft</code>, then <code class="prettyprint">sendings_status</code> is <code class="prettyprint">draft</code>.</p>

<p>If both above conditions are not true, then <code class="prettyprint">sendings_status</code> is <code class="prettyprint">scheduled</code>.</p>

<h5 id="messagesending-model"><a name="messaging-message-sending-model"></a> MessageSending model</h5>

<p>Simplified version of <a href="#messaging-sending-model">Sending</a>&lsquo;s with limited set of attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td><a href="#messaging-sending-model">Sending#id</a></td>
</tr>
<tr>
<td>audience_id</td>
<td><a href="#messaging-sending-model">Sending#audience_id</a></td>
</tr>
<tr>
<td><strong>status</strong></td>
<td><a href="#messaging-sending-model">Sending#status</a></td>
</tr>
<tr>
<td><strong>scheduled_at</strong></td>
<td><a href="#messaging-sending-model">Sending#scheduled_at</a></td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td><a href="#messaging-sending-model">Sending#created_at</a></td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td><a href="#messaging-sending-model">Sending#updated_at</a></td>
</tr>
<tr>
<td><strong>recipients_count</strong></td>
<td>Number of recipients</td>
</tr>
<tr>
<td>dispatches_count</td>
<td>Number of dispatches, when sending has not been executed yet it&rsquo;s <code class="prettyprint">null</code></td>
</tr>
</tbody></table>

<h4 id="service"><a name="messaging-message-service"></a> Service</h4>

<p>Service is used to provide special treatment for some types of Messages that are bound to specific MPC features.</p>

<p>A permit is required for managing Messages of each Service.</p>

<table><thead>
<tr>
<th>Service</th>
<th>Permit</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaigns</td>
<td>Messages:Api:Messages:UseService:Campaigns</td>
<td>MPC Campaigns messages</td>
</tr>
<tr>
<td>campaigns_testing</td>
<td>Messages:Api:Messages:UseService:CampaignsTesting</td>
<td>MPC Campaigns test messages</td>
</tr>
<tr>
<td>tenants</td>
<td>Messages:Api:Messages:UseService:Tenants</td>
<td>For MPC TEM tenant messages</td>
</tr>
<tr>
<td>tenants_testing</td>
<td>Messages:Api:Messages:UseService:TenantsTesting</td>
<td>For MPC TEM tenant test messages</td>
</tr>
<tr>
<td>tem_documents</td>
<td>Messages:Api:Messages:UseService:TemDocuments</td>
<td>For MPC TEM documents notifications</td>
</tr>
<tr>
<td>tem_documents_reminders</td>
<td>Messages:Api:Messages:UseService:TemDocumentsReminders</td>
<td>For MPC TEM documents reminder notifications</td>
</tr>
</tbody></table>

<h3 id="channel-model"><a name="messaging-channel-model"></a> Channel model</h3>

<blockquote>
<p>Channel example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">55781</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alphanumeric"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
     </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hei {{name}}"</span><span class="w"> </span><span class="p">},</span><span class="w">
     </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
     </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.625Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Channel defines how <a href="#messaging-message-model">Message</a> may be sent along with the content (defined by <a href="#messaging-template-model">Template</a>) that 
should be sent through this channel.</p>

<p>Please note that while we allow to set multiple channels on single message for future usage, 
currently just one (the first) is utilized as the Message&rsquo;s single channel.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>integer</td>
</tr>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td>datetime</td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td>datetime</td>
</tr>
<tr>
<td><strong>template</strong></td>
<td><a href="#messaging-template-model">Template</a></td>
</tr>
<tr>
<td><a href="#messaging-channel-specific-attributes">(channel-specific attributes)</a></td>
<td></td>
</tr>
</tbody></table>

<h4 id="channel-specific-attributes"><a name="messaging-channel-specific-attributes"></a> Channel-specific attributes</h4>

<p>When not provided explicitly, values of all the following attributes are taken from Loyalty Club configuration.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Channel type</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>sender.type</td>
<td><code class="prettyprint">sms</code></td>
<td>enum: <code class="prettyprint">[&#39;alphanumeric&#39;, &#39;international&#39;]</code></td>
</tr>
<tr>
<td>sender.value</td>
<td><code class="prettyprint">sms</code></td>
<td>string</td>
</tr>
<tr>
<td>from_email</td>
<td><code class="prettyprint">email</code></td>
<td>string</td>
</tr>
<tr>
<td>from_name</td>
<td><code class="prettyprint">email</code></td>
<td>string</td>
</tr>
</tbody></table>

<p>The <code class="prettyprint">sender</code> describes how SMS sender will be displayed to the receiver of SMS.
By default, a value from Loyalty Club configuration is used (see <a href="#messaging-show-settings">Messaging &bull; Settings</a>).</p>

<p>Depending on selected <code class="prettyprint">sender.type</code>, <code class="prettyprint">sender.value</code> can be provided according to the following table:  </p>

<table><thead>
<tr>
<th>Type</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">alphanumeric</code></td>
<td>String consisting of 2-11 characters</td>
</tr>
<tr>
<td><code class="prettyprint">international</code></td>
<td>Any MSISDN</td>
</tr>
</tbody></table>

<h3 id="template-model"><a name="messaging-template-model"></a> Template model</h3>

<blockquote>
<p>Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5913</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hei {{name}}"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Template describes content of the <a href="#messaging-message-model">Message</a>. </p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>wrapper_id</td>
<td>integer</td>
<td>ID of <a href="#messaging-template-wrapping">wrapper template</a></td>
</tr>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;plain&#39;, &#39;email&#39;, &#39;bee_email&#39;, &#39;push&#39;, &#39;generic&#39;]</code></td>
<td></td>
</tr>
<tr>
<td><strong>content</strong></td>
<td>Object</td>
<td>Definition depends on the <code class="prettyprint">type</code>. See below</td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Time of creation</td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Time of last update</td>
</tr>
</tbody></table>

<div class="clear"></div>

<h4 id="plain-template"><a name="messaging-template-model-plain"></a> <code class="prettyprint">plain</code> template</h4>

<blockquote>
<p>Plain Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Important message for {{name}}"</span><span class="p">,</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hei {{name}}"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This type of template contains only body and can be sent with any channel.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>content.body</strong></td>
<td>string</td>
<td></td>
</tr>
</tbody></table>

<div class="clear"></div>

<h4 id="email-template"><a name="messaging-template-model-email"></a> <code class="prettyprint">email</code> template</h4>

<blockquote>
<p>Email Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609194</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"email"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome!"</span><span class="p">,</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;b&gt;Hei {{name}}&lt;/b&gt;"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This type of template can be assigned to <code class="prettyprint">email</code> channel.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td><strong>content.body</strong></td>
<td>HTML</td>
</tr>
<tr>
<td>content.subject</td>
<td>string</td>
</tr>
</tbody></table>

<div class="clear"></div>

<h4 id="bee_email-template"><a name="messaging-template-model-bee-email"></a> <code class="prettyprint">bee_email</code> template</h4>

<blockquote>
<p>BeeEmail Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bee_email"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome!"</span><span class="p">,</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;b&gt;Hei {{name}}&lt;/b&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">"bee_json"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This type of template is used internally by MPC UI. </p>

<p>It differs from <code class="prettyprint">email</code> by containing JSON source which is used by <a href="https://docs.beefree.io/">Bee Plugin</a> to generate HTML <code class="prettyprint">body</code>. </p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td><strong>content.body</strong></td>
<td>HTML</td>
</tr>
<tr>
<td><strong>content.bee_json</strong></td>
<td>Object</td>
</tr>
<tr>
<td>content.subject</td>
<td>string</td>
</tr>
</tbody></table>

<div class="clear"></div>

<h4 id="push-template"><a name="messaging-template-model-push"></a> <code class="prettyprint">push</code> template</h4>

<blockquote>
<p>Push Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"push"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome"</span><span class="p">,</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{name}}!"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iml://app/cpn"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This type of template can be assigned to <code class="prettyprint">push</code> channel.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td><strong>content.body</strong></td>
<td>string</td>
</tr>
<tr>
<td>content.subject</td>
<td>string</td>
</tr>
<tr>
<td>content.uri</td>
<td>URL</td>
</tr>
</tbody></table>

<div class="clear"></div>

<h4 id="generic-template"><a name="messaging-template-model-generic"></a> <code class="prettyprint">generic</code> template</h4>

<blockquote>
<p>Generic Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"generic"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Welcome"</span><span class="p">,</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{name}}!"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iml://app/cpn"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-15T12:45:08.618Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This type of template also can be assigned to any channel. But any possible content attribute can be set.</p>

<p>It&rsquo;s designed to be used as a generic wrapper or in appliances where the template needs to be utilized by messages
sent with various channels.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>content.body</td>
<td>string</td>
</tr>
<tr>
<td>content.subject</td>
<td>string</td>
</tr>
<tr>
<td>content.uri</td>
<td>URL</td>
</tr>
</tbody></table>

<h4 id="templating-system"><a name="messaging-template-templating-system"></a> Templating system</h4>

<p>We use <a href="https://shopify.github.io/liquid">Liquid</a> template language for generating dynamic Message content.</p>

<p>NOTE: Currently, because of technical reasons, in e-mail messages very limited set of Liquid features is supported - 
it&rsquo;s demonstrated in examples of this section. However, in pushes and SMSes, full set of features is available.</p>

<p>The set of merge-tags available for given Message depends on recipient type the Message is being sent to.</p>

<blockquote>
<p>Example: Having this as a body of SMS sent to MPC members  </p>
</blockquote>
<pre class="highlight plaintext"><code>{% if dmp.bonus_points %}
    Your points balance is {{ member.bonus_points }}! :)
{% else %}
    You have no points :(
{% endif %}
</code></pre>
<blockquote>
<p>A following text will be received by member that has some points:</p>
</blockquote>
<pre class="highlight plaintext"><code>Your points balance is 540 :)
</code></pre>
<blockquote>
<p>A the following text will be received by member that has no points:</p>
</blockquote>
<pre class="highlight plaintext"><code>You have no points :(
</code></pre>
<p>For MPC members (fetched from <a href="#messaging-sending-audience-payload-model">audience</a> or provided as <a href="#messaging-mpc-recipient-model">MPC members recipients</a>),
their MPC data may be used as merge-tags:</p>

<table><thead>
<tr>
<th>merge-tag</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">member.id</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">member.secret_id</code></td>
<td>Special member&rsquo;s ID of used to authorize member in some MPC services</td>
</tr>
<tr>
<td><code class="prettyprint">member.msisdn</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">member.email</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">member.app_token</code></td>
<td></td>
</tr>
<tr>
<td><code class="prettyprint">member.*</code></td>
<td>Member property (e.g. <code class="prettyprint">member.first_name</code>) - the set depends on LC configuration</td>
</tr>
<tr>
<td><code class="prettyprint">dmp.*</code></td>
<td>DMP value for member (e.g. <code class="prettyprint">dmp.bonus_points</code>) - available for audience members only, <br />the set depends on LC configuration</td>
</tr>
</tbody></table>

<div class="clearfix"></div>

<p>For <a href="#messaging-arbitrary-recipient-model">arbitrary recipients</a>, only their identifiers and arbitrary data provided 
within <code class="prettyprint">properties</code>  may be used - see example.</p>

<blockquote>
<p>Having arbitrary recipients provided as follows: </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"piotr@example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"some_object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ola@example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ola"</span><span class="p">,</span><span class="w"> </span><span class="s2">"some_object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>A Template&rsquo;s content may be defined this way:</p>
</blockquote>
<pre class="highlight plaintext"><code>Hello {{ first_name }}.
Your email is {{ email }}.
Your points balance is {{ some_object.points }}.
</code></pre>
<div class="clear"></div>

<h5 id="template-wrapping"><a name="messaging-template-wrapping"></a> Template wrapping</h5>

<blockquote>
<p>Sample wrapper definition:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"generic"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Important message for {{member.first_name}}"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{member.name}}! {{content}}"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="p">,</span><span class="w"> </span><span class="err">so</span><span class="w"> </span><span class="err">it</span><span class="w"> </span><span class="err">won't</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">used</span><span class="w"> </span><span class="err">on</span><span class="w"> </span><span class="err">wrapping</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Consider this wrapper to be assigned to a template as follows:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609194</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">609193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"push"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I will be replaced by wrapper, as wrapper has no {{content} defined for this property"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your last name is {{member.last_name}}!"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo://bar"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Effectively, following content will be used during sending execution after wrapping and merging:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Important message for Piotr"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi Piotr! Your last name is Åwitlicki!"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo://bar"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Any template may be wrapped by another template by providing <code class="prettyprint">wrapper_id</code>.</p>

<p>On sending execution, if channel&rsquo;s template has a wrapper assigned, each content attribute (body, subject, etc) 
of the template will be injected into special <code class="prettyprint">{{ content }}</code> merge-tag of corresponding wrapper&rsquo;s attribute.</p>

<p>When wrapper has no specific content attribute defined, it will be ignored. </p>

<p>Wrapping is not recursive, so if template A has a template B as a wrapper and template B has a template C as a wrapper,
template A will be wrapped by Template B, but template B will not be wrapped by Template C.</p>

<p>The type of wrapper that can be assigned to a template depends on given template type, as follows:</p>

<table><thead>
<tr>
<th>Template type</th>
<th>Wrappable with</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">plain</code></td>
<td><code class="prettyprint">generic</code>, <code class="prettyprint">email</code>, <code class="prettyprint">bee_email</code>, <code class="prettyprint">push</code>, <code class="prettyprint">plain</code></td>
</tr>
<tr>
<td><code class="prettyprint">generic</code></td>
<td><code class="prettyprint">generic</code>, <code class="prettyprint">email</code>, <code class="prettyprint">bee_email</code>, <code class="prettyprint">push</code></td>
</tr>
<tr>
<td><code class="prettyprint">email</code></td>
<td><code class="prettyprint">generic</code>, <code class="prettyprint">email</code>, <code class="prettyprint">bee_email</code></td>
</tr>
<tr>
<td><code class="prettyprint">push</code></td>
<td><code class="prettyprint">generic</code>, <code class="prettyprint">push</code></td>
</tr>
<tr>
<td><code class="prettyprint">bee_email</code></td>
<td><code class="prettyprint">generic</code></td>
</tr>
</tbody></table>

<h3 id="sending-model"><a name="messaging-sending-model"></a> Sending model</h3>

<blockquote>
<p>Sending example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000016</span><span class="p">,</span><span class="w">
  </span><span class="s2">"audience_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">106642</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-18T09:28:59.918Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scheduled_with"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15 minutes"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"relative"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-18T09:13:59.937Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-18T09:13:59.937Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dispatches_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4912</span><span class="p">,</span><span class="w">
  </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
      </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"app_token"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>audience_id</td>
<td>integer</td>
<td>ID of audience the sending is directed to</td>
</tr>
<tr>
<td><strong>status</strong></td>
<td>string</td>
<td>See: <a href="#messaging-sending-status">Sending status</a></td>
</tr>
<tr>
<td><strong>scheduled_at</strong></td>
<td>datetime</td>
<td>Time of sending execution</td>
</tr>
<tr>
<td>scheduled_with</td>
<td>Object</td>
<td>Params the sending has been scheduled with - See <a href="#messaging-sending-schedule-payload-model">SendingSchedulePayload</a></td>
</tr>
<tr>
<td>dispatches_count</td>
<td>Number of dispatches, when sending has not been executed yet it&rsquo;s <code class="prettyprint">null</code></td>
<td></td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Time of creation</td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Time of update</td>
</tr>
<tr>
<td><strong>recipients</strong></td>
<td><a href="#messaging-recipient-model">Recipient</a>[]</td>
<td>Inline recipients the sending is directed to</td>
</tr>
</tbody></table>

<h4 id="sending-status"><a name="messaging-sending-status"></a> Sending status</h4>

<p>The Sending may have one of following statuses, which may be grouped into <strong>initial states</strong>, <strong>execution steps</strong> and the <strong>final outcomes</strong>:</p>

<ul>
<li><strong>initial states</strong>:

<ul>
<li><strong>draft</strong> - When API client didn&rsquo;t&rsquo;t define the schedule (or has <code class="prettyprint">draft: true</code> flag)</li>
<li><strong>scheduled</strong> - When scheduled to be sent at specific time by API client</li>
</ul></li>
</ul>

<p>Sending may have status changed from <code class="prettyprint">draft</code> to <code class="prettyprint">scheduled</code>  and vice versa, as long as the execution haven&rsquo;t started yet.  </p>

<ul>
<li><strong>execution steps</strong>:

<ul>
<li><strong>preparing</strong> - Building Dispatches for Recipients and Audience members</li>
<li><strong>prepared</strong> - Dispatches are built, ready for transmission</li>
<li><strong>transmitting</strong> - Dispatches are being transmitted</li>
</ul></li>
</ul>

<p>Preparing is a process that builds Dispatches for given recipients. Potentially Sendings may have very large Audiences assigned, 
so it may take some time to build Dispatches for all of them. Therefore, the preparation starts 5 minutes before the actual transmission.</p>

<ul>
<li><strong>final outcomes</strong>: 

<ul>
<li><strong>transmitted</strong> - When the Dispatches have been transmitted</li>
<li><strong>skipped</strong> - When no recipients could be resolved for it (for example, Audience may lose its members over time).</li>
<li><strong>cancelled</strong> - When cancelled by API client at any point of execution (see: <a href="#messaging-cancel-sending">Sending cancellation</a>.</li>
<li><strong>failed</strong> - When the execution couldn&rsquo;t be finished in about 20 minutes after the desired time </li>
</ul></li>
</ul>

<p>Whenever Sending is <code class="prettyprint">cancelled</code> or <code class="prettyprint">failed</code>, it cannot be rescheduled again. 
It must be created again, for example with <a href="#todo">Clone sending endpoint</a>. </p>

<h3 id="dispatch-model"><a name="messaging-dispatch-model"></a> Dispatch model</h3>

<blockquote>
<p>Sending example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">173</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi Piotr"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">46085834</span><span class="p">,</span><span class="w">
    </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+4740769126"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app_token"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transmission_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"transmitted"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"delivery_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delivered"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"external_delivery_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delivered"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-18T22:47:45.191Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-18T22:47:52.016Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-18T22:47:45.066Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transmitted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-18T22:47:45.495Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"delivered_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-18T22:47:48.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cleaned_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>id</strong></td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td><strong>type</strong></td>
<td>enum: [&#39;sms&rsquo;, &lsquo;email&rsquo;, &lsquo;push&rsquo;]</td>
<td></td>
</tr>
<tr>
<td><strong>content</strong></td>
<td>object</td>
<td>Depends on Dispatch type</td>
</tr>
<tr>
<td>member_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>msisdn</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>app_token</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><strong>transmission_status</strong></td>
<td>enum: [&lsquo;scheduled&rsquo;, &lsquo;transmitted&rsquo;, &lsquo;failed&rsquo;]</td>
<td>Describes status of transmission within Messages API</td>
</tr>
<tr>
<td><strong>delivery_status</strong></td>
<td>enum: [&lsquo;pending&rsquo;, &lsquo;delivered&rsquo;, &lsquo;failed&rsquo;]</td>
<td>Describes status of delivery within external senders</td>
</tr>
<tr>
<td><strong>created_at</strong></td>
<td>datetime</td>
<td>Time of creation</td>
</tr>
<tr>
<td><strong>updated_at</strong></td>
<td>datetime</td>
<td>Time of update</td>
</tr>
<tr>
<td><strong>scheduled_at</strong></td>
<td>datetime</td>
<td>Time when the Dispatch was meant to be sent</td>
</tr>
<tr>
<td><strong>transmitted_at</strong></td>
<td>datetime</td>
<td>Time when the Dispatch has been transmitted to external senders</td>
</tr>
<tr>
<td><strong>delivered_at</strong></td>
<td>datetime</td>
<td>Time when the Dispatch has been delivered to recipient</td>
</tr>
<tr>
<td><strong>cleaned_at</strong></td>
<td>datetime</td>
<td>Time when the Dispatch has been stripped off from personal data (content and identifiers)</td>
</tr>
</tbody></table>

<h3 id="recipient-model"><a name="messaging-recipient-model"></a> Recipient model</h3>

<blockquote>
<p>Recipient example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
  </span><span class="s2">"msisdn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4740485124"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"recipient@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"app_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c6OE_joK28g:APA91bFkT5fzhdWJMJswPo3btVLxtMmhi7jKdOE_VL1IhkSmuoz3iEQMg4Cq"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>integer</td>
<td>ID of MPC member</td>
</tr>
<tr>
<td>msisdn</td>
<td><a href="#msisdn-param">MSISDN</a></td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>email</td>
<td></td>
</tr>
<tr>
<td>app_token</td>
<td>email</td>
<td></td>
</tr>
<tr>
<td>properties</td>
<td>Object</td>
<td>Arbitrary keys that can be used as <a href="#messaging-templating-system">merge-tags</a> in the message template</td>
</tr>
</tbody></table>

<p><br />
Recipient may be an MPC member (identified by <code class="prettyprint">member_id</code>) or an arbitrary sending receivers - <code class="prettyprint">msisdn</code>, <code class="prettyprint">email</code> or <code class="prettyprint">push</code>.  </p>

<h4 id="mpc-member-recipient"><a name="messaging-mpc-recipient-model"></a> MPC member recipient</h4>

<p>When <code class="prettyprint">member_id</code> is provided, other identifiers will be ignored and actual identifiers for sending execution will 
be fetched from MPC member&rsquo;s data (for example, for <code class="prettyprint">sms</code> channel member&rsquo;s <code class="prettyprint">msisdn</code> will be used as a sending receiver).</p>

<p>merge-tags for template will be fetched from MPC Members - but may be extended/replaced with provided <code class="prettyprint">properties</code>.</p>

<h4 id="arbitrary-identifier-recipient"><a name="messaging-arbtrary-recipient-model"></a> Arbitrary identifier recipient</h4>

<p>Without <code class="prettyprint">member_id</code>, at least one identifier relevant to message&rsquo;s channels definition is required.</p>

<p>For example, if <code class="prettyprint">sms</code> and <code class="prettyprint">email</code> channels are defined on message, <code class="prettyprint">msisdn</code> or <code class="prettyprint">email</code> is required.</p>

<p>Given <code class="prettyprint">properties</code> will be used as template&rsquo;s merge-tags. </p>

          <h3 id="messagepayload-model"><a name="messaging-message-payload-model"></a> MessagePayload model</h3>

<blockquote>
<p>MessagePayload example - it creates an SMS message which will be sent at given time to members of given audience:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My message"</span><span class="p">,</span><span class="w"> </span><span class="s2">"shorten_urls"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"track_in_shortener"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">"campaign_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w">
  </span><span class="s2">"channels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alphanumeric"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w"> </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{name}}"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"absolute"</span><span class="p">,</span><span class="w"> </span><span class="s2">"at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-10-18T10:59:32.340Z"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"audience"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">}</span><span class="w"> 
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>name</strong></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>shorten_urls</td>
<td>boolean</td>
<td>Should sendings for this message have URLs shortened? Default: <code class="prettyprint">true</code></td>
</tr>
<tr>
<td>shorten_urls</td>
<td>boolean</td>
<td>Should MPC&rsquo;s Shortener track users? Default: <code class="prettyprint">false</code></td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer</td>
<td>MPC&rsquo;s Campaign ID</td>
</tr>
<tr>
<td>service</td>
<td>string</td>
<td><a href="#messaging-message-service">Service</a> the Message is related to</td>
</tr>
<tr>
<td><strong>channels</strong></td>
<td><a href="#messaging-channel-payload-model">ChannelPayload</a>[]</td>
<td>Channels the message should be sent with.</td>
</tr>
<tr>
<td>sending</td>
<td><a href="#messaging-sending-payload-model">SendingPayload</a></td>
<td>Sending to schedule for the message, available only on creation</td>
</tr>
</tbody></table>

<p><br /></p>

<h4 id="validation-errors-specific-to-the-payload">Validation errors specific to the payload</h4>

<table><thead>
<tr>
<th>Attribute</th>
<th>Error key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaign_id</td>
<td>is_relevant_only_for_campaign_service</td>
<td>When campaign_id is given and service is not &ldquo;campaigns&rdquo;</td>
</tr>
<tr>
<td>channels</td>
<td>types_must_be_unique</td>
<td></td>
</tr>
<tr>
<td>channels[].type</td>
<td>not_configured</td>
<td>Channel is not configured for Loyalty Club - see <a href="#messaging-show-settings">Messaging &bull; Settings</a></td>
</tr>
</tbody></table>

<h3 id="channelpayload-model"><a name="messaging-channel-payload-model"></a> ChannelPayload model</h3>

<blockquote>
<p>ChannelPayload example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sender"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alphanumeric"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"template"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w"> </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{first_name}}"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
<td></td>
</tr>
<tr>
<td><strong>template.type</strong></td>
<td>enum: <code class="prettyprint">[&#39;inline&#39;, &#39;reference&#39;]</code></td>
<td></td>
</tr>
<tr>
<td>template.id</td>
<td>integer</td>
<td>ID of Template to assign (when <code class="prettyprint">reference</code>)</td>
</tr>
<tr>
<td>template.definition</td>
<td><a href="#messaging-template-payload-model">TemplatePayload</a></td>
<td>Definition of Template to assign (when <code class="prettyprint">inline</code>)</td>
</tr>
<tr>
<td><a href="#messaging-channel-specific-attributes">(channel-specific attributes)</a></td>
<td></td>
<td></td>
</tr>
</tbody></table>

<p>There are two ways to provide template:</p>

<ul>
<li><code class="prettyprint">inline</code> - you will need provide new template <code class="prettyprint">definition</code> </li>
<li><code class="prettyprint">reference</code> - template definition will be copied from template identified by <code class="prettyprint">id</code> </li>
</ul>

<h4 id="validation-errors-specific-to-the-payload">Validation errors specific to the payload</h4>

<table><thead>
<tr>
<th>Attribute</th>
<th>Error key</th>
</tr>
</thead><tbody>
<tr>
<td>template.id</td>
<td>template_does_not_exist</td>
</tr>
<tr>
<td>template.id</td>
<td>template_does_not_match_channel</td>
</tr>
<tr>
<td>template.definition.type</td>
<td>template_does_not_match_channel</td>
</tr>
<tr>
<td>template.definition.wrapper_id</td>
<td>template_does_not_match_channel</td>
</tr>
</tbody></table>

<h3 id="templatepayload-model"><a name="messaging-template-payload-model"></a> TemplatePayload model</h3>

<blockquote>
<p>Template example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"plain"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"wrapper_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9193</span><span class="p">,</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hi {{first_name}}"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;plain&#39;, &#39;email&#39;, &#39;bee_email&#39;, &#39;push&#39;]</code></td>
<td></td>
</tr>
<tr>
<td><strong>content</strong></td>
<td>Object</td>
<td>Depends on type. See: <a href="#messaging-template-model">Template model</a></td>
</tr>
<tr>
<td>wrapper_id</td>
<td>integer</td>
<td>ID of <a href="#messaging-template-wrapping">wrapping template</a></td>
</tr>
</tbody></table>

<h4 id="validation-errors-specific-to-the-payload">Validation errors specific to the payload</h4>

<table><thead>
<tr>
<th>Attribute</th>
<th>Error key</th>
</tr>
</thead><tbody>
<tr>
<td>wrapper_id</td>
<td>template_does_not_exist</td>
</tr>
<tr>
<td>wrapper_id</td>
<td>wrapper_type_does_not_match</td>
</tr>
</tbody></table>

<h3 id="sendingpayload-model"><a name="messaging-sending-payload-model"></a> SendingPayload model</h3>

<blockquote>
<p>Example #1 - Creates Sending without schedule to audience defined by given conditions</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Schedule</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">provided</span><span class="p">,</span><span class="w"> </span><span class="err">so</span><span class="w"> </span><span class="err">message</span><span class="w"> </span><span class="err">will</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">scheduled</span><span class="w">
  </span><span class="s2">"audience"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"conditions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"condition_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_properties"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">,</span><span class="w"> 
        </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example #2 - schedules message sending 2 days from now to members of audience defined by ID and 2 arbitrary recipients</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"schedule"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"relative"</span><span class="p">,</span><span class="w"> </span><span class="s2">"in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 days"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"audience"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w"> </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jan@example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jan"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>draft</td>
<td>bool</td>
<td>If true (false, by default), the Sending is not scheduled for execution, even if schedule is present</td>
</tr>
<tr>
<td>priority</td>
<td>Integer (1-10)</td>
<td>Requires <code class="prettyprint">Messages:Api:Sendings:SetPriority</code> permit</td>
</tr>
<tr>
<td>schedule</td>
<td><a href="#messaging-sending-schedule-payload-model">SendingSchedulePayload</a></td>
<td></td>
</tr>
<tr>
<td>audience</td>
<td><a href="#messaging-sending-audience-payload-model">SendingAudiencePayload</a></td>
<td></td>
</tr>
<tr>
<td>recipients</td>
<td><a href="#messaging-recipient-model">Recipient</a></td>
<td></td>
</tr>
</tbody></table>

<p><br /></p>

<p>There are two methods to define recipients of the sending:</p>

<ul>
<li><code class="prettyprint">audience</code> - members of the audience will be used as recipients</li>
<li><code class="prettyprint">recipients</code> - inline receivers</li>
</ul>

<p>Both methods can be used at the same time.</p>

<p><code class="prettyprint">schedule</code> is optional - when not provided, sending will not be scheduled (will have <code class="prettyprint">draft</code> status).</p>

<div class="clear"></div>

<h4 id="validation-errors-specific-to-the-payload">Validation errors specific to the payload</h4>

<table><thead>
<tr>
<th>Attribute</th>
<th>Error key</th>
</tr>
</thead><tbody>
<tr>
<td>(base)</td>
<td>sending_must_have_audience_or_recipients</td>
</tr>
</tbody></table>

<h4 id="sendingschedulepayload-model"><a name="messaging-sending-schedule-payload-model"></a> SendingSchedulePayload model</h4>

<blockquote>
<p>Example #1 - immediate schedule</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"immediate"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example #2 - absolute schedule</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"absolute"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-10-18T10:59:32.340Z"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example #3 - relative schedule</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"relative"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5 minutes"</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;immediate&#39;, &#39;absolute&#39;, &#39;relative&#39;]</code></td>
<td></td>
</tr>
<tr>
<td>at</td>
<td>ISO 8601 DateTime</td>
<td>For <code class="prettyprint">absolute</code> type - defines exact time the sending should be executed at</td>
</tr>
<tr>
<td>in</td>
<td>string</td>
<td>For <code class="prettyprint">relative</code> type - see below</td>
</tr>
</tbody></table>

<p><br /></p>

<p><strong><code class="prettyprint">in</code> format</strong></p>

<p>You can provide <code class="prettyprint">number</code> of time <code class="prettyprint">unit</code>s the sending will be scheduled at in format described by following 
regex: 
<code class="prettyprint">^(?&lt;number&gt;\d+) (?&lt;unit&gt;second|minute|hour|day|week|month|year)s?$</code>.</p>

<p>Examples:</p>

<ul>
<li><code class="prettyprint">30 minutes</code></li>
<li><code class="prettyprint">1 day</code></li>
<li><code class="prettyprint">5 months</code></li>
</ul>

<div class="clear"></div>

<h4 id="sendingaudiencepayload-model"><a name="messaging-sending-audience-payload-model"></a> SendingAudiencePayload model</h4>

<blockquote>
<p>Example #1 - audience by reference</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w"> 
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">532</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example #2 - audience by inline conditions</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> 
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"conditions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"condition_group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_properties"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first_name"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Piotr"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>type</strong></td>
<td>enum: <code class="prettyprint">[&#39;reference&#39;, &#39;inline&#39;]</code></td>
<td></td>
</tr>
<tr>
<td>id</td>
<td>integer</td>
<td>For <code class="prettyprint">reference</code> type - ID of audience the sending should be sent to</td>
</tr>
<tr>
<td>conditions</td>
<td>Object[]</td>
<td>For <code class="prettyprint">inline</code> type - See <a href="https://dmp.boostcom.no/docs/#conditions">DMP docs</a></td>
</tr>
</tbody></table>

<h4 id="validation-errors-specific-to-the-payload">Validation errors specific to the payload</h4>

<table><thead>
<tr>
<th>Attribute</th>
<th>Error key</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>referenced_audience_must_exist</td>
</tr>
</tbody></table>

          <h2 id="messages"><a name="messaging-messages"></a> Messages</h2>

<h3 id="list-messages"><a name="messaging-list-messages"></a> List Messages</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages?sendings_status=finished"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#messaging-message-model">messages</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">messages</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Message model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/messages</code></p>

<p>Returns list of <a href="#messaging-message-model">Messages</a>.  </p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>sendings_status</td>
<td>enum</td>
<td>null</td>
<td>When present, returns only Messages having given <a href="#messaging-message-sendings-status">Aggregated Sendings status</a></td>
</tr>
<tr>
<td>service</td>
<td>enum</td>
<td>null</td>
<td>When present, returns only Messages having given <a href="#messaging-message-service">Service</a></td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer</td>
<td>null</td>
<td>When present, returns only Messages having given campaign_id</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Messages:List</code> permit
</aside>

<h3 id="get-message"><a name="messaging-get-message"></a> Get Message</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/83"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing the requested <a href="#messaging-message-model">message</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Message</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Message model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/messages/:id</code></p>

<p>Returns <a href="#messaging-message-model">Message</a>.  </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Message ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Message not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Messages:Get</code> permit
</aside>

<h3 id="create-message"><a name="messaging-create-message"></a> Create Message</h3>

<blockquote>
<p>Example - creates an SMS message, scheduled in 15 minutes, sent to given audience and one inline recipient.</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
      "message": {
        "name": "My message", "shorten_urls": false,
        "channels": [
          {
            "type": "sms", 
            "sender": { type: "alphanumeric", value: "Infinity" },
            "template": {
              "type": "inline",
              "data": { "type": "plain", "content": { "body": "Hi {{first_name}}!" } }
            }
          }
        ],
        "sending": {
          "schedule": { "type": "relative", "in": "15 minutes" },
          "audience": {
            "type": "inline",
            "conditions": [
              {
                "condition_group": "member_properties", "field": "first_name",
                "operator": "match", "value": "Piotr"
              }
            ]
          },
          "recipients": [
            { "member_id": 150, "properties": { "first_name": "Piotr" } }
          ]
        }
      }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing created <a href="#messaging-message-model">message</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Message</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Message model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v1/messages</code></p>

<p>Creates a new Message with Channel(s) and Template(s) and optionally schedules Sending for it.  </p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td><a href="#messaging-message-payload-model">MessagePayload</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>Message</td>
<td>See: <a href="#messaging-message-model">Message model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Unauthorized to set specific <a href="#messaging-message-service">Service</a></td>
</tr>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Unauthorized to set Sending priority</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Messages:Create</code> permit
</aside>

<h3 id="update-message"><a name="messaging-update-message"></a> Update Message</h3>

<blockquote>
<p>Example - updates Message</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/13"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
      "message": {
        "name": "My message", 
        "shorten_urls": false,
        "track_in_shortener": false,
        "campaign_id": 15,
        "service": "campaigns"
      },
      "channels": [
        {
          "type": "email",
          "template": {
            "type": "inline",
            "definition": {
              "type": "plain",
              "content": { "body": "Hi {{first_name}}", "subject": "foo" }
            }
          }
        }
      ]
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing updated <a href="#messaging-message-model">message</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Message</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Message model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/messages/:id</code></p>

<p>Updates Message&rsquo;s attributes and its Channels.</p>

<p>The update is partial - only attributes present in the payload are updated. 
If attribute removal is intended, it should be provided with <code class="prettyprint">null</code> value.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Message ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td><a href="#messaging-message-payload-model">MessagePayload</a></td>
</tr>
</tbody></table>

<p>Note that <a href="#messaging-message-payload-model">MessagePayload</a>&lsquo;s <code class="prettyprint">sending</code> attribute is not available, as it&rsquo;s not 
possible to change any Sending during Message update.  </p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>Message</td>
<td>See: <a href="#messaging-message-model">Message model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Unauthorized to set specific <a href="#messaging-message-service">Service</a></td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Message not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Messages:Update</code> permit
</aside>

          <h2 id="sendings"><a name="messaging-sendings"></a> Sendings</h2>

<h3 id="get-sending"><a name="messaging-get-sending"></a> Get Sending</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/sendings/32"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing the requested <a href="#messaging-sending-model">sending</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Sending</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sending model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/messages/sendings/:id</code></p>

<p>Returns <a href="#messaging-sending-model">Sending</a>.  </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Sending ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Sending not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Sendings:Get</code> permit
</aside>

<h3 id="list-sending-dispatches"><a name="messaging-list-sending-dispatches"></a> List Sending Dispatches</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/sendings/32/dispatches"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#messaging-dispatch-model">dispatches</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"dispatches"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">messages</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dispatch model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/messages/sendings/:id</code></p>

<p>Returns <a href="#messaging-dispatch-model">Dispatches</a> created for Sending.  </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Sending ID</td>
</tr>
</tbody></table>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>transmission_status</td>
<td>enum</td>
<td>null</td>
<td>When present, returns only Messages having given <a href="#messaging-dispatch-model">transmission_status</a></td>
</tr>
<tr>
<td>delivery_status</td>
<td>enum</td>
<td>null</td>
<td>When present, returns only Dispatches with given <a href="#messaging-dispatch-model">delivery_status</a></td>
</tr>
<tr>
<td>member_id</td>
<td>integer</td>
<td>null</td>
<td>When present, returns only Dispatches sent to recipient identified by given id</td>
</tr>
<tr>
<td>msisdn</td>
<td>string</td>
<td>null</td>
<td>When present, returns only Dispatches sent to recipient identified by given msisdn</td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>null</td>
<td>When present, returns only Dispatches sent to recipient identified by given email</td>
</tr>
<tr>
<td>app_token</td>
<td>string</td>
<td>null</td>
<td>When present, returns only Dispatches sent to recipient identified by given app_token</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Sending not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Dispatches:List</code> permit
</aside>

<h3 id="create-sending"><a name="messaging-create-sending"></a> Create Sending</h3>

<blockquote>
<p>Example - creates a Sending scheduled immediately, sent to given audience and one inline recipient.</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/42/sendings"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
      "sending": {
        "schedule": { "type": "immediate" },
        "audience": {
          "type": "inline",
          "id": 150
        },
        "recipients": [
          { "member_id": 150, "properties": { "first_name": "Piotr" } }
        ]
      }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing created <a href="#messaging-sending-model">sending</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Sending</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sending model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v1/messages/:message_id/sendings</code></p>

<p>Creates (and schedules if demanded) Sending for given Message.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>message_id</td>
<td>integer</td>
<td>Message ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sending</td>
<td>SendingPayload</td>
<td>See: <a href="#messaging-sending-payload-model">SendingPayload model</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sending</td>
<td>Sending</td>
<td>See: <a href="#messaging-sending-model">Sending model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Unauthorized to set Sending priority</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Message not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Sendings:Create</code> permit
</aside>

<h3 id="update-sending"><a name="messaging-update-sending"></a> Update Sending</h3>

<blockquote>
<p>Example - updates the Sending - it&rsquo;s unscheduled and audience is removed</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/sendings/42"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
      "sending": {
        "schedule": nil,
        "audience": nil
      }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing updated <a href="#messaging-sending-model">sending</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Sending</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sending model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/messages/sendings/:id</code></p>

<p>Updates Sending attributes. </p>

<p>The update is partial - only attributes present in the payload are updated. 
If attribute removal is intended, it should be provided with <code class="prettyprint">null</code> value.</p>

<h5 id="updating-recipients">Updating recipients</h5>

<p>If <code class="prettyprint">recipients</code> are given, the Sending Recipients are replaced with given ones. 
When the array is empty, all Recipients are removed from Sending.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Sending ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sending</td>
<td>SendingPayload</td>
<td>See: <a href="#messaging-sending-payload-model">SendingPayload model</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sending</td>
<td>Sending</td>
<td>See: <a href="#messaging-sending-model">Sending model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">403</code></td>
<td>Unauthorized to set Sending priority</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Sending not found</td>
</tr>
<tr>
<td><code class="prettyprint">405</code></td>
<td>Sending is not editable - execution process has started or finished</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Sendings:Update</code> permit
</aside>

<h3 id="cancel-sending"><a name="messaging-cancel-sending"></a> Cancel Sending</h3>

<blockquote>
<p>Example - cancels the Sending execution</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/sendings/42/cancel"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing cancelled <a href="#messaging-sending-model">sending</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Sending</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sending model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/messages/sendings/:id</code></p>

<p>Cancels Sending execution process. See <a href="#messaging-sending-status">Sending status</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Sending ID</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sending</td>
<td>Sending</td>
<td>See: <a href="#messaging-sending-model">Sending model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Sending not found</td>
</tr>
<tr>
<td><code class="prettyprint">405</code></td>
<td>Sending is not cancellable - execution is not in progress</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Sendings:Update</code> permit
</aside>

          <h2 id="bulk-operations"><a name="messaging-bulk-processing"></a> Bulk Operations</h2>

<blockquote>
<p>Example - simultaneously updates Message, creates one Sending and updates another one</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/bulks"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
      "operations": [
        {
          "type": "update",
          "entity": "message",
          "params": { "id": 80 },
          "payload": { "name": "my name" }
        },
        {
          "type": "update",
          "entity": "sending",
          "params": { "id": 3958 },
          "payload": { "schedule": { "type": "immediate" } }
        },
        {
          "type": "create",
          "entity": "sending",
          "params": { "message_id": 80 },
          "payload": { "recipients": [{ "member_id": 13 }] }
        },
      ]
    }
  '</span>
</code></pre>
<blockquote>
<p>When all operations have been executed successfully, returns 200 and success response for each of them</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"entity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">41</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Updated</span><span class="w"> </span><span class="err">Message</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"entity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sending"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3958</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid parameters"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Updated</span><span class="w"> </span><span class="err">Sending</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"create"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"entity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sending"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"sending"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Created</span><span class="w"> </span><span class="err">Sending</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<blockquote>
<p>When one of operations fails, returns status 470 and results of operations up to the one that failed</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"entity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"message"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">41</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Updated</span><span class="w"> </span><span class="err">Message</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">Failed</span><span class="w"> </span><span class="err">operation</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">previous</span><span class="w"> </span><span class="err">ones</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="err">despite</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">fact</span><span class="w"> 
    </span><span class="err">//</span><span class="w"> </span><span class="err">they've</span><span class="w"> </span><span class="err">been</span><span class="w"> </span><span class="err">rendered</span><span class="w"> </span><span class="err">as</span><span class="w"> </span><span class="err">successful</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"update"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"entity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sending"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3958</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">422</span><span class="p">,</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid parameters"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Validation</span><span class="w"> </span><span class="err">errors</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">Next</span><span class="w"> </span><span class="err">operations</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">executed</span><span class="p">,</span><span class="w"> </span><span class="err">so</span><span class="w"> </span><span class="err">there</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">no</span><span class="w"> </span><span class="err">response</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">them</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v1/messages/bulks</code></p>

<p>Allows to perform multiple operations (up to 10) on Messaging records (Messages, Sendings, Channels and Templates) 
in a single request.</p>

<p>Behavior and interface (payload, params and response) of each operation is based on specific API endpoint - 
<a href="#messaging-bulk-processing-operations">this</a> table depicts it.</p>

<p>Operations are performed in a transactional way - if one of them fails, processing stops and other operations 
are cancelled. Special code - <code class="prettyprint">470</code> - is returned as the status. 
Actual error for operation that failed is included in the returned <code class="prettyprint">results</code> array.</p>

<p>If all operations are successful, <code class="prettyprint">200</code> code is returned.</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>operations</td>
<td><a href="#messaging-bulk-processing-operation-model">Operations[]</a></td>
<td>Array of operations (max. 10) to perform</td>
</tr>
</tbody></table>

<h5 id="operation-model"><a name="messaging-bulk-processing-operation-model"></a> Operation model</h5>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>enum: [&lsquo;create&rsquo;, &lsquo;update&rsquo;, &lsquo;delete&rsquo;]</td>
<td>Type of operation to perform</td>
</tr>
<tr>
<td>entity</td>
<td>enum: [&lsquo;message&rsquo;, &lsquo;sending&rsquo;, &lsquo;channel&rsquo;, &lsquo;template&rsquo;]</td>
<td>Type of entity to change</td>
</tr>
<tr>
<td>params</td>
<td>object</td>
<td>Params identifying the entity (reflecting original HTTP URL params), specific to type and operation</td>
</tr>
<tr>
<td>payload</td>
<td>object</td>
<td>Attributes of identity, specific to type and operation</td>
</tr>
</tbody></table>

<h5 id="supported-operation-types-and-their-params-and-payloads"><a name="messaging-bulk-processing-operations"></a> Supported operation types and their params and payloads</h5>

<table><thead>
<tr>
<th>Entity</th>
<th>Operation</th>
<th>Params</th>
<th>Payload</th>
<th>Original endpoint</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">message</code></td>
<td><code class="prettyprint">create</code></td>
<td>none</td>
<td><a href="#messaging-message-creation-payload">Message creation payload</a></td>
<td><a href="#messaging-create-message">Create Message</a></td>
</tr>
<tr>
<td><code class="prettyprint">message</code></td>
<td><code class="prettyprint">update</code></td>
<td><code class="prettyprint">id</code></td>
<td><a href="#messaging-message-update-payload">Message update payload</a></td>
<td><a href="#messaging-update-message">Update Message</a></td>
</tr>
<tr>
<td><code class="prettyprint">sending</code></td>
<td><code class="prettyprint">create</code></td>
<td><code class="prettyprint">message_id</code></td>
<td><a href="#messaging-sending-payload-model">SendingPayload</a></td>
<td><a href="#messaging-create-sending">Create Sending</a></td>
</tr>
<tr>
<td><code class="prettyprint">sending</code></td>
<td><code class="prettyprint">update</code></td>
<td><code class="prettyprint">id</code></td>
<td><a href="#messaging-sending-payload-model">SendingPayload</a></td>
<td><a href="#messaging-update-sending">Update Sending</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>results</td>
<td><a href="#messaging-bulk-processing-result">Result[]</a></td>
</tr>
</tbody></table>

<h5 id="result-model"><a name="messaging-bulk-processing-result"></a> Result model</h5>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td></td>
<td>Given operation type</td>
</tr>
<tr>
<td>entity</td>
<td></td>
<td>Given type of entity</td>
</tr>
<tr>
<td>params</td>
<td></td>
<td>Given params of operations</td>
</tr>
<tr>
<td>payload</td>
<td>object</td>
<td>Given payload</td>
</tr>
<tr>
<td>response.status</td>
<td>integer</td>
<td>HTTP status of operation</td>
</tr>
<tr>
<td>response.body</td>
<td>object</td>
<td>JSON response of operation</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">200</code></td>
<td>All operations succeeded</td>
</tr>
<tr>
<td><code class="prettyprint">470</code></td>
<td>At least one operation failed</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Bulks:Process</code> permit
</aside>

          <h2 id="settings"><a name="messaging-settings"></a> Settings</h2>

<h3 id="show-settings"><a name="messaging-show-settings"></a> Show Settings</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/messages/settings"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing settings </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"channels"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"sms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"sender_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alphanumeric"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sender_value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"from_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Infinity"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"from_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"infinity-mall@placewise.com"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"push"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"android_app_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no.bstcm.loyaltyapp.infinity_mall"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ios_app_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1231452117"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/messages/settings</code></p>

<p>Returns Loyalty Club settings related to Message sending.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">settings.channels</code></td>
<td>Object</td>
<td>Contains information about channels. When given channel is not available for LC, it&rsquo;s <code class="prettyprint">null</code>.</td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.sms.sender_type</code></td>
<td>string</td>
<td>See <a href="#messaging-channel-specific-attributes">Channel-specific attributes</a></td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.sms.sender_value</code></td>
<td>string</td>
<td>See <a href="#messaging-channel-specific-attributes">Channel-specific attributes</a></td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.email.from_name</code></td>
<td>string</td>
<td>See <a href="#messaging-channel-specific-attributes">Channel-specific attributes</a></td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.email.from_email</code></td>
<td>string</td>
<td>See <a href="#messaging-channel-specific-attributes">Channel-specific attributes</a></td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.push.android_app_id</code></td>
<td>string</td>
<td>ID of android app configured for push messages receiving</td>
</tr>
<tr>
<td><code class="prettyprint">settings.channels.push.ios_app_id</code></td>
<td>string</td>
<td>ID of ios app configured for push messages receiving</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Messages:Api:Settings:Show</code> permit
</aside>

          <h1 id="offers-api"><a name="offers-api"></a> Offers API</h1>

<p>This section describes endpoints destined for end user (e.g. for mobile apps) that work only within context of (signed in) member.
Navigate to <a href="#offers-admin">Offers Admin</a> section to see docs for offers management endpoints.</p>

<h2 id="introduction">Introduction</h2>

<h3 id="member-context">Member context</h3>

<p>Offers API supports two distinct approaches to work with context of member.</p>

<h4 id="member-id-oauth-recommended"><a name="offers-oauth-context"></a> Member ID OAuth (recommended)</h4>

<p>In the first one member context is resolved from MPC <a href="#oauth2">OAuth</a> member session.</p>

<p>This setup requires use of endpoints that have <code class="prettyprint">/me/</code> URL segment and requires token provided with <code class="prettyprint">authorization</code> header.</p>

<h4 id="member-id"><a name="offers-member-id-context"></a> Member ID</h4>

<p>In this approach member context is resolved from Member&rsquo;s ID provided within URL.</p>

<p>This setup requires use of endpoints that have <code class="prettyprint">/:member_id/</code> URL segment and requires no authentication.</p>

<p>This approach is designed for implementations in which member is authenticated by your system and 
<strong>should not be used on front-end implementations</strong>, where API token is exposed to an end user. </p>

<h4 id="guest-access"><a name="offers-guest-access"></a> Guest access</h4>

<p>Some API client implementations may need to present content to a non-authenticated user.</p>

<p>In order to allow this, static endpoints (like offers list) may work without member context.</p>

<p>They exist in versions which use <code class="prettyprint">/guest/</code> URL segment instead of <code class="prettyprint">/me/</code> or <code class="prettyprint">/member_id/</code> and may be used by both
aforementioned approaches.</p>

<h3 id="offer-model"><a name="offer-model"></a> Offer model</h3>

<blockquote>
<p>Offer example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000115</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Buy two shoes, get one jacket"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"external_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/foo"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"usable_since"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-13T17:32:00.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"usable_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"collection_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000016</span><span class="p">,</span><span class="w"> </span><span class="mi">1000017</span><span class="p">],</span><span class="w">
  </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"2 + 1"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"stores"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"M&amp;H"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000115-offer_default-original.jpg"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
      </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
      </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"read_more"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"button_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Button title"</span><span class="p">,</span><span class="w"> </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Title"</span><span class="p">,</span><span class="w"> </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Text"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"activation_texts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"modal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Modal"</span><span class="p">,</span><span class="w"> </span><span class="s2">"button"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Button"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"schemas"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"list"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.name"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.description"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.stores"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.description"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"empty"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Some great offer we have here!"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"liked"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"usage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"usable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"max_uses"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uses_left"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"active_until"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-13T18:41:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"extras"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>enum: [&lsquo;REGULAR&rsquo;, &lsquo;EXCLUSIVE&rsquo;, &lsquo;BIRTHDAY&rsquo;, &lsquo;WELCOME&rsquo;]</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>external_url</td>
<td>string</td>
<td>yes</td>
<td>The URL the offer may be linked with</td>
</tr>
<tr>
<td>usable_since</td>
<td>Date</td>
<td>yes</td>
<td>Time since the offer may be used. If null, there is no restriction.</td>
</tr>
<tr>
<td>usable_until</td>
<td>Date</td>
<td>yes</td>
<td>Time until the offer may be used. If null, there is no restriction.</td>
</tr>
<tr>
<td>collection_ids</td>
<td>integer[]</td>
<td>no (may be empty)</td>
<td>List of collections ids the offer belongs to</td>
</tr>
<tr>
<td>tags</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of tags identifiers associated with the offer. Information from <a href="#list-translations">Translations &bull; List</a> should be used to display the tags.</td>
</tr>
<tr>
<td>stores</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of shop names associated with the offer</td>
</tr>
<tr>
<td>files</td>
<td>File[]</td>
<td>no</td>
<td>A list of offer files - see <a href="#file-model">File model</a></td>
</tr>
<tr>
<td>liked</td>
<td>Boolean</td>
<td>no</td>
<td>Has offer been liked by user?</td>
</tr>
<tr>
<td>usage</td>
<td>Usage</td>
<td>no</td>
<td>Usage information object - see <a href="#offer-usage-model">Offer usage model</a></td>
</tr>
<tr>
<td>extras</td>
<td>Object</td>
<td>no (may be empty)</td>
<td>Extendable container for any potential extra data</td>
</tr>
<tr>
<td>display</td>
<td>Object</td>
<td>no</td>
<td>Stores display information</td>
</tr>
<tr>
<td>display.schemas</td>
<td>Object</td>
<td>no</td>
<td>Offer displays schemas - see <a href="#offers-display-schemas">Offer display schemas</a></td>
</tr>
<tr>
<td>display.read_more</td>
<td>Object</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>display.read_more.button_title</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>display.read_more.url</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>display.read_more.title</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>display.read_more.text</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>display.read_more</td>
<td>Object</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>activation_texts.modal</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>activation_texts.button</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>activation_texts.description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
</tbody></table>

<h3 id="offer-usage-model"><a name="offer-usage-model"></a> Offer usage model</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>usable</td>
<td>Boolean</td>
<td>no</td>
<td>Is the offer usable?</td>
</tr>
<tr>
<td>max_uses</td>
<td>integer</td>
<td>yes</td>
<td>Maximum number of times the specific member can use the offer. When null, there&rsquo;s no limit.</td>
</tr>
<tr>
<td>uses_left</td>
<td>integer</td>
<td>yes</td>
<td>How many more times the specific member can use the offer - this number can be also affected by global offer limit. When null, there&rsquo;s no limit.</td>
</tr>
<tr>
<td>active_until</td>
<td>Date</td>
<td>yes</td>
<td>The last time time the offer has been used at+ activation time (configurable per Loyalty Club, e.x. 30s). When null, the offer has not been activated (used) yet</td>
</tr>
<tr>
<td>period</td>
<td>Object</td>
<td>yes</td>
<td>If present, it describes limtations of using the offer by member within specific period</td>
</tr>
<tr>
<td>period.timespan</td>
<td>enum: [&lsquo;MINUTE&rsquo;, &lsquo;HOUR&rsquo;, &lsquo;DAY&rsquo;, &lsquo;WEEK&rsquo;, &lsquo;MONTH&rsquo;, &lsquo;YEAR&rsquo;]</td>
<td>no</td>
<td>Defines the period in which usage is limited</td>
</tr>
<tr>
<td>period.max_uses</td>
<td>integer</td>
<td>no</td>
<td>Defines how many times the offer may be used by member within period</td>
</tr>
<tr>
<td>period.uses_left</td>
<td>integer</td>
<td>yes</td>
<td>Defines how many times member may use the offer until end of current period</td>
</tr>
</tbody></table>

<h3 id="collection-model"><a name="offers-collection-model"></a> Collection model</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>short_description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>offers_order</td>
<td>integer[]</td>
<td>no (may be empty)</td>
<td>Describes order in which offers should be displayed inside this collection</td>
</tr>
<tr>
<td>files</td>
<td>File[]</td>
<td>no</td>
<td>A list of Offer Files - see <a href="#file-model">File model</a></td>
</tr>
</tbody></table>

<h3 id="display-schemas"><a name="offers-display-schemas"></a> Display schemas</h3>

<blockquote>
<p>Example schemas:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w">
</span><span class="s2">"display"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"list"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.name"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.description"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.stores"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reference"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.description"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"empty"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"caption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"inline"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Some great offer we have here!"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w">
</span></code></pre>
<p>Display schemas are the offer attributes that describe how offer is meant to be displayed inside specific 
context - and there are two types of schemas:</p>

<ul>
<li><code class="prettyprint">list</code> - describes how offer should look in an offers list view</li>
<li><code class="prettyprint">details</code> - describes how offer should look in an offer detail view</li>
</ul>

<p>Each schema consists of fields with definitions of content that should be put inside the field - there are three of them:</p>

<ul>
<li><code class="prettyprint">header</code></li>
<li><code class="prettyprint">body</code></li>
<li><code class="prettyprint">caption</code></li>
</ul>

<p>The fields interpretation (how they are utilized by view) is up to API client design and/or specific Loyalty Club standard.</p>

<p>Fields are described by two attributes: <code class="prettyprint">type</code> and <code class="prettyprint">value</code>. 
There are three types of fields:</p>

<ul>
<li><code class="prettyprint">&quot;reference&quot;</code> - some offer attribute should be used for the field content, <code class="prettyprint">value</code> contains <a href="https://support.smartbear.com/readyapi/docs/testing/jsonpath-reference.html">JSONPath</a> reference to element, e.g. <code class="prettyprint">$.name</code><br></li>
<li><code class="prettyprint">&quot;inline&quot;</code> - the field itself contains content that should be placed inside the field, which is stored in the <code class="prettyprint">value</code> attribute</li>
<li><code class="prettyprint">&quot;empty&quot;</code> - the field should not be displayed at all</li>
</ul>

<p>By default (when no schema is defined on offer by it&rsquo;s creator), all of the schema fields are references to:</p>

<ul>
<li><code class="prettyprint">caption</code> =&gt; <code class="prettyprint">stores</code></li>
<li><code class="prettyprint">header</code> =&gt; <code class="prettyprint">name</code></li>
<li><code class="prettyprint">body</code> =&gt; <code class="prettyprint">description</code></li>
</ul>

<h2 id="offers"><a name="offers"></a> Offers</h2>

<h3 id="get-offers-meta"><a name="offers-meta"></a> Get offers meta</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers/meta"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"-50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"great deal"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2 + 1"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"stores"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"M&amp;H"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Doo Doo"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"collections"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000016</span><span class="p">,</span><span class="w">
            </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Collection #1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"short_title"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"offers_order"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000115</span><span class="p">,</span><span class="w"> </span><span class="mi">1000112</span><span class="p">,</span><span class="w"> </span><span class="mi">1000114</span><span class="p">],</span><span class="w">
            </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/collection-1000016-collection_cover_default-original.jpg"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collection_cover_default"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/collection-1000016-collection_cover_default-thumbnail.jpg"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collection_cover_default"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/collection-1000016-collection_cover_default-base.jpg"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collection_cover_default"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"activated_seconds_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers/meta</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GetMeta</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers/meta</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GetMetaByMemberId</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/guest/offers/meta</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GetMetaPreview</code> permit
</aside>

<p>Returns offers metadata which consists of:</p>

<ul>
<li>aggregated lists of records currently associated with offers (stores, tags, collections)</li>
<li>Loyalty Club configuration</li>
</ul>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tags</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of unique tags assigned to offers</td>
</tr>
<tr>
<td>stores</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of unique stores assigned to offers</td>
</tr>
<tr>
<td>collections</td>
<td>Collection[]</td>
<td>no (may be empty)</td>
<td>List of unique collections assigned to offers - see <a href="#offers-collection-model">Collection model</a></td>
</tr>
<tr>
<td>activated_seconds_time</td>
<td>integer</td>
<td>no</td>
<td>Number of seconds the offers stays active after member uses it</td>
</tr>
</tbody></table>

<h3 id="get-offer"><a name="get-offer"></a> Get offer</h3>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers/:id</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:Get</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers/:id</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GetByMemberId</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/guest/offers/:id</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GetPreview</code> permit
</aside>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers/1000016"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an Offer object under &ldquo;offer&rdquo; key. See <a href="#offer-model">Offer model</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"offer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Offer</span><span class="w"> </span><span class="err">model</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Returns details of the specified offer.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offer</td>
<td>Offer</td>
<td>no</td>
<td>See <a href="#offer-model">Offer model</a></td>
</tr>
</tbody></table>

<h3 id="list-offers"><a name="list-offers"></a> List offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a list of offers and pagination info. 
  See <a href="#offer-model">Offer model</a> and <a href="#pagination-json-model">Pagination info model</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"offers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Offer</span><span class="w"> </span><span class="err">model</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">model</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:ListVisible</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:ListVisibleByMemberId</code> permit
</aside>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/guest/offers</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:ListVisiblePreview</code> permit
</aside>

<p>Returns offers list.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>include_pagination_info</td>
<td>boolean</td>
<td>false</td>
<td>When true, pagination info (containing info like total records count, next page) will be returned</td>
</tr>
<tr>
<td>order_by</td>
<td>string</td>
<td>&ldquo;name&rdquo;</td>
<td>See <a href="#offers-list-order-by"><code class="prettyprint">order_by</code> param</a></td>
</tr>
<tr>
<td>collection_ids</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers belonging to least one of given collections will be returned</td>
</tr>
<tr>
<td>tags</td>
<td>string[]</td>
<td>null</td>
<td>When present, only offers having at least one of given tags will be returned</td>
</tr>
<tr>
<td>stores</td>
<td>string[]</td>
<td>null</td>
<td>When present, only offers having at least one of given stores will be returned</td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers with this campaign_id will be returned</td>
</tr>
<tr>
<td>search</td>
<td>string</td>
<td>null</td>
<td>When present, only offers that match the query string will be returned</td>
</tr>
<tr>
<td>usable</td>
<td>boolean</td>
<td>false</td>
<td>When true, only offers that are usable will be returned</td>
</tr>
<tr>
<td>liked</td>
<td>boolean</td>
<td>false</td>
<td>When true, only offers that have been liked by member</td>
</tr>
</tbody></table>

<p>All parameters are optional.</p>

<h5 id="order_by-param"><a name="offers-list-order-by"></a> <code class="prettyprint">order_by</code> param</h5>

<p>Offers list may be sorted by <code class="prettyprint">order_by</code> param, which has similar syntax as ORDER BY keyword in SQL statements.</p>

<p>For example <code class="prettyprint">order_by=usable ASC, created_at DESC</code> will return offers sorted by their usability, then by their creation date.</p>

<p>Following offer attributes may be used for sorting  in general:</p>

<ul>
<li>name</li>
<li>usable_since</li>
<li>usable_until</li>
<li>created_at</li>
</ul>

<p>Only in member context (does not work with <code class="prettyprint">/guest/</code> context: </p>

<ul>
<li>usable </li>
<li>uses_left</li>
<li>liked </li>
</ul>

<p>Also, when querying offers by <em>single</em> collection_id, the list may also be sorted by:</p>

<ul>
<li>collection_position</li>
</ul>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offers</td>
<td>Offer[]</td>
<td>no (may be empty)</td>
<td>See <a href="#offer-model">Offer model</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>PaginationInfo</td>
<td>yes</td>
<td>See <a href="#pagination-json-model">Pagination info model</a></td>
</tr>
</tbody></table>

<h3 id="use-offer"><a name="use-offer"></a> Use offer</h3>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers/1000016"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
    {
      "authorization_token": "a1cc4e0b3ab54b7d8"
    }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a Offer usage object - See <a href="#offer-usage-model">Offer usage model</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"usage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"usable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"max_uses"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="s2">"uses_left"</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="p">,</span><span class="w">
        </span><span class="s2">"active_until"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-05-08T14:47:22.323Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers/:id/use</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:Use</code> permit
</aside>

<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers/:id/use</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:UseByMemberId</code> permit
</aside>

<p>Uses (activates) the offer by member.</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>authorization_token</td>
<td>string</td>
<td>yes</td>
<td>See <a href="#offer-use-authorization">below</a></td>
</tr>
</tbody></table>

<h5 id="offer-use-authorization"><a name="offer-use-authorization"></a> Offer use authorization</h5>

<p>Some features (like Rewards Program) may require from member to provide some code (scanned QR code, for example), so we can register
his physical presence in the store.</p>

<p>When token is not provided, the offer use is processed as usual, except that some benefits (like Rewards points)
tied to it may not be granted to the member.</p>

<p>However, when token is provided and happens to be invalid, the offer use is not registered, and 422 error (see below) is returned.  </p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>usage</td>
<td>OfferUsage</td>
<td>See <a href="#offer-usage-model">Offer usage model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Response body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Offer#10000951 not found&quot;}</code></td>
<td>-</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Already active&quot;}</code></td>
<td>The offer has been just used</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Not granted&quot;}</code></td>
<td>The offer is not available to  member</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Usage authorization token invalid&quot;}</code></td>
<td>Provided usage token is invalid</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;User limit exceeded&quot;}</code></td>
<td>Member exhausted his pool of uses</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Periodic user limit exceeded&quot;}</code></td>
<td>Member exhausted his pool of uses within current time period</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Global limit exceeded&quot;}</code></td>
<td>There are no more offers available globally (stock is empty)</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Not in usable timeframes&quot;}</code></td>
<td>Offer is not usable yet or anymore</td>
</tr>
<tr>
<td><code class="prettyprint">467</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is banned!&quot;, &quot;banned_until&quot;: &quot;2137-10-28T17:24:06.207Z&quot;}</code></td>
<td>Member is banned</td>
</tr>
</tbody></table>

<h3 id="like-offer"><a name="like-offer"></a> Like offer</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers/1000016/like"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers/:id/like</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:Like</code> permit
</aside>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers/:id/like</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:LikeByMemberId</code> permit
</aside>

<p>Marks offer as &ldquo;liked&rdquo; by user.</p>

<h3 id="unlike-offer"><a name="unlike-offer"></a> Unlike offer</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/offers/1000016/unlike"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/offers/:id/unlike</code> [<a href="#oauth2">OAuth</a>]</p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:Like</code> permit
</aside>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/offers/:id/unlike</code></p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:LikeByMemberId</code> permit
</aside>

<p>Revers marking offer as &ldquo;liked&rdquo; by user.</p>

<h3 id="grant-offer"><a name="grant-offer"></a> Grant offer</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/7371713/offers/10000951/unlike"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/:member_id/members/:member_id/offers/:id/grant</code></p>

<p>Some types of offers are not available to members until they are granted to them - this endpoint allows to do this. </p>

<p>It may make sense to grant a same offer to one member multiple times when offer has limited number of uses. 
In such case, each consecutive grant will increase the number of uses for this member.</p>

<p>NOTE: This endpoint does not have <a href="#oauth2">OAuth</a> version </p>

<aside class="notice">
Requires <code>Offers:Api:MemberOffers:GrantByMemberId</code> permit
</aside>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>usable_for_seconds</td>
<td>integer</td>
<td>yes</td>
<td>When present, the granted offer will be available for use by member only for the defined time</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Response body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Not grantable&quot;}</code></td>
<td>The offer has type not eligible for granting</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Global limit exceeded&quot;}</code></td>
<td>The offer has no more uses available</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member not in audience&quot;}</code></td>
<td>The offer has been specify to only be available to members in specific audience and the member does not belong to it</td>
</tr>
<tr>
<td><code class="prettyprint">467</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is banned!&quot;, &quot;banned_until&quot;: &quot;2137-10-28T17:24:06.207Z&quot;}</code></td>
<td>Member is banned</td>
</tr>
</tbody></table>

          <h2 id="offers-events"><a name="offers-events"></a> Offers Events</h2>

<h3 id="offerevent-model"><a name="offer-event-model"></a> OfferEvent model</h3>

<blockquote>
<p>Offer Event example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"offer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-08-27T10:20:11.810Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"context"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"collections_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w">
        </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"t1"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"stores"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"a"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"search_string"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"utm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"campaign-2018-05-01"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offer_id</td>
<td>integer</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>created_at</td>
<td>Date</td>
<td>yes</td>
<td>Date of the event occurrence</td>
</tr>
<tr>
<td>context</td>
<td>Object</td>
<td>no</td>
<td>Context of the event occurrence.</td>
</tr>
<tr>
<td>context.collections_ids</td>
<td>Array<ID></td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>context.tags</td>
<td>Array<string></td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>context.stores</td>
<td>Array<string></td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>context.search_string</td>
<td>string</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>context.utm</td>
<td>string</td>
<td>no</td>
<td></td>
</tr>
</tbody></table>

<p>Context describes in what circumstances the event has occurred. 
For example, member clicked on a coupon that was displayed inside collection, the context should include this collection_id. </p>

<h3 id="register-clicked-event"><a name="offers-clicked"></a> Register &ldquo;clicked&rdquo; event</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers/events/offers_clicked"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -d <span class="s1">'
    {
        "events": [
            {
                "offer_id": "14",
                "created_at": "2019-08-27T10:20:11.810Z",
                "context": {
                    "collections_ids": [1, 2],
                    "tags": ["t1"],
                    "stores": ["a"],
                    "search_string": "foo",
                    "utm": "campaign-2018-05-01"
                }
            }
        ]

    }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/events/offers_clicked</code> [<a href="#oauth2">OAuth</a>]</p>

<p>Registers that OAuth member clicked on given offers.</p>

<h4 id="post-parameters">Post Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>events</td>
<td>Array<OfferEvent></td>
<td>See <a href="#offer-event-model">Offer Event</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Events:Clicked</code> permit
</aside>

<h3 id="register-seen-event"><a name="offers-seen"></a> Register &ldquo;seen&rdquo; event</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers/events/offers_seen"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -d <span class="s1">'
    {
        "events": [
            {
                "offer_id": "14",
                "created_at": "2019-08-27T10:20:11.810Z",
                "context": {
                    "collections_ids": [1, 2],
                    "tags": ["t1"],
                    "stores": ["a"],
                    "search_string": "foo",
                    "utm": "campaign-2018-05-01"
                }
            }
        ]

    }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/members/me/events/offers_seen</code> [<a href="#oauth2">OAuth</a>]</p>

<p>Registers that OAuth member saw given offers.</p>

<aside class="warning">
Seen events are automatically tracked when retrieving offer image/file within member context. Make sure you are not duplicating events!
</aside>

<h4 id="post-parameters">Post Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>events</td>
<td>Array <OfferEvent></td>
<td>See <a href="#offer-event-model">Offer Event</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Events:Seen</code> permit
</aside>

          <h1 id="offers-admin-api"><a name="offers-admin"></a>  Offers Admin API</h1>

<aside class="warning">
This API is in development. Therefore, it may not be ready for use and is a subject to change at any time.
</aside>

<p>This section describes endpoints destined for offers management. 
Navigate to <a href="#offers">Offers</a> section to see docs for member-related endpoints.</p>

<h2 id="common-models">Common models</h2>

<h3 id="offer"><a name="admin-offer-model"></a> Offer</h3>

<blockquote>
<p>Offer example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000115</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Buy two shoes, get one jacket"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REGULAR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"external_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/foo"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_more"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"button_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Button title"</span><span class="p">,</span><span class="w"> </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Title"</span><span class="p">,</span><span class="w"> </span><span class="s2">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Text"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"usable_since"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-13T17:32:00.000Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"usable_until"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"collection_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000016</span><span class="p">,</span><span class="w"> </span><span class="mi">1000017</span><span class="p">],</span><span class="w">
  </span><span class="s2">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"2 + 1"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"stores"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"M&amp;H"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000115-offer_default-original.jpg"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
      </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
      </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"extras"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"image_template"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"rectangles"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">rectangles</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"ImageTemplate Rectangle"</span><span class="w">
  </span><span class="p">}</span><span class="w"> 
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>enum: [&lsquo;REGULAR&rsquo;, &lsquo;EXCLUSIVE&rsquo;, &lsquo;BIRTHDAY&rsquo;, &lsquo;WELCOME&rsquo;]</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>internal_name</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>internal_description</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>external_url</td>
<td>string</td>
<td>yes</td>
<td>The URL the offer may be linked with</td>
</tr>
<tr>
<td>read_more</td>
<td>Object</td>
<td>no</td>
<td>Additional offer display data</td>
</tr>
<tr>
<td>read_more.button_title</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>read_more.url</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>read_more.title</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>read_more.text</td>
<td>string</td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>enum: <code class="prettyprint">[&#39;draft&#39;, &#39;published&#39;]</code></td>
<td>no</td>
<td>Offer is visible only when status is <code class="prettyprint">&#39;published&#39;</code></td>
</tr>
<tr>
<td>usable_since</td>
<td>Date</td>
<td>yes</td>
<td>Time since the offer may be used. If null, there is no restriction.</td>
</tr>
<tr>
<td>usable_until</td>
<td>Date</td>
<td>yes</td>
<td>Time until the offer may be used. If null, there is no restriction.</td>
</tr>
<tr>
<td>visible_since</td>
<td>Date</td>
<td>yes</td>
<td>Time since the offer is visible to members. If null, there is no restriction.</td>
</tr>
<tr>
<td>visible_until</td>
<td>Date</td>
<td>yes</td>
<td>Time until the offer is visible to members. If null, there is no restriction.</td>
</tr>
<tr>
<td>collection_ids</td>
<td>integer[]</td>
<td>no (may be empty)</td>
<td>List of collections ids the offer belongs to</td>
</tr>
<tr>
<td>tags</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of tags identifiers associated with the offer. Information from <a href="#list-translations">Translations &bull; List</a> should be used to display the tags.</td>
</tr>
<tr>
<td>stores</td>
<td>string[]</td>
<td>no (may be empty)</td>
<td>List of stores names associated with the offer. See <a href="#store-list">Stores &bull; List</a>.</td>
</tr>
<tr>
<td>audience_id</td>
<td>Integer</td>
<td>yes</td>
<td>DMP&rsquo;s audience ID. If it is set, the offer is available only to members belonging to this audience</td>
</tr>
<tr>
<td>campaign_id</td>
<td>Integer</td>
<td>yes</td>
<td>MPC&rsquo;s campaign ID</td>
</tr>
<tr>
<td>files</td>
<td>File[]</td>
<td>no</td>
<td>A list of offer files - see <a href="#file-model">File model</a></td>
</tr>
<tr>
<td>extras</td>
<td>Object</td>
<td>no (may be empty)</td>
<td>Extendable container for any potential extra data</td>
</tr>
<tr>
<td>display_schemas</td>
<td>Object</td>
<td>no</td>
<td>Offer displays schemas - see <a href="#offers-display-schemas">Offer display schemas</a></td>
</tr>
<tr>
<td>maximum_uses_per_user</td>
<td>Integer</td>
<td>yes</td>
<td>Limit of of uses individual member may perform. When empty, there&rsquo;s no limit.</td>
</tr>
<tr>
<td>stock</td>
<td>Integer</td>
<td>yes</td>
<td>Global limit of member uses. When empty, there&rsquo;s no limit.</td>
</tr>
<tr>
<td>created_at</td>
<td>Date</td>
<td>no</td>
<td>When the offer has been created</td>
</tr>
<tr>
<td>updated_at</td>
<td>Date</td>
<td>no</td>
<td>Last time when the offer has been updated</td>
</tr>
<tr>
<td>archived_at</td>
<td>Date</td>
<td>yes</td>
<td>Time when the offer has been archived</td>
</tr>
<tr>
<td>uses_count</td>
<td>Date</td>
<td>no</td>
<td>Total number of times the offer has been used by members</td>
</tr>
<tr>
<td>image_template</td>
<td>Object</td>
<td>yes</td>
<td>See <a href="#offer-image-template-attr">image_template</a> below</td>
</tr>
<tr>
<td>image_template.rectangles</td>
<td>ImageTemplateRectangle[]</td>
<td>yes</td>
<td>See <a href="#offer-image-template-rectangle">ImageTemplate Rectangle</a></td>
</tr>
</tbody></table>

<h4 id="image_template-attribute"><a name="admin-offer-model-image-template"></a> <code class="prettyprint">image_template</code> attribute</h4>

<p>With this object, you can determine that offer&rsquo;s image will be rendered according to the given definition which
reflects the <a href="#offer-image-template-model">ImageTemplate model</a>.</p>

<p>However, it <strong>is not</strong> a reference to existing <a href="#offer-image-template-record">ImageTemplate record</a>. 
If you want to apply record&rsquo;s model to the Offer, you must use it&rsquo;s 
<a href="#offer-image-template-model">ImageTemplate model</a> (copy it) as the offer&rsquo;s <code class="prettyprint">image_template</code> attribute.</p>

<p>When custom <code class="prettyprint">background_url</code> is desired for given Offer, a new file may be uploaded to Files API 
as <code class="prettyprint">offer_inline_template_background</code> and with identifier of given Offer.</p>

<h3 id="offerpayload"><a name="admin-offer-payload"></a> OfferPayload</h3>

<p>Following Offer attributes (described above) are available to set when creating or updating offers.</p>

<ul>
<li>name</li>
<li>description</li>
<li>internal_name</li>
<li>internal_description</li>
<li>external_url</li>
<li>read_more</li>
<li>status</li>
<li>usable_since</li>
<li>usable_until</li>
<li>visible_since</li>
<li>visible_until</li>
<li>collection_ids</li>
<li>tags</li>
<li>stores</li>
<li>audience_id</li>
<li>campaign_id</li>
<li>extras</li>
<li>display_schemas</li>
<li>maximum_uses_per_user</li>
<li>stock</li>
<li>image_template</li>
</ul>

<h3 id="imagetemplate"><a name="offer-image-template"></a> ImageTemplate</h3>

<h4 id="imagetemplate-model"><a name="offer-image-template-model"></a> ImageTemplate Model</h4>

<blockquote>
<p>ImageTemplate model:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"background_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cdn-files.placewise.com/files/uuUHXAoLdRIX3Am4SHaR1iGyv8yK6-G_a845txA7HUqYhETqgo9"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rectangles"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">rectangles</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"ImageTemplate Rectangle"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Defines how offer image should be rendered. </p>

<p>It&rsquo;s a common interface used for:</p>

<ul>
<li><a href="#admin-offer-model-image-template">Offer&rsquo;s <code class="prettyprint">image_template</code> attribute</a></li>
<li>creating and updating <a href="#offer-image-template-record">ImageTemplate records</a></li>
<li>generating <a href="#offer-admin-image-templates-preview">ImageTemplate preview</a></li>
</ul>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>width</td>
<td>integer</td>
<td>Defines width of the image in pixels, between 1 and 2000</td>
</tr>
<tr>
<td>height</td>
<td>integer</td>
<td>Defines height of the image in pixels, between 1 and 2000</td>
</tr>
<tr>
<td>background_url</td>
<td>string</td>
<td>URL of background image.</td>
</tr>
<tr>
<td>rectangles</td>
<td>TemplateRectangle[]</td>
<td>See <a href="#offer-image-template-rectangle">ImageTemplate Rectangle</a></td>
</tr>
</tbody></table>

<h5 id="rendering"><a name="offer-image-template-rendering"></a> Rendering</h5>

<p>The output image is rendered from the template after offer creation/update request, asynchronously. </p>

<p>Rendering process draws <a href="#offer-image-template-rectangle">rectangles</a> (up to 4) over an optional background image.</p>

<p>When rendering is done, the image is stored as a regular file of the subject offer. </p>

<h4 id="imagetemplate-record"><a name="offer-image-template-record"></a> ImageTemplate Record</h4>

<blockquote>
<p>ImageTemplate record example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Majadada3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"background_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cdn-files.placewise.com/files/uuUHXAoLdRIX3Am4SHaR1iGyv8yK6-G_a845txA7HUqYhETqgo9"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rectangles"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">rectangles</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"ImageTemplate Rectangle"</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-04T14:55:44.385Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-09-04T14:55:44.385Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Stores <code class="prettyprint">ImageTemplate</code> model (see above) for re-usage. Managed with <a href="#image-templates">ImageTemplates API</a>.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>width</td>
<td>integer</td>
<td>Part of <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
<tr>
<td>height</td>
<td>integer</td>
<td>Part of <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
<tr>
<td>background_url</td>
<td>string</td>
<td>Part of <a href="#offer-image-template-model">ImageTemplate model</a>. See below.</td>
</tr>
<tr>
<td>rectangles</td>
<td>TemplateRectangle[]</td>
<td>Part of <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
<tr>
<td>default</td>
<td>boolean</td>
<td>See below</td>
</tr>
<tr>
<td>created_at</td>
<td>Date</td>
<td>When template has been created</td>
</tr>
<tr>
<td>updated_at</td>
<td>Date</td>
<td>Last time the template has been updated</td>
</tr>
</tbody></table>

<h5 id="background_url-attribute"><code class="prettyprint">background_url</code> attribute</h5>

<p>The background image for record must be uploaded to Files API as <code class="prettyprint">offer_template_background</code> and with identifier of given
<code class="prettyprint">ImageTemplate</code> record.</p>

<h5 id="default-attribute"><code class="prettyprint">default</code> attribute</h5>

<p>It&rsquo;s possible to mark template as default for LC (doing this will un-mark previous default offer, if such exists). </p>

<p>It&rsquo;s up to API client how to utilize this feature.</p>

<h5 id="imagetemplate-payload"><a name="offer-image-template-payload"></a> ImageTemplate payload</h5>

<blockquote>
<p>ImageTemplate payload example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Majadada3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
    </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rectangles"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">rectangles</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"ImageTemplate Rectangle"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Used for <a href="#offer-admin-image-templates-create">creating</a> and <a href="#offer-admin-image-templates-update">updating</a> ImageTemplates.</p>

<table><thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Required?</th>
<th>Comment</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td>See <a href="#offer-image-template-record">ImageTemplate record</a></td>
</tr>
<tr>
<td>default</td>
<td>boolean</td>
<td>no</td>
<td>See <a href="#offer-image-template-record">ImageTemplate record</a></td>
</tr>
<tr>
<td>width</td>
<td>string</td>
<td>yes</td>
<td>See <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
<tr>
<td>height</td>
<td>string</td>
<td>yes</td>
<td>See <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
<tr>
<td>rectangles</td>
<td>TemplateRectangle[]</td>
<td>yes</td>
<td>See <a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
</tbody></table>

<h3 id="imagetemplate-rectangle"><a name="offer-image-template-rectangle"></a> ImageTemplate Rectangle</h3>

<blockquote>
<p>ImageTemplateRectangle example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Title"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"padding"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"offset_top"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="s2">"offset_left"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
    </span><span class="s2">"text_align"</span><span class="p">:</span><span class="w"> </span><span class="s2">"center"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#FF00FF"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"font_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
    </span><span class="s2">"font_family"</span><span class="p">:</span><span class="w"> </span><span class="s2">"'Playfair Display', serif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"font_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://fonts.googleapis.com/css?family=Raleway:400,700&amp;display=swap"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{stores}}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td>Identifies rectangle in the template</td>
</tr>
<tr>
<td>width</td>
<td>integer</td>
<td>yes</td>
<td>Width of rendered rectangle</td>
</tr>
<tr>
<td>height</td>
<td>integer</td>
<td>yes</td>
<td>Height of rendered rectangle</td>
</tr>
<tr>
<td>padding</td>
<td>integer</td>
<td>yes</td>
<td>Padding inside of rendered rectangle</td>
</tr>
<tr>
<td>offset_left</td>
<td>integer</td>
<td>yes</td>
<td>x position relative to the top left corner of image</td>
</tr>
<tr>
<td>offset_top</td>
<td>integer</td>
<td>yes</td>
<td>y position relative to the top left corner of image</td>
</tr>
<tr>
<td>text_align</td>
<td>enum: <code class="prettyprint">[&#39;left&#39;, &#39;center&#39;, &#39;right&#39;]</code></td>
<td>yes</td>
<td>Text alignment inside the rectangle</td>
</tr>
<tr>
<td>color</td>
<td>hex (e.g. <code class="prettyprint">&#39;#FF00EE&#39;</code>)</td>
<td>yes</td>
<td>Color of the rectangle text</td>
</tr>
<tr>
<td>font_size</td>
<td>integer</td>
<td>yes</td>
<td>Font size of the rectangle text</td>
</tr>
<tr>
<td>font_family</td>
<td>string</td>
<td>yes</td>
<td>Family definition, related to included <code class="prettyprint">font_url</code></td>
</tr>
<tr>
<td>font_url</td>
<td>URL</td>
<td>yes</td>
<td>URL of font face</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>no</td>
<td>Content to display, may contain <a href="#image-template-mergefields">merge fields</a></td>
</tr>
</tbody></table>

<h3 id="imagetemplate-merge-fields"><a name="image-template-mergefields"></a> ImageTemplate Merge-fields</h3>

<p>It is possible to use following merge-fields in order to inject offer attributes into the image generated from template.</p>

<table><thead>
<tr>
<th>Merge field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">{{name}}</code></td>
<td>Injects <code class="prettyprint">name</code> of offer</td>
</tr>
<tr>
<td><code class="prettyprint">{{description}}</code></td>
<td>Injects <code class="prettyprint">description</code> of offer</td>
</tr>
<tr>
<td><code class="prettyprint">{{collection}}</code></td>
<td>Injects <code class="prettyprint">name</code> of first collection assigned to offer</td>
</tr>
<tr>
<td><code class="prettyprint">{{stores}}</code></td>
<td>When only one store is assigned to offer, injects it as it is. When more, it injects stores joined with comma</td>
</tr>
</tbody></table>

          <h2 id="offers"><a name="offer-admin-offers"></a> Offers</h2>

<h3 id="get-offer"><a name="get-offer"></a> Get offer</h3>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/:id</code></p>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers/1000016"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an Offer object under &ldquo;offer&rdquo; key. See <a href="#admin-offer-model">Offer model</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"offer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Offer</span><span class="w"> </span><span class="err">model</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Returns details of the specified offer.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offer</td>
<td>Offer</td>
<td>no</td>
<td>See <a href="#admin-offer-model">Offer model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Get</code> permit
</aside>

<h3 id="list-offers"><a name="list-offers"></a> List offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a list of offers and pagination info. 
  See <a href="#admin-offer-model">Offer model</a> and <a href="#pagination-json-model">Pagination info model</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"offers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Offer</span><span class="w"> </span><span class="err">model</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">model</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers</code></p>

<p>Returns offers list.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>include_total</td>
<td>boolean</td>
<td>false</td>
<td>When true, detailed pagination info (containing info like total records count, next page) will be returned</td>
</tr>
<tr>
<td>sort_by</td>
<td>string</td>
<td>&ldquo;name&rdquo;</td>
<td>What attribute should results be sorted by? Supported attributes are: <code class="prettyprint">[&quot;name&quot;, &quot;usable_since&quot;, &quot;usable_until&quot;, &quot;visible_since&quot;, &quot;visible_until&quot;, &quot;created_at&quot;, &quot;updated_at&quot;, &quot;archived_at&quot;]</code></td>
</tr>
<tr>
<td>sort_direction</td>
<td>string</td>
<td>&ldquo;asc&rdquo;</td>
<td>Direction of sorting: &ldquo;asc&rdquo; or &ldquo;desc&rdquo;</td>
</tr>
<tr>
<td>collection_ids</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers belonging to least one of given collections will be returned</td>
</tr>
<tr>
<td>tags</td>
<td>string[]</td>
<td>null</td>
<td>When present, only offers having at least one of given tags will be returned</td>
</tr>
<tr>
<td>stores</td>
<td>string[]</td>
<td>null</td>
<td>When present, only offers having at least one of given stores will be returned</td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers with this campaign_id will be returned</td>
</tr>
<tr>
<td>audience_id</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers with this audience_id will be returned</td>
</tr>
<tr>
<td>search</td>
<td>string</td>
<td>null</td>
<td>When present, only offers that match the query string will be returned</td>
</tr>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>null</td>
<td>When present, only offers having one of provided IDs will be returned</td>
</tr>
<tr>
<td>without_collection</td>
<td>boolean</td>
<td>false</td>
<td>When present, only offers without collections will be returned</td>
</tr>
<tr>
<td>without_tag</td>
<td>boolean</td>
<td>false</td>
<td>When present, only offers without tags will be returned</td>
</tr>
<tr>
<td>without_audience_id</td>
<td>boolean</td>
<td>false</td>
<td>When present, only offers without audiences will be returned</td>
</tr>
<tr>
<td>without_campaign_id</td>
<td>boolean</td>
<td>false</td>
<td>When present, only offers without campaigns will be returned</td>
</tr>
<tr>
<td>without_shop</td>
<td>boolean</td>
<td>false</td>
<td>When present, only offers without stores will be returned</td>
</tr>
<tr>
<td>with_archived</td>
<td>boolean</td>
<td>false</td>
<td>When present, also archived offers will be returned</td>
</tr>
<tr>
<td>only_archived</td>
<td>boolean</td>
<td>false</td>
<td>When present, only archived offers will be returned</td>
</tr>
</tbody></table>

<p>All parameters are optional.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offers</td>
<td>Offer[]</td>
<td>no (may be empty)</td>
<td>See <a href="#admin-offer-model">Offer model</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>PaginationInfo</td>
<td>no</td>
<td>See <a href="#pagination-json-model">Pagination info model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:List</code> permit
</aside>

<h3 id="create-offers"><a name="create-offers"></a> Create offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
        {
            "offers":[
                {
                    "name": "Offer 1"
                },
                {
                    "name": "Offer 2"
                }
            ]
        }
    '</span>
</code></pre>
<blockquote>
<p>Returns object structured like this: </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"collection_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"list must contain unique values"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000284</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers</code></p>

<p>Creates offer(s) with given lists of attributes (OfferPayloads). </p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offers</td>
<td>OfferPayload[]</td>
<td>List of offers to create. See <a href="#admin-offer-payload">Offer payload</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>boolean</td>
<td>True if any offer has been created</td>
</tr>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>IDs of offers that have been created</td>
</tr>
<tr>
<td>errors</td>
<td>Object</td>
<td>Errors of offers that couldn&rsquo;t be created</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Create</code> permit
</aside>

<h3 id="update-offers"><a name="update-offers"></a> Update offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
        {
            "offers":[
                {
                    "id": 1000284,
                    "name": "Offer 1"
                },
                {
                    "id": 1000285,
                    "name": "Offer 2"
                }
            ]
        }
    '</span>
</code></pre>
<blockquote>
<p>Returns object structured like this: </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"collection_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"list must contain unique values"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers</code></p>

<p>Updates offer(s) with given lists of attributes (OfferPayloads). Also, each payload record must contain offer ID that is meant to be updated.
Update is not partial, so all attributes that aren&rsquo;t present in the payload will be nullified. </p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offers</td>
<td>OfferPayload[]</td>
<td>List of offers to update. See <a href="#admin-offer-payload">Offer payload</a>.</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>boolean</td>
<td>True if any offer has been created</td>
</tr>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>IDs of offers that have been created</td>
</tr>
<tr>
<td>errors</td>
<td>Object</td>
<td>Errors of offers that couldn&rsquo;t be created</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Update</code> permit
</aside>

<h3 id="clone-offers"><a name="clone-offers"></a> Clone offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers/clone"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
        {
            "ids":[1000284, 1000285]
        }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns IDs of offers that were created by cloning </p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1000301</span><span class="p">,</span><span class="w"> </span><span class="mi">1000302</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/clone</code></p>

<p>Clones given offers (by their IDs)</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>List of offers ids to clone</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>IDs of offers that have been cloned</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Clone</code> permit
</aside>

<h3 id="grant-offers"><a name="grant-offers"></a> Grant offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers/grant"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
        {
            "offers": [
                {
                    "id": 47,
                    "audience_id": 572,
                    "usable_for_seconds": 60
                },
                {
                    "id": 49,
                    "audience_id": 572,
                }
            ]
        }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty JSON</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/grant</code></p>

<p>Grants offer(s) to members of given audience(s).</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>offers[].id</td>
<td>integer</td>
<td>ID of offer to grant</td>
</tr>
<tr>
<td>offers[].audience_id</td>
<td>integer</td>
<td>ID of audience which members should be granted with the offer</td>
</tr>
<tr>
<td>offers[].usable_for_seconds</td>
<td>integer</td>
<td>(optional) When present, the granted offer will be available for use by member only for the defined time</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Grant</code> permit
</aside>

<h3 id="delete-offers"><a name="update-offers"></a> Delete offers</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/offers"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
    -d <span class="s1">'
        {
            "ids":[1000284, 1000285]
        }
    '</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers</code></p>

<p>Deletes given offers (by their IDs).</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ids</td>
<td>integer[]</td>
<td>List of offers ids to delete</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:Offers:Destroy</code> permit
</aside>

          <h2 id="imagetemplates"><a name="image-templates"></a> ImageTemplates</h2>

<p>This API allows managing <a href="#offer-image-template-record">ImageTemplates records</a>.</p>

<h3 id="list"><a name="offer-admin-image-templates-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t``9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#offer-image-template-record">image_templates</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"image_templates"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">image_templates</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"ImageTemplate record"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates</code></p>

<p>Returns templates defined within Loyalty Club.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>1000</td>
<td>Number of results to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>default</td>
<td>boolean</td>
<td>null</td>
<td>When true - returns only default template</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>image_templates</td>
<td>Array<ImageTemplate></td>
<td>Array of <a href="#offer-image-template-record">ImageTemplate</a></td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:List</code> permit
</aside>

<h3 id="get"><a name="offer-admin-image-templates-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#offer-image-template-record">image template</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"image_template"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Image</span><span class="w"> </span><span class="err">template</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"ImageTemplate record"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates/:image_template_id</code></p>

<p>Returns template identified by id.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>image_template_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td>ImageTemplate</td>
<td><a href="#offer-image-template-record">ImageTemplate</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>ImageTemplate does not exist</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:Get</code> permit
</aside>

<h3 id="preview"><a name="offer-admin-image-templates-preview"></a> Preview</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request GET <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates/preview'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--data-raw <span class="s1">'{
    "image_template": {
        "background_url": "https://cdn-files.dev.placewise.com/files/KnakgqRCMyj8V0jKnkR7i40eFmwKsg2Rbm7cqMN4vka0Mu1fyGAdbhRISzJzWlFzb2loRVY",
        "width": 400,
        "height": 600,
        "rectangles": [
            {
                "number": 1,
                "name": "Title",
                "offset_top": 510,
                "offset_left": 0,
                "width": 400,
                "height": 200,
                "padding": 5,
                "font_size": 30,
                "font_family": "'</span>Playfair Display<span class="s1">', serif",
                "font_url": "https://fonts.googleapis.com/css?family=Raleway:400,700&amp;display=swap",
                "color": "#eb4034",
                "text_align": "center",
                "content": "WOW {{name}}!"
            }
        ]
    }
}'</span>
</code></pre>
<blockquote>
<p>Returns generated image - <code class="prettyprint">application/png</code></p>
</blockquote>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates/preview</code></p>

<p>Generates image (<code class="prettyprint">image/png</code> MIME) for given <a href="#offer-image-template-model">ImageTemplate model</a>.</p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td><a href="#offer-image-template-model">ImageTemplate model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:Preview</code> permit
</aside>

<h3 id="create"><a name="offer-admin-image-templates-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request POST <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
--data-raw <span class="s1">'{
    "image_template": {
        "name": "My Group 1",
        "width": 1000,
        "height": 1000,
        "rectangles": [
            {
                "number": 1,
                "name": "Title",
                "offset_top": 100,
                "offset_left": 150,
                "width": 300,
                "height": 200,
                "padding": 5,
                "font_size": 40,
                "font_family": "'</span>Playfair Display<span class="s1">', serif",
                "font_url": "https://fonts.googleapis.com/css?family=Raleway:400,700&amp;display=swap",
                "color": "#FFFFFF",
                "text_align": "center",
                "content": "Oh my {{name}}!"
            }
        ]
    }
}'</span>
</code></pre>
<blockquote>
<p>Returns object containing created <a href="#offer-image-template-record">image template</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"image_template"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Image</span><span class="w"> </span><span class="err">templates</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"ImageTemplate record"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates</code></p>

<p>Creates a new template.</p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td><a href="#offer-image-template-payload">ImageTemplate Payload</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td>ImageTemplate</td>
<td>Created <a href="#offer-image-template-record">ImageTemplate</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:Create</code> permit
</aside>

<h3 id="update"><a name="offer-admin-image-templates-update"></a> Update</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request PUT <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates/4321'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
--data-raw <span class="s1">'{
    "image_template": {
        "name": "My Group 1",
        "rectangles": [
            {
                "number": 1,
                "name": "Title",
                "offset_top": 100,
                "offset_left": 150,
                "width": 300,
                "height": 200,
                "padding": 5,
                "font_size": 40,
                "font_family": "'</span>Playfair Display<span class="s1">', serif",
                "font_url": "https://fonts.googleapis.com/css?family=Raleway:400,700&amp;display=swap",
                "color": "#FFFFFF",
                "text_align": "center",
                "content": "Oh my {{name}}!"
            }
        ]
    }
}'</span>
</code></pre>
<blockquote>
<p>Returns object containing updated <a href="#offer-image-template-record">image template</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"image_template"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Image</span><span class="w"> </span><span class="err">templates</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"ImageTemplate record"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates/:image_template_id</code></p>

<p>Updates given template.</p>

<h4 id="post-parameters-json-object">POST Parameters (JSON object)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td><a href="#offer-image-template-payload">ImageTemplate Payload</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td>ImageTemplate</td>
<td>Created <a href="#offer-image-template-record">ImageTemplate</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>ImageTemplate does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:Update</code> permit
</aside>

<h3 id="destroy"><a name="offer-admin-image-templates-destroy"></a> Destroy</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl --request DELETE <span class="s1">'https://api.mpc.placewise.com/v3/infinity-mall/offers/image_templates/4321'</span> <span class="se">\</span>
--header <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
--header <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
--header <span class="s1">'x-user-agent: cURL Manual Testing'</span> <span class="se">\</span>
--header <span class="s1">'content-type: application/json'</span>
</code></pre>
<blockquote>
<p>Returns object containing deleted <a href="#offer-image-template-record">image template</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"image_template"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Image</span><span class="w"> </span><span class="err">templates</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"ImageTemplate record"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/offers/image_templates/:image_template_id</code></p>

<p>Deletes given template.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>image_template_id</td>
<td>Integer</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>image_template</td>
<td>ImageTemplate</td>
<td>The deleted <a href="#offer-image-template-record">ImageTemplate</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>ImageTemplate does not exist</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Offers:Api:ImageTemplates:Destroy</code> permit
</aside>

          <h1 id="rewards-api">Rewards API</h1>

<h2 id="introduction">Introduction</h2>

<p>Placewise Rewards is a Loyalty Program that awards members for achieving some defined goals with points.</p>

<p>The points may be spent on acquiring (purchasing) special rewards and then using them.
Points may expire after some time.</p>

<p>Participation in program is optional, so member can enroll (join) to it and leave it.</p>

<h3 id="achievements">Achievements</h3>

<p>Every Loyalty Club that has Placewise Rewards enabled, has defined list of achievements that have rules attached to them.
The rules are described below.</p>

<h3 id="achievement-model"><a name="rewards-program-achievements"></a> Achievement model</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>see <a href="#rewards-program-achievement-types">Achievement types</a></td>
</tr>
<tr>
<td>points</td>
<td>integer</td>
<td>How many points the achievement grants</td>
</tr>
<tr>
<td>limit</td>
<td>integer</td>
<td>Maximum number of times the member can have the achievement granted (when null, there&rsquo;s no limit)</td>
</tr>
<tr>
<td>frequency</td>
<td>Object</td>
<td>How often the achievement may be granted to member (when null, there are no constraints). For example, achievement with frequency defined as <code class="prettyprint">{&quot;timespan&quot;: &quot;day&quot;, &quot;limit&quot;: 5}</code> means that member may get points for it at most 5 times a day.</td>
</tr>
<tr>
<td>frequency[&lsquo;timespan&rsquo;]</td>
<td>string</td>
<td>One of: <code class="prettyprint">[&#39;hour&#39;, &#39;day&#39;, &#39;week&#39;, &#39;month&#39;, &#39;year&#39;]</code></td>
</tr>
<tr>
<td>frequency[&lsquo;limit&rsquo;]</td>
<td>integer</td>
<td></td>
</tr>
</tbody></table>

<h4 id="achievement-types"><a name="rewards-program-achievement-types"></a> Achievement types</h4>

<table><thead>
<tr>
<th>type</th>
<th>Event</th>
</tr>
</thead><tbody>
<tr>
<td>app_opened</td>
<td>The member opened the loyalty club mobile application</td>
</tr>
<tr>
<td>coupon_used</td>
<td>Member used some coupon</td>
</tr>
<tr>
<td>link_clicked</td>
<td>Member clicked on link that has been sent from us</td>
</tr>
<tr>
<td>email_opened</td>
<td>Member opened an email that has been sent from us</td>
</tr>
<tr>
<td>push_opened</td>
<td>Member opened a push message that has been sent from us</td>
</tr>
<tr>
<td>wifi_approached</td>
<td>Member approached (logged in to) loyalty club&rsquo;s WiFi</td>
</tr>
<tr>
<td>geofence_approached</td>
<td>Member approached geofence defined by loyalty club mobile application</td>
</tr>
<tr>
<td>beacon_approached</td>
<td>Member approached one of loyalty club&rsquo;s beacons</td>
</tr>
<tr>
<td>consent_granted</td>
<td>Member granted one of loyalty club&rsquo;s consents</td>
</tr>
</tbody></table>

<h3 id="member-levels"><a name="rewards-program-levels-program"></a> Member levels</h3>

<blockquote>
<p>Example configuration for regular levels</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"regular"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"levels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example configuration for virtual level</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"virtual_level"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"maximum_points"</span><span class="p">:</span><span class="w"> </span><span class="mi">1500</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Loyalty Club may have members level defined (available in <a href="#rewards-program-info">Rewards Program &bull; Get info</a> response).
There are two types of them: <code class="prettyprint">regular</code> and <code class="prettyprint">virtual_level</code>.</p>

<h4 id="regular-levels">Regular levels</h4>

<p>When regular levels are enabled, members get levels based on the amount of points that they have earned 
in program (in <strong>total</strong>, not the current balance) and may need to have minimal level to purchase some rewards. </p>

<p>Each level has <code class="prettyprint">points_threshold</code> value (integer) that describes how many points are needed to reach the level (first level always requires 0 points to have).
Levels are returned in ascending order, sorted by the <code class="prettyprint">points_threshold</code> attribute. </p>

<h4 id="single-virtual-level">Single virtual level</h4>

<p>When single virtual level is enabled, it is just used to show member how he performs in the Rewards Program.</p>

<p>It defines <code class="prettyprint">maximum_points</code> value, that is meant to be compared with member&rsquo;s <strong>current</strong> points balance.</p>

<h4 id="common-error-responses">Common error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Response body</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">467</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is banned!&quot;, &quot;banned_until&quot;: &quot;2020-10-28T17:24:06.207Z&quot;}</code></td>
</tr>
<tr>
<td><code class="prettyprint">480</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is not participating in Rewards Program&quot;}</code></td>
</tr>
</tbody></table>

<h2 id="rewards-program">Rewards Program</h2>

<h3 id="get-info"><a name="rewards-program-info"></a> Get info</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/rewards-program/info"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"achievements"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_opened"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
      </span><span class="s2">"limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="s2">"timespan"</span><span class="p">:</span><span class="w"> </span><span class="s2">"day"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"consent_granted"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"points"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"limit"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"frequency"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"levels_program"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"regular"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"levels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"points_threshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"reward_activation_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/rewards-program/info</code></p>

<p>Returns information about Rewards Program in Loyalty Club. </p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>achievements</td>
<td>Array<Achievement></td>
<td>List of Achievement objects - see <a href="#rewards-program-achievements">Achievements</a></td>
</tr>
<tr>
<td>reward_activation_time</td>
<td>integer</td>
<td>Time in seconds describing how long the reward is active after use</td>
</tr>
<tr>
<td>levels_program</td>
<td>object</td>
<td>Definition of member levels - see <a href="#rewards-program-levels-program">Levels</a>. When null, there are no levels.</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:Program:GetInfo</code> permit
</aside>

<h3 id="join"><a name="rewards-program-join"></a> Join</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/join"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/join</code></p>

<p>Registers current member in Rewards Program. This results granting &ldquo;rewards_enrollment&rdquo; consent to user.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Memberships:Create</code> permit
</aside>

<h3 id="leave"><a name="rewards-program-leave"></a> Leave</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/leave"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/leave</code></p>

<p>Removes current member from Rewards Program. This results in removing &ldquo;rewards_enrollment&rdquo; consent from member
and <strong>deletion of all points and transaction from Rewards Program.</strong></p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Memberships:Delete</code> permit
</aside>

<h3 id="get-status"><a name="rewards-program-status"></a> Get status</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/status"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"membership"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"membership_started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-05-15T12:43:22:41063Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w">
  </span><span class="s2">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_purchase"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-15T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">-20</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"reward_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Toaster"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"expiration"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-14T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">-110</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"achievement"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-10T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"achievement_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_opened"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correction"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-05T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"comment"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Just for you"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"achievement"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-06-41T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">110</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expired_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-12-15T08:00:15063Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"achievement_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coupon_used"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2050</span><span class="p">,</span><span class="w">
    </span><span class="s2">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"prev_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_first_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_last_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_out_of_range"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">  
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When member hasn&rsquo;t joined the program, returns a response having only one key:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"membership"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/status</code></p>

<p>Returns Rewards Program status for current member.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>no</td>
<td>1000</td>
<td>Number of transactions to be returned per request (1000 is the maximum)</td>
</tr>
<tr>
<td>page</td>
<td>integer</td>
<td>no</td>
<td>1</td>
<td>Number of transactions page</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>membership</td>
<td>boolean</td>
<td>Does member participate the Rewards Program?</td>
</tr>
<tr>
<td>membership_started_at</td>
<td>Date</td>
<td>When the member joined the Rewards Program</td>
</tr>
<tr>
<td>balance</td>
<td>integer</td>
<td>Member&rsquo;s current points number</td>
</tr>
<tr>
<td>transactions</td>
<td>Array</td>
<td>List of Transactions objects, ordered by date descending. See below</td>
</tr>
<tr>
<td>pagination_info</td>
<td>Object</td>
<td><a href="#pagination-model">Pagination</a> object describing transactions list</td>
</tr>
</tbody></table>

<h4 id="transaction-object">Transaction object</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>One of: &lsquo;achievement&rsquo;, &lsquo;reward_purchase&rsquo;, &lsquo;expiration&rsquo; and &lsquo;correction&rsquo;</td>
<td>see &ldquo;Transaction types&rdquo; below</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
<td>When the transaction has been made</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>How many points the transaction added or subtracted</td>
</tr>
<tr>
<td>expired_at</td>
<td>Date</td>
<td>(optional) When the points granted by the transaction expired. When null, they&rsquo;re not expired</td>
</tr>
<tr>
<td>details</td>
<td>Object</td>
<td>Transaction-specific details - see &ldquo;Transaction details&rdquo; below</td>
</tr>
</tbody></table>

<h4 id="transaction-types">Transaction types</h4>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>achievement</td>
<td>Addition of points triggered by fulfilling an achievement goal</td>
</tr>
<tr>
<td>reward_purchase</td>
<td>Reduction of points caused by purchasing a reward by member</td>
</tr>
<tr>
<td>expiration</td>
<td>Reduction of points caused by automatic expiration of old transactions</td>
</tr>
<tr>
<td>correction</td>
<td>Change of points caused by admin&rsquo;s manual correction</td>
</tr>
</tbody></table>

<h4 id="transaction-details">Transaction details</h4>

<p>Depending on transaction type, the details contain different kind of data.</p>

<table><thead>
<tr>
<th>Transaction type</th>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>achievement</td>
<td>achievement_type</td>
<td>Type of achievement that granted the points - see <a href="#rewards-program-achievement-types">Achievement types</a></td>
</tr>
<tr>
<td>reward_purchase</td>
<td>reward_name</td>
<td>Name of reward that the points have been spent on</td>
</tr>
<tr>
<td>correction</td>
<td>comment</td>
<td>(optional) Admin&rsquo;s notes</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Memberships:CheckStatus</code> permit
</aside>

<h3 id="get-status-by-member-id"><a name="rewards-program-status-by-member-id"></a> Get status by member ID</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/837182/rewards-program/status"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns response as in <a href="$rewards-program-status">Rewards Program &bull; Get Status</a></p>
</blockquote>

<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/members/:id/rewards-program/status</code></p>

<p>Returns Rewards Program status for member identified by given ID.
Works just the same as <a href="#rewards-program-status">Rewards Program &bull; Get Status</a>.</p>

<aside class="notice">
Requires <code>Rewards:Api:Memberships:CheckStatus</code> permit
</aside>

<h3 id="achievements-summary"><a name="rewards-program-achievements-summary"></a> Achievements summary</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/status/achievements_summary"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"achievements_by_type"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"app_opened"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"times_achieved"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"beacon_approached"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"times_achieved"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"link_clicked"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"times_achieved"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"achievements_by_month"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2019</span><span class="p">,</span><span class="w">
            </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"achievements_made"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2019</span><span class="p">,</span><span class="w">
            </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"achievements_made"</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">950</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
            </span><span class="s2">"month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
            </span><span class="s2">"achievements_made"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
            </span><span class="s2">"total_amount_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">580</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">another</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="err">months</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/status/achievements_summary</code></p>

<p>Returns a summary for achievements made by member, grouped by type and month.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>months_no</td>
<td>integer</td>
<td>no</td>
<td>12</td>
<td>Number of last months to fetch. Must be in (0..999) range</td>
</tr>
</tbody></table>

<h4 id="achievement-by-type-json-object">Achievement by type JSON object</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>See: <a href="#rewards-program-achievement-types">Achievement types</a></td>
</tr>
<tr>
<td>times_achieved</td>
<td>integer</td>
<td>Number of times member made the achievements of this type</td>
</tr>
<tr>
<td>total_amount_earned</td>
<td>integer</td>
<td>Sum of points member get with this achievement type</td>
</tr>
</tbody></table>

<h4 id="achievement-by-month-json-object">Achievement by month JSON object</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>year</td>
<td>integer</td>
<td>four-digit year, e.x. 2019</td>
</tr>
<tr>
<td>month</td>
<td>integer</td>
<td>1-12</td>
</tr>
<tr>
<td>achievements_made</td>
<td>integer</td>
<td>Number of achievements made by member in that month</td>
</tr>
<tr>
<td>total_amount_earned</td>
<td>integer</td>
<td>Sum of points member achieved in that month</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Memberships:CheckStatus</code> permit
</aside>

          <h2 id="rewards">Rewards</h2>

<h3 id="list"><a name="rewards-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/rewards"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"rewards"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000062</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Toaster"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It has incredible features."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"required_member_level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"remaining_stock"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
      </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="w">
        </span><span class="p">}</span><span class="w">                
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/rewards</code></p>

<p>Returns list of rewards available to purchase by member.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>rewards</td>
<td>Array</td>
<td>List of Rewards - see below</td>
</tr>
</tbody></table>

<h4 id="reward"><a name="reward-model"></a> Reward</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>(optional)</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>(optional)</td>
</tr>
<tr>
<td>price</td>
<td>integer</td>
<td>Number of points that must be spent to purchase the reward</td>
</tr>
<tr>
<td>required_member_level</td>
<td>string</td>
<td>(optional) Minimal level name the members needs to have to be able to purchase the reward. See <a href="#rewards-program-levels-program">Levels</a></td>
</tr>
<tr>
<td>remaining_stock</td>
<td>integer</td>
<td>(optional) Number of items that is available for purchase. When null, there is no limit</td>
</tr>
<tr>
<td>files</td>
<td>Array</td>
<td>A list of Reward Files - see <a href="#file-model">File model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Rewards:List</code> permit
</aside>

<h3 id="list-purchased"><a name="rewards-list-purchased"></a> List purchased</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/rewards/purchased"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"rewards"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000062</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Toaster"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It has incredible features."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000062-default-mobile.jpg"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="w">
        </span><span class="p">}</span><span class="w">                
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"usage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"left"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"usable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"active_until"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-31T11:24:15.278Z"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/rewards/purchased</code></p>

<p>Returns list of rewards purchased by member.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>Response looks as in <a href="#rewards-list">Reward list</a>, but with reward usage instead of purchasing info</p>

<h4 id="usage"><a name="rewards-usage"></a> Usage</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>left</td>
<td>integer</td>
<td>(optional) How many more times the member can use the Reward. Null, when there&rsquo;s no usage limit</td>
</tr>
<tr>
<td>active_until</td>
<td>Date</td>
<td>(optional) The last time time the reward has been used at + activation time (configurable per Loyalty Club, e.x. 30s). When null, the reward has not been activated (used) yet</td>
</tr>
<tr>
<td>usable</td>
<td>boolean</td>
<td>Will the reward be still usable after activation time passes?</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Rewards:ListPurchased</code> permit
</aside>

<h3 id="purchase"><a name="rewards-purchase"></a> Purchase</h3>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/rewards/153/purchase"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/rewards/:id/purchase</code></p>

<p>Adds one of available rewards to member&rsquo;s purchased list and reduces member&rsquo;s balance by price.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Response body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Reward#10000951 not found&quot;}</code></td>
<td>-</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Not enough points&quot;}</code></td>
<td>Member has no enough points to purchase the reward</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member level is not high enough&quot;}</code></td>
<td>Member level is not high enough to purchase the reward</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Global limit exceeded&quot;}</code></td>
<td>There are no more rewards available to purchase</td>
</tr>
<tr>
<td><code class="prettyprint">467</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is banned!&quot;, &quot;banned_until&quot;: &quot;2137-10-28T17:24:06.207Z&quot;}</code></td>
<td>Member is banned</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Rewards:Purchase</code> permit
</aside>

<h3 id="use"><a name="rewards-use"></a> Use</h3>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/members/me/rewards-program/rewards/153/use"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'authorization: Bearer 8433d608645345a45ce5a0f5ba1225e57546e86ac49e5fec842159dc82218522'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an empty object:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"usage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"left"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"usable"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"active_until"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-31T11:24:15.278Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/infinity-mall/members/me/rewards-program/rewards/:id/use</code></p>

<p>Uses (activates) one of usable rewards purchased by member.</p>

<p>As a member-related action, it requires member authorization. See <a href="#oauth2">OAuth</a>.</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>usage</td>
<td>Object</td>
<td>See <a href="#rewards-usage">Reward Usage</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Response body</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Reward#10000951 not found&quot;}</code></td>
<td>-</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Already active&quot;}</code></td>
<td>The reward has been just used</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Not granted&quot;}</code></td>
<td>The reward has not been purchased by member</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;User limit exceeded&quot;}</code></td>
<td>There are no more rewards available to purchase for the member</td>
</tr>
<tr>
<td><code class="prettyprint">467</code></td>
<td><code class="prettyprint">{&quot;error&quot;: &quot;Member is banned!&quot;, &quot;banned_until&quot;: &quot;2137-10-28T17:24:06.207Z&quot;}</code></td>
<td>Member is banned</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Rewards:Api:OAuth:Rewards:Use</code> permit
</aside>

          <h1 id="transactions-api">Transactions API</h1>

<h2 id="transactions">Transactions</h2>

<h3 id="create"><a name="transactions-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
         "transactions": [
             {
                 "identifier_type": "id",
                 "identifier": 123456,
                 "store_id": "store_id",
                 "event_date": "2019-02-02T18:48:47+08:00",
                 "total": 10.0,
                 "receipt_id": "receipt id",
                 "tax": 1.0,
                 "currency": "NOK",
                 "items": [
                     {
                         "id": "1",
                         "discount": 0.0,
                         "tax": 1,
                         "amount": 1,
                         "price": 5.0,
                         "main_product_category": "category name",
                         "main_product_category_id": "category id",
                         "main_product_category_number": "1",
                         "product_category": "category name",
                         "product_category_id": "category id",
                         "product_category_number": "1",
                         "description": "item description"
                     },
                     {
                         "id": "2",
                         "discount": 0.0,
                         "tax": 1.0,
                         "amount": 1,
                         "price": 5,
                         "main_product_category": "category name",
                         "main_product_category_id": "category id"
                     }
                 ],
                 "loyalty_points": 100
             }
         ]
     }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"91cd14a0-b9b5-4e21-950c-a10b16934a91"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1ad96fb7-fb77-4981-b2a6-89549a6f5ed6"</span><span class="p">],</span><span class="w">
      </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f4c2b7a6-e0fb-47a3-9b5a-02d3854fcea3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"5a8fd797-ba18-4c9c-9d70-c7acdd7805b6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"bc20e6a6-4792-4c94-8c30-4198bf8247c5"</span><span class="p">],</span><span class="w">
      </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Member doesn't exist"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"transactions[1].store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This value should not be blank."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions?transaction_id=43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of transactions objects structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
      </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"receipt id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"event_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-02T02:02:02+0000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NOK"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sales_person"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales person"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"transactions[1].store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This value should not be blank."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions</code></p>

<p>Register transactions, stamps or bonus points will be calculated based on the configured loyalty program.</p>

<h4 id="messages-post-parameters-json-array">Messages POST Parameters (JSON array)</h4>

<p>Expected payload is either object with <code class="prettyprint">transactions</code> attribute containing array of <code class="prettyprint">transaction</code> objects with attributes as described below or single <code class="prettyprint">transaction</code> object:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier_type *</td>
<td>string (id, msisdn, email)</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>identifier *</td>
<td>msisdn (string), email (string), member_id (int)</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>store_id *</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>receipt_id</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>event_date *</td>
<td>string</td>
<td>use format with timezone</td>
<td></td>
</tr>
<tr>
<td>total *</td>
<td>float</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>tax *</td>
<td>float</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>items *</td>
<td>array</td>
<td>n/a</td>
<td>array of <code class="prettyprint">item</code> objects</td>
</tr>
<tr>
<td>calculate_rewards</td>
<td>bool</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>currency</td>
<td>string</td>
<td>Loyalty Club&rsquo;s currency</td>
<td></td>
</tr>
<tr>
<td>sales_person</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>terminal_id</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>store_tax_id</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>store_msisdn</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>loyalty_coupons</td>
<td>array of strings</td>
<td>n/a</td>
<td>list of coupons ids / codes</td>
</tr>
<tr>
<td>loyalty_giftcards</td>
<td>array of strings</td>
<td>n/a</td>
<td>list of codes</td>
</tr>
<tr>
<td>loyalty_points</td>
<td>integer</td>
<td>n/a</td>
<td></td>
</tr>
</tbody></table>

<p>* required</p>

<p><code class="prettyprint">item</code> object is a hash with following attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id *</td>
<td>string</td>
<td>n/a</td>
<td>item id</td>
</tr>
<tr>
<td>price *</td>
<td>float</td>
<td>n/a</td>
<td>negative values will be treated as discounts</td>
</tr>
<tr>
<td>amount *</td>
<td>integer</td>
<td>n/a</td>
<td>negative values will be treated as refunds</td>
</tr>
<tr>
<td>discount *</td>
<td>float</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>tax *</td>
<td>float</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>calculate_rewards *</td>
<td>bool</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>item_number</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>properties</td>
<td>hash key: value</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>product_category</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>product_category_id</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>product_category_number</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>main_product_category</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>main_product_category_id</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>main_product_category_number</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
</tbody></table>

<p>* required</p>

<p>Negative price and amount will result in error.</p>

<p>You can provide <code class="prettyprint">callback_url</code> in the root object. If it&rsquo;s available after processing we will send <code class="prettyprint">POST</code> request to that URL with body as below:
<code class="prettyprint">
{
    &quot;transaction_id&quot;: &quot;UUID&quot;,
    &quot;receipt_id&quot;: &quot;id&quot;,
    &quot;items&quot;: [&quot;UUID&quot;, &quot;UUID&quot;],
    &quot;result&quot; =&gt; &quot;OK|error message&quot;
}
</code></p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Message has been accepted for sending</td>
</tr>
<tr>
<td>Member doesn&rsquo;t exist</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Transactions:Create</code> and <code>BL:Api:Members:Get</code> permits
</aside>

<h3 id="list"><a name="transactions-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions?transaction_id=43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of transactions objects structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
      </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"receipt id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"event_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-02T02:02:02+0000"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NOK"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sales_person"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales person"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"terminal id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"store_tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store tax id"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"store_msisdn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"msisdn"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When parameters are invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"At least one value required: {{ transactionId, storeId, receiptId, memberId, salesPerson, currency }}"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions</code></p>

<p>List registered transactions</p>

<h4 id="request-parameters">Request Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>transaction_id *</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>store_id *</td>
<td>array</td>
<td></td>
</tr>
<tr>
<td>receipt_id *</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>member_id *</td>
<td>int</td>
<td></td>
</tr>
<tr>
<td>sales_person *</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>currency *</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>ignore_loyalty</td>
<td>bool</td>
<td></td>
</tr>
<tr>
<td>min_total_gross</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>max_total_gross</td>
<td>float</td>
<td></td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>field to sort by</td>
</tr>
<tr>
<td>order</td>
<td>string (ASC, DESC)</td>
<td></td>
</tr>
</tbody></table>

<p>* required at least one of starred parameters </p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Transactions:Get</code> permit
</aside> 

<h3 id="get"><a name="transactions-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns transactions object structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43cb7852-5190-4d1d-9b1f-6d6cf552424b"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
  </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"receipt id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"event_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-02-02T02:02:02+0000"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NOK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sales_person"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales person"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"terminal_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"terminal id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"store_tax_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"store tax id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"store_msisdn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"msisdn"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_category_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"category id"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_category_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"product_category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Category"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">transaction_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Transaction not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/:id</code></p>

<p>Get transaction with items</p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Transactions:Get</code> permit
</aside> 

<h2 id="categories">Categories</h2>

<h3 id="list"><a name="transactions-categories-get"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/categories"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns categories objects structured like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2276bb58-45a4-4d49-b25b-896a78b06730"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"main"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"category"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ID"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13b2a321-280e-48fc-bf18-54b61dc6d577"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sub"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subcategory"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2276bb58-45a4-4d49-b25b-896a78b06730"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ID2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19c3f19c-f090-43f1-8439-824406449a2e"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13b2a321-280e-48fc-bf18-54b61dc6d577"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When parameters are invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The value you selected is not a valid choice."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This value should be of type array."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/categories</code></p>

<p>Get categories</p>

<h4 id="request-parameters">Request Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string (main, sub, item)</td>
<td></td>
</tr>
<tr>
<td>parent_id</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>100</td>
</tr>
<tr>
<td>id</td>
<td>array</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Transactions:Get</code> permit
</aside> 

<h2 id="events">Events</h2>

<h3 id="create-events"><a name="transactions-events-create"></a> Create events</h3>

<blockquote>
<p>Example:</p>

<p>e-Vouchers</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/events"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> 
    -d <span class="se">\</span>
    <span class="s1">'{
        { 
          "type": "use_evoucher",
          "bulk":
            [
                {
                    "identifier": 1,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "voucher_id": 1,
                    "store_id": "8",
                    "voucher_name": "name",
                    "serial_number": "serial_number"
                },
                {
                    "identifier": 2,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "voucher_id": 2,
                    "store_id": "8",
                    "voucher_name": "name",
                    "serial_number": "serial_number"
                },
                {
                    "identifier": 3,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "voucher_id": 3,
                    "store_id": "8",
                    "voucher_name": "name",
                    "serial_number": "serial_number"
                }
            ]
        }
    }'</span>
</code></pre>
<blockquote>
<p>GWP</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/categories"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span> 
    -d <span class="se">\</span>
    <span class="s1">'{
        { 
          "type": "redeem_gwp",
          "bulk":
            [
                {
                    "identifier": 44837522,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "campaign_id": 1,
                    "item_id": "8",
                    "campaign_name": "campaign_name",
                    "item_name": "item_name",
                    "serial_number": "serial_number",
                    "detail_id": "detail_id",
                    "quantity": 1
                },
                {
                    "identifier": 44837522,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "campaign_id": 1,
                    "item_id": "8",
                    "campaign_name": "campaign_name",
                    "item_name": "item_name",
                    "serial_number": "serial_number",
                    "detail_id": "detail_id",
                    "quantity": 1
                },
                {
                    "identifier": 44837522,
                    "identifier_type": "id",
                    "event_date": "2019-09-11T12:00:00+01:00",
                    "campaign_id": 1,
                    "item_id": "8",
                    "campaign_name": "campaign_name",
                    "item_name": "item_name",
                    "serial_number": "serial_number",
                    "detail_id": "detail_id",
                    "quantity": 1,
                    "additional_properties": 
                    {
                        "property_name": "property_value"
                    }                    
                }
            ]
        }
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), result is ok for every event:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="s2">"event_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4cca1661-7647-4a48-9664-a68b2075451d"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"event_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c3506406-b89e-4aef-8b33-c19aceb8ad6c"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"event_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eed0173c-a51d-4afb-a819-0320fabf77e9"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"[0].store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property store_id is required"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"[0].voucher_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property voucher_id is required"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"[1].voucher_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property voucher_name is required"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"[1].serial_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property serial_number is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/events</code></p>

<p>Send different bonus events events</p>

<h4 id="request-parameters">Request Parameters</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>type of events (redeem_gwp, use_evoucher)</td>
</tr>
<tr>
<td>bulk</td>
<td>array</td>
<td>array of event objects</td>
</tr>
</tbody></table>

<p>Bulk contains many events of specified type.</p>

<p>e-Vouchers event</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>string</td>
<td>Member identifier</td>
</tr>
<tr>
<td>identifier_type</td>
<td>string</td>
<td>Member identifier type (id, msisdn, email)</td>
</tr>
<tr>
<td>event_date</td>
<td>string</td>
<td>datetime formatted according to ISO 8601, <strong>use timezone</strong></td>
</tr>
<tr>
<td>voucher_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>store_id</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>voucher_name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>serial_number</td>
<td>string</td>
<td></td>
</tr>
</tbody></table>

<p>GWP event</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>string,integer</td>
<td>Member identifier</td>
</tr>
<tr>
<td>identifier_type</td>
<td>string</td>
<td>Member identifier type (id, msisdn, email)</td>
</tr>
<tr>
<td>event_date</td>
<td>string</td>
<td>datetime formatted according to ISO 8601, <strong>use timezone</strong></td>
</tr>
<tr>
<td>campaign_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>campaign_name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>item_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>item_name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>serial_number</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>detail_id</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>quantity</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>additional_properties</td>
<td>object</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Events:Create</code> permit
</aside> 

          <h2 id="points">Points</h2>

<h3 id="create"><a name="points-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/points"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'[
        {
            "identifier_type": "id",
            "identifier": 3456,
            "amount": 10,
            "event_type": "purchase",
            "event": "used coupon",
            "event_date": "2019-07-12T15:23:21Z",
            "message": "Black Friday",
            "store_id": "12345",
            "transaction_id": "f4c2b7a6-e0fb-47a3-9b5a-02d3854fcea3",
            "wallet": "default",
            "wallet_new_balance": 10,
            "expiry_points_date": "2020-02-12",
            "expiry_points_balance": 10
            "additional_properties" : 
                {
                    "property_name": "property_value"
                }
        }
    ]'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"event_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"purchase"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When request is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"[1].property"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property {property} is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/points</code></p>

<p>Add or remove points from member wallets. All unasigned points belongs to default wallet</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>identifier_type*</td>
<td>Type of identifier</td>
<td>string (id, msisdn, email)</td>
</tr>
<tr>
<td>identifier*</td>
<td>Identifier</td>
<td>msisdn (string), email (string), member_id (int)</td>
</tr>
<tr>
<td>event_type*</td>
<td>Type of event</td>
<td>string (purchase, issue, campaign, use, revoke, expire, other)</td>
</tr>
<tr>
<td>amount*</td>
<td>store name</td>
<td>int (not 0)</td>
</tr>
<tr>
<td>event</td>
<td>description of event</td>
<td>string</td>
</tr>
<tr>
<td>message</td>
<td>additional remarks</td>
<td>string</td>
</tr>
<tr>
<td>store_id</td>
<td>store id</td>
<td>string</td>
</tr>
<tr>
<td>transaction_id</td>
<td>DMP transaction id</td>
<td>string</td>
</tr>
<tr>
<td>event_date</td>
<td>date of event allow adding past events</td>
<td>datetime</td>
</tr>
<tr>
<td>wallet</td>
<td>wallet</td>
<td>string</td>
</tr>
<tr>
<td>wallet_new_balance</td>
<td>Current points balance in the wallet (used only by integration without loyalty logic)</td>
<td>integer</td>
</tr>
<tr>
<td>expiry_points_date</td>
<td>Points expiry date  (used only by integration without loyalty logic)</td>
<td>date</td>
</tr>
<tr>
<td>expiry_points_balance</td>
<td>Present point balance in the wallet for specific expiry date (used only by integration without loyalty logic)</td>
<td>integer</td>
</tr>
<tr>
<td>additional_properties</td>
<td>Any optional properties</td>
<td>object</td>
</tr>
</tbody></table>

<p>Parameters with <code class="prettyprint">*</code> are required</p>

<h4 id="type-of-events">Type of events</h4>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>purchase</td>
<td>points added by making a purchase (positive amount required)</td>
</tr>
<tr>
<td>campaign</td>
<td>points added due to campaign event (positive amount required)</td>
</tr>
<tr>
<td>issue</td>
<td>points added (positive amount required)</td>
</tr>
<tr>
<td>use</td>
<td>points used by a member (reward, discount, etc) (negative amount required)</td>
</tr>
<tr>
<td>revoke</td>
<td>points removed from member account due to refund etc. (negative amount required)</td>
</tr>
<tr>
<td>expire</td>
<td>points removed due to expiration (negative amount required)</td>
</tr>
<tr>
<td>other</td>
<td></td>
</tr>
</tbody></table>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Points saved</td>
</tr>
<tr>
<td>Member does not exist</td>
<td></td>
</tr>
<tr>
<td>Store does not exists</td>
<td></td>
</tr>
<tr>
<td>Incorrect amount</td>
<td>Positive amount when using points, negative amount when issuing points etc</td>
</tr>
<tr>
<td>Not enough points in the wallet</td>
<td>Not enough points when using a points</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Points:Create</code>
</aside>

<h3 id="member-points"><a name="member-points"></a> Member points</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/points/by_member_id/12345"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"default_wallet"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="s2">"other_wallet"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/points/by_member_id/:member_id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/points/by_msisdn/:msisdn</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/points/by_email/:email</code></p>

<p>Return number of points that member has filtered by different wallets</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>Member id</td>
<td>integer</td>
</tr>
<tr>
<td>msisdn</td>
<td>Member msisdn</td>
<td>string</td>
</tr>
<tr>
<td>email</td>
<td>Member email</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Points:Get</code> permit
</aside>

<h3 id="member-points-list"><a name="member-points-list"></a> Member points list</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/transactions/points/events/12345?type=issue_points&amp;event=Event1&amp;external_event_id=12345"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
        </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-09-11T12:00:00+0100"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"issue_points"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"wallet"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default_wallet"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w">
        </span><span class="s2">"wallet_new_balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"receipt_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"receipt"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"event"</span><span class="p">:</span><span class="w"> </span><span class="s2">"used coupon"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Black Friday"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"external_event_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/transactions/points/events/:member_id</code></p>

<p>Return list of point events that member has, filtered by event type</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
<th>Required/Optional</th>
</tr>
</thead><tbody>
<tr>
<td>member_id</td>
<td>Member id</td>
<td>integer</td>
<td>required</td>
</tr>
<tr>
<td>type</td>
<td>Type (issue_points, use_points, revoke_points, expire_points)</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>event</td>
<td>Event name</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>message</td>
<td>Message</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>wallet</td>
<td>Wallet</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>amount</td>
<td>Amount of points</td>
<td>integer</td>
<td>optional</td>
</tr>
<tr>
<td>receipt_id</td>
<td>Receipt</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>store_id</td>
<td>Store id</td>
<td>string</td>
<td>optional</td>
</tr>
<tr>
<td>external_event_id</td>
<td>External event id</td>
<td>string</td>
<td>optional</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Transaction:Api:Points:List</code> permit
</aside>

          <h1 id="pos-campaign-api">POS Campaign API</h1>

<h2 id="create"><a name="pos-campaigns-config-create"></a> Create</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/pos-campaigns/points"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{

         "name": "Default Campaign",
         "bonus": {
             "type": "amount",
             "value": 50
         },
         "conditions": 
         {
             "condition":"Or",
             "arg": [
                 {
                     "condition":"StoreId",
                     "arg": "910"
                 },
                 {
                     "condition":"ItemId",
                     "arg" : "112"
                 }
             ]
         },
         "start":  "2019-02-02T18:48:47+08:00",
         "end" :  "2022-02-02T18:48:47+08:00"
     }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"bonus.value"</span><span class="p">:</span><span class="s2">"String value found, but an integer is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/pos-campaigns/:type</code></p>

<p>Create POS Campaign.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>POS Campaign type</td>
<td>enum [&ldquo;points&rdquo;, &ldquo;stamps&rdquo;]</td>
</tr>
</tbody></table>

<h4 id="messages-post-parameters-json">Messages POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>string</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>bonus*</td>
<td>Bonus</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>conditions*</td>
<td>Condition</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>start*</td>
<td>string</td>
<td>use format with timezone</td>
<td></td>
</tr>
<tr>
<td>end*</td>
<td>string</td>
<td>use format with timezone</td>
<td></td>
</tr>
</tbody></table>

<p>* required</p>

<p><code class="prettyprint">Bonus</code> object is a hash with following attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type*</td>
<td>enum: [&ldquo;amount&rdquo;, &ldquo;percentage&rdquo;, &ldquo;extra&rdquo;]</td>
<td>n/a</td>
<td></td>
</tr>
<tr>
<td>value*</td>
<td>integer</td>
<td>n/a</td>
<td></td>
</tr>
</tbody></table>

<p>* required</p>

<p><code class="prettyprint">Condition</code> object is a hash with following attributes:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>condition*</td>
<td>string</td>
<td>n/a</td>
<td>Class name</td>
</tr>
<tr>
<td>args*</td>
<td>Condition, Condition[], integer, string, array</td>
<td>n/a</td>
<td></td>
</tr>
</tbody></table>

<p>* required</p>

<h3 id="conditions-list"><a name="pos-campaigns-config-conditions"></a> Conditions List</h3>

<table><thead>
<tr>
<th>Condition</th>
<th>Args</th>
<th>Type</th>
<th>Meets requirements when</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">Or</code></td>
<td>Condition[]</td>
<td>One of</td>
<td>One of conditions meets requirements</td>
</tr>
<tr>
<td><code class="prettyprint">And</code></td>
<td>Condition[]</td>
<td>All of</td>
<td>All of conditions meet requirements</td>
</tr>
<tr>
<td><code class="prettyprint">Not</code></td>
<td>Condition</td>
<td>Negation</td>
<td>Condition does not meet requirements</td>
</tr>
<tr>
<td><code class="prettyprint">ItemId</code></td>
<td>string</td>
<td>Equal</td>
<td>Item ID is equal to arg</td>
</tr>
<tr>
<td><code class="prettyprint">CategoryId</code></td>
<td>string</td>
<td>Equal</td>
<td>Category ID is equal to arg</td>
</tr>
<tr>
<td><code class="prettyprint">StoreId</code></td>
<td>string</td>
<td>Equal</td>
<td>Store ID is equal to arg</td>
</tr>
</tbody></table>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"Or"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"arg"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"StoreId"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"arg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"910"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"And"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"arg"</span><span class="w"> </span><span class="p">:</span><span class="w"> 
            </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"ItemId"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"arg"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"112"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"Not"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"arg"</span><span class="w"> </span><span class="p">:</span><span class="w"> 
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"condition"</span><span class="p">:</span><span class="s2">"StoreId"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"arg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"910"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">     
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h2 id="delete"><a name="pos-campaigns-config-delete"></a> Delete</h2>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/pos-campaigns/points"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
         "id":1
     }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns empty array:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[]</span><span class="w">
</span></code></pre>
<blockquote>
<p>When payload is invalid (422), returns an object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="s2">"Can not delete campaign. Campaign does not exist."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/pos-campaigns/:type</code></p>

<p>Remove POS Campaign.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>POS Campaign type</td>
<td>enum [&ldquo;points&rdquo;, &ldquo;stamps&rdquo;]</td>
</tr>
</tbody></table>

<h4 id="messages-delete-parameters-json">Messages DELETE Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id*</td>
<td>integer</td>
<td>n/a</td>
<td>ID obtained by <a href="#pos-campaigns-config-create">CREATE</a>  method</td>
</tr>
</tbody></table>

<p>* required</p>

          <h1 id="stores-api">Stores API</h1>

<h2 id="stores">Stores</h2>

<h3 id="list"><a name="store-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores?department_id=123&amp;search=test&amp;category=cat&amp;limit=100&amp;sort=name&amp;order=asc"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of store objects structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departament name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"category 1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"category 2"</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="s2">"floor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"floor"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"location"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"area"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="s2">"zones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"zone"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"opening_hours"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"monday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tuesday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wednesday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thursday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"friday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saturday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-18:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sunday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"closed"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"logo_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://foo.foo/foo.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Description"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores</code></p>

<p>List of all active stores</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>department_id</td>
<td>department id</td>
<td>integer</td>
</tr>
<tr>
<td>category</td>
<td>filter by single category</td>
<td>string</td>
</tr>
<tr>
<td>zone</td>
<td>filter by single zone</td>
<td>string</td>
</tr>
<tr>
<td>name</td>
<td>filter by part of store name</td>
<td>string</td>
</tr>
<tr>
<td>search</td>
<td>filter by all searchable fields</td>
<td>string</td>
</tr>
<tr>
<td>logo</td>
<td>show store log url</td>
<td>bool</td>
</tr>
<tr>
<td>limit</td>
<td>max number of results</td>
<td>integer</td>
</tr>
<tr>
<td>sort</td>
<td>field to sort by (name,id,store_id)</td>
<td>string</td>
</tr>
<tr>
<td>order</td>
<td>order (asc,desc)</td>
<td>string</td>
</tr>
</tbody></table>

<p>All parameters are optional</p>

<aside class="notice">
Requires <code>Stores:Api:Stores:Get</code> permit
</aside> 

<h3 id="get"><a name="store-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/123456"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns department object structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"parent_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Departament name"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"category 1"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"category 2"</span><span class="w">
          </span><span class="p">],</span><span class="w">
        </span><span class="s2">"floor"</span><span class="p">:</span><span class="w"> </span><span class="s2">"floor"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"location"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"area"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
        </span><span class="s2">"zones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"zone"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"opening_hours"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"monday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tuesday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wednesday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thursday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"friday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-20:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"saturday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:00-18:00"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sunday"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"hours"</span><span class="p">:</span><span class="w"> </span><span class="s2">"closed"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"logo_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://foo.foo/foo.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Description"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/:id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/by_store_id/:store_id</code></p>

<p>Return store by one of two identifiers: <code class="prettyprint">id</code> or <code class="prettyprint">store_id</code></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID internal</td>
<td>integer</td>
</tr>
<tr>
<td>store_id</td>
<td>Store id from customer system</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Stores:Get</code> permit
</aside>

<h3 id="create"><a name="store-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "name": "store name",
        "store_id": "6789",
        "department_id": 12345,
        "categories": [
            "category"
        ],
        "floor": "2nd Floor",
        "location": "12a",
        "area": 50,
        "zones": [
            "zone"
        ],
        "opening_hours": [
            {
                "name":"monday",
                "hours":"10:00-20:00"
            },
            {
                "name":"tuesday",
                "hours":"10:00-20:00"
            },
            {
                "name":"wednesday",
                "hours":"10:00-20:00"
            },
            {
                "name":"thursday",
                "hours":"10:00-20:00"
            },
            {
                "name":"friday",
                "hours":"10:00-20:00"
            },
            {
                "name":"saturday",
                "hours":"10:00-18:00"
            },
            {
                "name":"sunday",
                "hours":"closed"
            }
            ],
        "description": "Description"
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6789"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When request is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property {property} is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Create store</p>

<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores</code></p>

<p>Create store</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>store_id</td>
<td>store id</td>
<td>string</td>
</tr>
<tr>
<td>name*</td>
<td>store name</td>
<td>string</td>
</tr>
<tr>
<td>department_id</td>
<td>department/mall id</td>
<td>string</td>
</tr>
<tr>
<td>categories</td>
<td>categories</td>
<td>array</td>
</tr>
<tr>
<td>zones</td>
<td>zones</td>
<td>array</td>
</tr>
<tr>
<td>floor</td>
<td>foor</td>
<td>string</td>
</tr>
<tr>
<td>location</td>
<td>location</td>
<td>string</td>
</tr>
<tr>
<td>area</td>
<td>area</td>
<td>int</td>
</tr>
<tr>
<td>opening_hours</td>
<td>opening hours</td>
<td>array of day objects</td>
</tr>
<tr>
<td>description</td>
<td>description</td>
<td>string</td>
</tr>
</tbody></table>

<p>Day object for opening hours</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>day of the week</td>
<td>string</td>
</tr>
<tr>
<td>hours*</td>
<td>opening hours</td>
<td>string</td>
</tr>
</tbody></table>

<p>Parameters with <code class="prettyprint">*</code> are required</p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Store was created</td>
</tr>
<tr>
<td>This store already exists.</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Stores:Create</code>
</aside>

<h3 id="update"><a name="store-update"></a> Update</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/12345"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "name": "store name",
        "department_id": 12345,
        "categories": [
            "category"
        ],
        "floor": "2nd Floor",
        "location": "12a",
        "area": 50,
        "zones": [
            "zone"
        ],
        "opening_hours": [
            {
                "name":"monday",
                "hours":"10:00-20:00"
            },
            {
                "name":"tuesday",
                "hours":"10:00-20:00"
            },
            {
                "name":"wednesday",
                "hours":"10:00-20:00"
            },
            {
                "name":"thursday",
                "hours":"10:00-20:00"
            },
            {
                "name":"friday",
                "hours":"10:00-20:00"
            },
            {
                "name":"saturday",
                "hours":"10:00-18:00"
            },
            {
                "name":"sunday",
                "hours":"closed"
            }
            ],
        "description": "Description"
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6789"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When request is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property {property} is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">id</code> or <code class="prettyprint">store_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Update store</p>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/:id</code></p>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/by_store_id/:store_id</code></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID</td>
<td>integer</td>
</tr>
<tr>
<td>store_id</td>
<td>store id</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="put-parameters-json">PUT Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>store name</td>
<td>string</td>
</tr>
<tr>
<td>department_id</td>
<td>department/mall id</td>
<td>string</td>
</tr>
<tr>
<td>categories</td>
<td>categories</td>
<td>array</td>
</tr>
<tr>
<td>zones</td>
<td>zones</td>
<td>array</td>
</tr>
<tr>
<td>floor</td>
<td>foor</td>
<td>string</td>
</tr>
<tr>
<td>location</td>
<td>location</td>
<td>string</td>
</tr>
<tr>
<td>area</td>
<td>area</td>
<td>int</td>
</tr>
<tr>
<td>opening_hours</td>
<td>opening hours</td>
<td>array of day objects</td>
</tr>
<tr>
<td>description</td>
<td>description</td>
<td>string</td>
</tr>
</tbody></table>

<p>Day object for opening hours</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>day of the week</td>
<td>string</td>
</tr>
<tr>
<td>hours*</td>
<td>opening hours</td>
<td>string</td>
</tr>
</tbody></table>

<p>Parameters with <code class="prettyprint">*</code> are required</p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Store updated</td>
</tr>
<tr>
<td>Store with this id does not exist.</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Stores:Update</code>
</aside>

<h3 id="delete"><a name="store-delete"></a> Delete</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/12345"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1113</span><span class="p">,</span><span class="w">
    </span><span class="s2">"store_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">id</code> or <code class="prettyprint">store_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Store not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Delete store</p>

<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/:id</code></p>

<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/by_store_id/:store_id</code></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID</td>
<td>integer</td>
</tr>
<tr>
<td>store_id</td>
<td>store id</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Store was deleted</td>
</tr>
<tr>
<td>Store with this id does not exist.</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Stores:Delete</code>
</aside>

<h2 id="categories"><a name="stores-categories"></a> Categories</h2>

<h3 id="list"><a name="store-categories-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/categories"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of store objects structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="s2">"category A"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"category B"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"category C"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/categories</code></p>

<p>List of all store categories</p>

<aside class="notice">
Requires <code>Stores:Api:Zones:Get</code> permit
</aside> 

<h2 id="zones">Zones</h2>

<h3 id="list"><a name="store-zones-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/zones"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of store objects structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
    </span><span class="s2">"zone A"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"zone B"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"zone C"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/zones</code></p>

<p>List of all zones</p>

<aside class="notice">
Requires <code>Stores:Api:Zones:Get</code> permit
</aside>

          <h2 id="departments">Departments</h2>

<h3 id="list"><a name="department-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/departments"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of department objects structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
      </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">67890</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Department/Mall name"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments</code></p>

<p>List customer departments</p>

<aside class="notice">
Requires <code>Stores:Api:Departments:Get</code> permit
</aside> 

<h3 id="get"><a name="department-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/departments/123456"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns department object structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
  </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">67890</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Department/Mall name"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Department/Mall not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments/:id</code></p>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments/by_department_id/:department_id</code></p>

<p>Return department by one of two identifiers: <code class="prettyprint">id</code> or <code class="prettyprint">department_id</code></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID internal</td>
<td>integer</td>
</tr>
<tr>
<td>department_id</td>
<td>Department id from customer system</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Departments:Get</code> permit
</aside>

<h3 id="create"><a name="department-create"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/departments"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "name": "department name",
        "department_id": 12345
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6789</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When request is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property {property} is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Create store</p>

<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments</code></p>

<p>Create store</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>department name</td>
<td>string</td>
</tr>
<tr>
<td>department_id*</td>
<td>department/mall id</td>
<td>integer</td>
</tr>
</tbody></table>

<p>Parameters with <code class="prettyprint">*</code> are required</p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Department was created</td>
</tr>
<tr>
<td>Department with this id already exists.</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Departments:Create</code>
</aside>

<h3 id="update"><a name="department-update"></a> Update</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/stores/departments/12345"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "name": "department name"
    }'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns a feedback object structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"department_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6789</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When request is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Invalid format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"details"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The property {property} is required"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">id</code> or <code class="prettyprint">department_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Department not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Update department</p>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments/:id</code></p>

<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/stores/departments/by_department_id/:department_id</code></p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID</td>
<td>integer</td>
</tr>
<tr>
<td>department_id</td>
<td>department id</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="put-parameters-json">PUT Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>name*</td>
<td>department name</td>
<td>string</td>
</tr>
</tbody></table>

<p>Parameters with <code class="prettyprint">*</code> are required</p>

<h4 id="feedback-statuses">Feedback statuses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ok</td>
<td>Department updated</td>
</tr>
<tr>
<td>Department with this id does not exist.</td>
<td></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Stores:Api:Departments:Update</code>
</aside> 

          <h1 id="events-api">Events API</h1>

<aside class="warning">
This API is in development. Therefore, it may not be ready for use and is a subject to change at any time.
</aside>

<h2 id="events">Events</h2>

<h3 id="list"><a name="events-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an array of events objects structured like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Event name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-02 12:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-02 18:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"singup_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-01 12:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"place"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Place"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"open"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"registered_members"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"spots"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"checkin_members"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="s2">"checkin_time_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/events</code></p>

<p>List of events</p>

<aside class="notice">
Requires <code>Events:Api:Events:Get</code> permit
</aside>

<h3 id="get"><a name="event-get"></a> Get</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events/:event_id"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), returns an event object structured like below. Some values may be omitted if were not provided:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Event name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-02 12:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-02 18:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"singup_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-01 12:00:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"place"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Place"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"open"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"registered_members"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"spots"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"checkin_members"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="s2">"checkin_time_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/events/:event_id</code></p>

<p>Single event information</p>

<aside class="notice">
Requires <code>Events:Api:Events:Get</code> permit
</aside>

<h3 id="member-validation"><a name="events-validate-member"></a> Member validation</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events/validation"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "member_id": 12345,
        "event_id": 1
    }
</span></code></pre>
<blockquote>
<p>When successful (200), returns an object structured as below</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">event_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Event not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/events/validate</code></p>

<p>Check if member is registered to the event, should be uses only for closed events</p>

<aside class="notice">
Requires <code>Events:Api:Validation:Create</code> permit
</aside>

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>event_id</td>
<td>Event id</td>
<td>integer</td>
</tr>
<tr>
<td>member_id</td>
<td>Member id</td>
<td>integer</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<h2 id="checkins">Checkins</h2>

<h3 id="create"><a name="events-checkin-member"></a> Create</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events/checkin"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "member_id": 12345,
        "event_id": 1,
        "error": null
    }
</span></code></pre>
<blockquote>
<p>When successful (200), returns an object structured as below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"event_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"checkin_members"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"checkin_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-02T02:02:02+0000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"checkin_time_alert"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">event_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Event not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Checkin/scan member to the event</p>

<aside class="notice">
Requires <code>Events:Api:Checkin:Create</code> permit
</aside> 

<h4 id="parameters">Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>event_id</td>
<td>Event id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>member_id</td>
<td>Member id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>error</td>
<td>Error code</td>
<td>integer/null</td>
<td>1 - not a member, 2 - member not registered to the event, 3 - member scanned in the time limit</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/events/checkin</code></p>

<h3 id="list"><a name="events-checkin-list"></a> List</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events/checkin/:event_id"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>When successful (200), When successful (200), returns an array of members objects structured as below.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12345</span><span class="p">,</span><span class="w">
    </span><span class="s2">"checkin_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-02T02:02:02+0000"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/events/checkin/:event_id</code></p>

<p>List scanned/checked in events</p>

<aside class="notice">
Requires <code>Events:Api:Checkin:Get</code> permit
</aside>

<h2 id="invitations">Invitations</h2>

<h3 id="send-invitation"><a name="events-invitation"></a> Send invitation</h3>

<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v3/:loyalty_club_slug/events/invitation"</span> <span class="se">\</span>
    -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
    -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
    -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
    -H <span class="s1">'x-user-agent: CURL manual test'</span>
    -d <span class="se">\</span>
    <span class="s1">'{
        "email": "email@example.com",
        "event_id": 1
    }
</span></code></pre>
<blockquote>
<p>When successful (200), returns an object structured like below:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
<blockquote>
<p>When <code class="prettyprint">event_id</code> is invalid (422), returns:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Event not found"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/events/invitation</code></p>

<p>Send email invitation to loyalty club</p>

<aside class="notice">
Requires <code>Events:Api:Invitation:Create</code> permit
</aside>

<h4 id="payload-parameters">Payload Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>event_id</td>
<td>Event id</td>
<td>integer</td>
</tr>
<tr>
<td>email</td>
<td>Non-member email</td>
<td>string</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters (see example on the right)</td>
</tr>
</tbody></table>

          <h1 id="operations-api"><a name="operations"></a> Operations API</h1>

<p>This section describes endpoints destined for end user that work only within context of (signed in) user.</p>

<p>Navigate to <a href="#operations-admin">Operations Admin</a> section to see docs for management endpoints.</p>

          <h2 id="documents"><a name="operations-documents"></a> Documents</h2>

<h3 id="document-model"><a name="operations-document-model"></a> Document model</h3>

<blockquote>
<p>Document example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fire instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deadline_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-15T15:43:32.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:46.435Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:50.235Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:50.235Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>no</td>
<td>Is document meant to be confirmed by recipient?</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>deadline_at</td>
<td>datetime</td>
<td>when not confirmable</td>
<td>Time until document is meant to be confirmed by recipients - only for <code class="prettyprint">confirmable</code> documents</td>
</tr>
<tr>
<td>created_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of creation</td>
</tr>
<tr>
<td>updated_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of last update</td>
</tr>
<tr>
<td>confirmed_at</td>
<td>datetime</td>
<td>yes</td>
<td>Time of confirmation by current user</td>
</tr>
</tbody></table>

<p>For more details, see <a href="#operations-admin-document-model">Document model</a> in Operations Admin API</p>

<h3 id="list-documents"><a name="operations-list-documents"></a> List Documents</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/users/me/operations/documents"</span> <span class="se">\</span>
  -H <span class="s1">'authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIyOE'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-document-model">documents</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"documents"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">documents</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/users/me/operations/documents</code></p>

<p>Returns list of <a href="#operations-document-model">Documents</a> shared with current user.</p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>null</td>
<td>When true, returns only confirmable Documents - and vice versa</td>
</tr>
<tr>
<td>requiring_confirmation</td>
<td>boolean</td>
<td>null</td>
<td>When present, returns only Documents that require confirmation (are confirmable and are not confirmed)</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Users:Documents:List</code> permit
</aside>

<h3 id="get-document"><a name="operations-show-document"></a> Get Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/users/me/operations/documents/5"</span> <span class="se">\</span>
  -H <span class="s1">'authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIyOE'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/users/me/operations/documents/:id</code></p>

<p>Returns given <a href="#operations-document-model">Document</a> shared with current user. </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Users:Documents:Show</code> permit
</aside>

<h3 id="confirm-document"><a name="operations-show-document"></a> Confirm Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/users/me/operations/documents/5/confirm"</span> <span class="se">\</span>
  -H <span class="s1">'authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIyOE'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/users/me/operations/documents/:id/confirm</code></p>

<p>Confirms given <a href="#operations-document-model">Document</a>. </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
<tr>
<td><code class="prettyprint">405</code></td>
<td>Document is not confirmable</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Users:Documents:Confirm</code> permit
</aside>

          <h1 id="operations-admin-api"><a name="operations-admin"></a> Operations Admin API</h1>

<p>This section describes endpoints destined for Operations management.</p>

<p>Navigate to <a href="#operations">Operations</a> section to see docs for user-facing endpoints.</p>

          <h2 id="documents"><a name="operations-admin-documents"></a> Documents</h2>

<h3 id="document-model"><a name="operations-admin-document-model"></a> Document model</h3>

<blockquote>
<p>Document example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fire instructions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deadline_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-15T15:43:32.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"message_channel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sms"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_reminder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-10T08:00:00.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"second_reminder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:00.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:46.435Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:12:46.435Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"recipients_confirmation_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"some"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The document is an entity that has some files (with <code class="prettyprint">type: &quot;document&quot;</code> and Document&rsquo;s ID as <code class="prettyprint">identifier</code>) attached to it.</p>

<p>Upon creation, a notification containing a link to the document is sent via specified channel to given recipients (members of Tenant community).</p>

<p>When document is <code class="prettyprint">confirmable</code>, recipients may need to confirm it. In such case, a <code class="prettyprint">deadline_at</code> must be specified.
Also, it is possible to configure automated <a href="#operations-admin-document-reminder-model">reminder</a> messages that
are sent to recipients which didn&rsquo;t confirm the document.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>no</td>
<td>Is document meant to be confirmed by recipients?</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>deadline_at</td>
<td>datetime</td>
<td>when not confirmable</td>
<td>Time until document is meant to be confirmed by recipients - only for <code class="prettyprint">confirmable</code> documents</td>
</tr>
<tr>
<td>message_channel</td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
<td>no</td>
<td>Channel that the document (and reminders) should be sent with</td>
</tr>
<tr>
<td>first_reminder</td>
<td><a href="#operations-admin-document-reminder-model">DocumentReminder</a></td>
<td>yes</td>
<td></td>
</tr>
<tr>
<td>second_reminder</td>
<td><a href="#operations-admin-document-reminder-model">DocumentReminder</a></td>
<td>yes</td>
<td>Can only be specified after the first reminder</td>
</tr>
<tr>
<td>created_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of creation</td>
</tr>
<tr>
<td>updated_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of last update</td>
</tr>
<tr>
<td>recipients_count</td>
<td>integer</td>
<td>no</td>
<td>Number of recipients</td>
</tr>
<tr>
<td>recipients_confirmation_status</td>
<td>enum: <code class="prettyprint">[&#39;all&#39;, &#39;some&#39;, &#39;none&#39;]</code></td>
<td>no</td>
<td>Describes how many recipients have confirmed the document</td>
</tr>
</tbody></table>

<h4 id="documentreminder-model"><a name="operations-admin-document-reminder-model"></a> DocumentReminder model</h4>

<blockquote>
<p>Document reminder example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"days_before_deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"scheduled_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-12-13T08:00:01.540Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>days_before_deadline</td>
<td>integer</td>
<td>no</td>
<td>When the reminder should be sent - number of days before the specified deadline</td>
</tr>
<tr>
<td>scheduled_at</td>
<td>datetime</td>
<td>no</td>
<td>Actual calculated time for reminder sending - at 09:00 in the timezone specific for the Loyalty Club</td>
</tr>
<tr>
<td>sent_at</td>
<td>datetime</td>
<td>yes</td>
<td>When the reminder has been sent</td>
</tr>
</tbody></table>

<h3 id="documentrecipient-model"><a name="operations-admin-document-recipient-model"></a> DocumentRecipient model</h3>

<blockquote>
<p>DocumentRecipient example:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">44</span><span class="p">,</span><span class="w">
    </span><span class="s2">"member_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_seen_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:21:42.350Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T17:21:50.420Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T16:46:28.200Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-11-30T16:46:28.200Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Optional</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>no</td>
<td></td>
</tr>
<tr>
<td>member_id</td>
<td>integer</td>
<td>no</td>
<td>ID of MPC member</td>
</tr>
<tr>
<td>last_seen_at</td>
<td>datetime</td>
<td>yes</td>
<td>Last time when the recipient retrieved the Document record</td>
</tr>
<tr>
<td>confirmed_at</td>
<td>datetime</td>
<td>yes</td>
<td>Time of confirmation</td>
</tr>
<tr>
<td>created_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of creation</td>
</tr>
<tr>
<td>updated_at</td>
<td>datetime</td>
<td>no</td>
<td>Time of last update</td>
</tr>
</tbody></table>

<h3 id="list-documents"><a name="operations-admin-list-documents"></a> List Documents</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-model">documents</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"documents"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">documents</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents</code></p>

<p>Returns list of <a href="#operations-admin-document-model">Documents</a>.  </p>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>confirmable</td>
<td>boolean</td>
<td>null</td>
<td>When true, returns only confirmable Documents - and vice versa</td>
</tr>
<tr>
<td>recipients_confirmation_status</td>
<td>enum: <code class="prettyprint">[&#39;all&#39;, &#39;some&#39;, &#39;none&#39;]</code></td>
<td>null</td>
<td>When present, returns only Documents having given <code class="prettyprint">recipients_confirmation_status</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:List</code> permit
</aside>

<h3 id="get-document"><a name="operations-admin-show-document"></a> Get Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/5"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Returns given <a href="#operations-admin-document-model">Document</a>.  </p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Show</code> permit
</aside>

<h3 id="list-document-recipients"><a name="operations-admin-list-document-recipients"></a> List Document Recipients</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/15/recipients"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns object containing <a href="#operations-admin-document-recipient-model">document recipients</a> and <a href="#pagination-model">pagination_info</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document_recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">document</span><span class="w"> </span><span class="err">recipients</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"DocumentRecipient model"</span><span class="w">
  </span><span class="s2">"pagination_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Pagination</span><span class="w"> </span><span class="err">info</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Pagination info"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>GET</strong> <code class="prettyprint">v1/operations/documents/:id/recipients</code></p>

<p>Returns list of <a href="#operations-admin-document-recipient-model">DocumentRecipients</a> that are assigned to given Document</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="query-parameters">Query Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>per_page</td>
<td>integer</td>
<td>100</td>
<td>Number of results to be returned per request (100 is the maximum)</td>
</tr>
<tr>
<td>page_no</td>
<td>integer</td>
<td>1</td>
<td>Number of results page</td>
</tr>
<tr>
<td>confirmed</td>
<td>boolean</td>
<td>null</td>
<td>When true, returns only recipients that confirmed - and vice versa</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Recipients:List</code> permit
</aside>

<h3 id="create-document"><a name="operations-admin-create-document"></a> Create Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "document": {
            "title": "My name",
            "message_channel": "sms",
            "confirmable": true,
            "deadline_at": "2020-12-15T15:43:32",
            "recipients": [14, 423],
            "first_reminder": { "days_before_deadline": 5 },
            "second_reminder": { "days_before_deadline": 2 }
        }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing created <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v1/operations/documents</code></p>

<p>Creates a new <a href="#operations-admin-document-model">Document</a> and sends it to given recipients.</p>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.title</strong></td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><strong>document.message_channel</strong></td>
<td>enum: <code class="prettyprint">[&#39;sms&#39;, &#39;email&#39;, &#39;push&#39;]</code></td>
<td>The channel for sending a notification and reminders</td>
</tr>
<tr>
<td><strong>document.recipients</strong></td>
<td>integer[]</td>
<td>IDs of members that should receive the document - max. 1000</td>
</tr>
<tr>
<td>document.confirmable</td>
<td>boolean</td>
<td>Is document meant to be confirmed by recipients? Default: <code class="prettyprint">false</code></td>
</tr>
</tbody></table>

<p>When the document is confirmable:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.deadline_at</strong></td>
<td>datetime</td>
<td>Date until the document should be confirmed</td>
</tr>
<tr>
<td>document.first_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the first reminder should be sent</td>
</tr>
<tr>
<td>document.second_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the second reminder should be sent</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<h4 id="specific-validation-errors">Specific validation errors</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Error</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">cannot_be_present_without_first_reminder</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder.days_before_deadline</code></td>
<td><code class="prettyprint">cannot_be_before_first_reminder</code></td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Create</code> permit
</aside>

<h3 id="update-document"><a name="operations-admin-update-document"></a> Update Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "document": {
            "title": "My name",
            "deadline_at": "2020-12-15T15:43:32",
            "first_reminder": { "days_before_deadline": 5 },
            "second_reminder": { "days_before_deadline": 2 }
        }
    }
  '</span>
</code></pre>
<blockquote>
<p>When successful, returns object containing updated <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Updates the <a href="#operations-admin-document-model">Document</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.title</strong></td>
<td>string</td>
<td></td>
</tr>
</tbody></table>

<p>When the document is confirmable:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>document.deadline_at</strong></td>
<td>datetime</td>
<td>Date until the document should be confirmed</td>
</tr>
<tr>
<td>document.first_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the first reminder should be sent</td>
</tr>
<tr>
<td>document.second_reminder.days_before_deadline</td>
<td>integer</td>
<td>Number of days before the deadline the second reminder should be sent</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<h4 id="specific-validation-errors">Specific validation errors</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Error</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">document.first_reminder</code></td>
<td><code class="prettyprint">already_sent</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">already_sent</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder</code></td>
<td><code class="prettyprint">cannot_be_present_without_first_reminder</code></td>
</tr>
<tr>
<td><code class="prettyprint">document.second_reminder.days_before_deadline</code></td>
<td><code class="prettyprint">cannot_be_before_first_reminder</code></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Update</code> permit
</aside>

<h3 id="add-recipients-to-the-document"><a name="operations-admin-add-document-recipients"></a> Add recipients to the Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-loyalty-club-slug: infinity-mall'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -d <span class="s1">'
    {
        "recipients": [4, 2, 42]
    }
  '</span>
</code></pre>
<blockquote>
<p>Returns object containing created <a href="#operations-admin-document-recipient-model">document recipients</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document_recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">List</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">document</span><span class="w"> </span><span class="err">recipients</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"DocumentRecipient model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Adds <a href="#operations-admin-document-recipient-model">recipients</a> to the <a href="#operations-admin-document-model">Document</a> and sends them a notification.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="post-parameters-json">POST Parameters (JSON)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>recipients</strong></td>
<td>integer[]</td>
<td>IDs of members that should receive the document - max. 1000</td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters - see <a href="#invalid-parameters-errors-model">Invalid parameters errors model</a></td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:DocumentRecipients:Create</code> permit
</aside>

<h3 id="destroy-document"><a name="operations-admin-destroy-document"></a> Destroy Document</h3>

<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="se">\</span>
<span class="s2">"https://api.mpc.placewise.com/v1/operations/documents/12 </span><span class="se">\</span><span class="s2">
  -H 'content-type: application/json' </span><span class="se">\</span><span class="s2">
  -H 'x-loyalty-club-slug: infinity-mall' </span><span class="se">\</span><span class="s2">
  -H 'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM' </span><span class="se">\</span><span class="s2">
  -H 'x-product-name: default' </span><span class="se">\</span><span class="s2">
  -H 'x-user-agent: CURL manual test'
</span></code></pre>
<blockquote>
<p>When successful, returns object containing destroyed <a href="#operations-admin-document-model">document</a></p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"document"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Document</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">See</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document model"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v1/operations/documents/:id</code></p>

<p>Destroys the <a href="#operations-admin-document-model">Document</a>.</p>

<h4 id="url-parameters">URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>integer</td>
<td>Document ID</td>
</tr>
</tbody></table>

<h4 id="response-json-object">Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>document</td>
<td>Document</td>
<td>See: <a href="#operations-admin-document-model">Document model</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Document not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Operations:Api:Documents:Destroy</code> permit
</aside>

          <h1 id="files-api-deprecated">Files API (deprecated)</h1>

<h2 id="introduction">Introduction</h2>

<h3 id="file-model"><a name="file-model"></a> File model</h3>

<p>Every file attached to some entity (Offer, Reward, Offer Collection) follows the file schema and is defined like this:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>URL</td>
<td>Link to the file</td>
</tr>
<tr>
<td>width</td>
<td>integer</td>
<td>Image width</td>
</tr>
<tr>
<td>height</td>
<td>integer</td>
<td>Image height</td>
</tr>
<tr>
<td>kind</td>
<td>string</td>
<td>File kind identifier (e.x. <code class="prettyprint">offer_default</code>), see <a href="#file-kinds">Standard file kinds</a></td>
</tr>
<tr>
<td>size_type</td>
<td>string</td>
<td>e.x. <code class="prettyprint">base</code>, see: <a href="#file-sizes">File sizes</a></td>
</tr>
</tbody></table>

<h3 id="file-schema"><a name="file-schema"></a> File schema</h3>

<p>File schema defines a list of files kinds available in the Loyalty club. 
Each file kind is also available in multiple sizes. </p>

<p>The schema may get retrieved with <a href="#get-file-schema">Files&bull; Get schema</a> endpoint.</p>

<blockquote>
<p>Example loyalty club file schema</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"files_kinds"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"collection_cover_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2:1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3:4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"reward_default"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3:4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_without_ratio"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ratio"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
          </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<h3 id="file-kind-model"><a name="file-kind-model"></a> File kind model</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>string</td>
<td>See: <a href="#file-kinds">Standard file kinds</a></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>Currently, only <code class="prettyprint">IMAGE</code> (MIME: <code class="prettyprint">image/gif</code>, <code class="prettyprint">image/jpeg</code>, <code class="prettyprint">image/png</code>) is supported</td>
</tr>
<tr>
<td>ratio</td>
<td>string</td>
<td>Describes ratio of an image. See: <a href="#file-kind-ratio">Ratio</a> (optional)</td>
</tr>
<tr>
<td>sizes</td>
<td>Array<Object></td>
<td>See: <a href="#file-sizes">File sizes</a></td>
</tr>
<tr>
<td>sizes[][&lsquo;identifier&rsquo;]</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>sizes[][&lsquo;min_width&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;min_height&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;max_width&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
<tr>
<td>sizes[][&lsquo;max_height&rsquo;]</td>
<td>integer</td>
<td>(optional)</td>
</tr>
</tbody></table>

<h3 id="standard-file-kinds"><a name="file-kinds"></a> Standard file kinds</h3>

<p>There are some standard file kinds, their size definitions differ among Loyalty Clubs.</p>

<table><thead>
<tr>
<th>Identifier</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">collection_cover_default</code></td>
<td>Cover for Offer collections</td>
</tr>
<tr>
<td><code class="prettyprint">offer_default</code></td>
<td>Default Offer image</td>
</tr>
<tr>
<td><code class="prettyprint">reward_default</code></td>
<td>Default Reward image</td>
</tr>
</tbody></table>

<h3 id="ratio"><a name="file-kind-ratio"></a> Ratio</h3>

<p>Images may have fixed proportions ratio which is represented as a string: <code class="prettyprint">&quot;&lt;width&gt;:&lt;height&gt;&quot;</code></p>

<h3 id="file-sizes"><a name="file-sizes"></a> File sizes</h3>

<p>Every file has at least three file sizes available: </p>

<h4 id="base"><code class="prettyprint">base</code></h4>

<p>Actual file size. Currently all file kinds have this size with fixed proportions (so <code class="prettyprint">min_*</code> == <code class="prettyprint">max_*</code>) that match the ratio.</p>

<h4 id="thumbnail"><code class="prettyprint">thumbnail</code></h4>

<p>Rescaled version of <code class="prettyprint">base</code> size. Currently, rescaling always works this way:</p>

<ul>
<li>pick the higher dimension of file</li>
<li>shrink the image so:

<ul>
<li>the higher dimension gets shrunk to <code class="prettyprint">300px</code></li>
<li>the lower dimensions gets shrunk so the image keeps the original ratio</li>
</ul></li>
</ul>

<p>Examples:</p>

<ul>
<li>File with resolution <code class="prettyprint">600x800</code> gets shrunk down to <code class="prettyprint">225x300</code></li>
<li>File with resolution <code class="prettyprint">800x600</code> gets shrunk down to <code class="prettyprint">300x225</code></li>
<li>File with resolution <code class="prettyprint">400x300</code> gets shrunk down to <code class="prettyprint">300x225</code></li>
<li>File with resolution <code class="prettyprint">400x200</code> gets shrunk down to <code class="prettyprint">300x150</code></li>
<li>File with resolution <code class="prettyprint">300x250</code> is not shrunk down</li>
</ul>

<h4 id="original"><code class="prettyprint">original</code></h4>

<p>Original file that that has been uploaded and used for generating other file sizes.</p>

<p>Currently, we require all original files to have proper ratios and minimum sizes of at least the <code class="prettyprint">base</code> size.
Because of that, you can expect them to have <code class="prettyprint">min_height</code> and <code class="prettyprint">min_width</code> that match the <code class="prettyprint">base</code> size, 
but they never have <code class="prettyprint">max_width</code> or <code class="prettyprint">max_height</code> defined.</p>

<h4 id="file-cropping"><a name="file-cropping"></a> File cropping</h4>

<blockquote>
<p><code class="prettyprint">crop_to</code> param interpretation may be visualized like this:</p>
</blockquote>
<pre class="highlight plaintext"><code>
                           x_top_left     x_bottom_right
                    |-------------------------------------
                    | ..........................
                    | ..........................
     y_top_left     | .....*---------------.....
                    | .....|..............|.....
                    | .....|..............|.....
                    | .....|..............|....
     y_bottom_right | .....---------------*.....
                    | ..........................
                    |

</code></pre>
<p>When file is uploaded and it&rsquo;s too large to match the required base size, it may get cropped.
This can be achieved by providing cropping param (<code class="prettyprint">crop_to</code>).</p>

<p>The param has following syntax: <code class="prettyprint">x_top_left,y_top_left,x_bottom_right,y_bottom_right</code> and represents boundaries of a cropping area. </p>

<p>When uploaded file is too large and <code class="prettyprint">crop_to</code> param is not provided, the file will be automatically cropped with gravity set in center of image.</p>

<h5 id="example">Example</h5>

<p>The kind&rsquo;s base size is 400x200px and the uploaded file is 1000x1000px. </p>

<p>With crop_to=&ldquo;0,250,1000,750&rdquo;, a rectangle of &ldquo;1000x500&rdquo; size will be cropped, with 250px left offset.
The file will be then also resized to 400x200.</p>

<h4 id="uploaded-instances-projections"><a name="projected-file-versions"></a> Uploaded instances projections</h4>

<p>When file is uploaded, only original file is physically processed and stored. <code class="prettyprint">base</code> and other versions are processed asynchronously. 
So, the responses returned on upload contains only &ldquo;projected&rdquo; info about files.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>size_type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>An URL the file be available on <strong>after</strong> it gets processed.</td>
</tr>
<tr>
<td>min_width</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>max_width</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>min_height</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>max_height</td>
<td>integer</td>
<td></td>
</tr>
</tbody></table>

<h2 id="files">Files</h2>

<h3 id="get-file-schema"><a name="get-file-schema"></a> Get file schema</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/files/schema"</span> <span class="se">\</span>
  -H <span class="s1">'content-type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span>
</code></pre>
<blockquote>
<p>Returns the schema as described <a href="#file-schema">here</a></p>
</blockquote>

<p><strong>GET</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/schema</code></p>

<p>Returns the Loyalty Club file schema. See: <a href="#file-schema">Files &bull; Schema</a></p>

<aside class="notice">
Requires <code>Files:Api:GetSchema</code> permit
</aside>

<h3 id="create-file"><a name="create-file"></a> Create file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/files/offers/1000289/offer_default <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="nv">file</span><span class="o">=</span>@some_file.png <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>Returns info about uploaded file and it&rsquo;s projected versions</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"original"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-original.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"file_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IMAGE"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
        </span><span class="s2">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w">
        </span><span class="s2">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"offer_default"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"projected_versions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"base"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-base.png"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"size_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thumbnail"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://offers-api.s3.eu-central-1.amazonaws.com/offer-1000289-offer_default-thumbnail.png"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
            </span><span class="s2">"min_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_width"</span><span class="p">:</span><span class="w"> </span><span class="mi">225</span><span class="p">,</span><span class="w">
            </span><span class="s2">"max_height"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>POST</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Creates new file for given Fileable (e.g. Offer).</p>

<h4 id="url-parameters"><a name="create-file-url-parameters"></a> URL Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>fileable_type</td>
<td>enum: <code class="prettyprint">[&#39;offers&#39;, &#39;collections&#39;]</code></td>
<td></td>
</tr>
<tr>
<td>fileable_id</td>
<td>integer</td>
<td></td>
</tr>
<tr>
<td>kind</td>
<td>enum</td>
<td>see <a href="#file-kinds">Standard file kinds</a></td>
</tr>
</tbody></table>

<h4 id="post-parameters"><a name="create-file-post-parameters"></a> POST Parameters</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>file</td>
<td>binary</td>
<td>yes</td>
<td>File to upload</td>
</tr>
<tr>
<td>crop_to</td>
<td>string</td>
<td>no</td>
<td>See: <a href="#file-cropping">cropping</a></td>
</tr>
</tbody></table>

<h4 id="response-json-object"><a name="create-file-response"></a> Response (JSON object)</h4>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>original</td>
<td>File</td>
<td>See <a href="#file-model">File model</a></td>
</tr>
<tr>
<td>projected_versions</td>
<td>ProjectedVersion[]</td>
<td>See <a href="#projected-file-versions">Projected file versions</a></td>
</tr>
</tbody></table>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>The Fileable does not exist</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Create</code> permit
</aside>

<h3 id="update-file"><a name="update-file"></a> Update file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/files/offers/1000289/offer_default <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="nv">file</span><span class="o">=</span>@some_file.png <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>When successful (200), Returns info about uploaded file. Same as <a href="#create-file">Create file</a> example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Create file"</span><span class="w"> </span><span class="err">example</span><span class="w"> </span><span class="err">response</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Updates file for given Fileable (e.g. Offer).</p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="post-parameters">POST Parameters</h4>

<p>See: <a href="#create-file-post-parameters">Create File POST Parameters</a></p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>See: <a href="#create-file-response">Create File Response</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Update</code> permit
</aside>

<h3 id="reprocess-file"><a name="reprocess-file"></a> Reprocess file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X PUT <span class="se">\</span>
  https://api.mpc.placewise.com/v3/infinity-mall/files/offers/1000289/offer_default/reprocess <span class="se">\</span>
  -H <span class="s1">'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM'</span> <span class="se">\</span>
  -H <span class="s1">'x-product-name: default'</span> <span class="se">\</span>
  -H <span class="s1">'x-user-agent: CURL manual test'</span> <span class="se">\</span>
  -H <span class="s1">'content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW'</span> <span class="se">\</span>
  -F <span class="s1">'crop_to=256,256,856,1056'</span>

</code></pre>
<blockquote>
<p>When successful (200), Returns info about uploaded file. Same as <a href="#create-file">Create file</a> example response</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">(...)</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="s2">"Create file"</span><span class="w"> </span><span class="err">example</span><span class="w"> </span><span class="err">response</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>PUT</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind/reprocess</code></p>

<p>Reprocesses file for given Fileable (e.g. Offer).
It means that no file needs to be uploaded, instead the original file will be reprocessed according to given parameters. </p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="post-parameters">POST Parameters</h4>

<p>See: <a href="#create-file-post-parameters">Create File POST Parameters</a> - except no <code class="prettyprint">file</code> param is accepted here</p>

<h4 id="response-json-object">Response (JSON object)</h4>

<p>See: <a href="#create-file-response">Create File Response</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
<tr>
<td><code class="prettyprint">422</code></td>
<td>Invalid parameters</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Reprocess</code> permit
</aside>

<h3 id="delete-file"><a name="delete-file"></a> Delete file</h3>

<blockquote>
<p>Example request</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE <span class="s2">"https://api.mpc.placewise.com/v3/infinity-mall/files/offers/1000289/offer_default </span><span class="se">\</span><span class="s2">
  -H 'content-type: application/json' </span><span class="se">\</span><span class="s2">
  -H 'x-client-authorization: B7t9U9tsoWsGhrv2ouUoSqpM' </span><span class="se">\</span><span class="s2">
  -H 'x-product-name: default' </span><span class="se">\</span><span class="s2">
  -H 'x-user-agent: CURL manual test'
</span></code></pre>
<blockquote>
<p>When successful (200), returns an empty object</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">object</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p><strong>DELETE</strong> <code class="prettyprint">v3/:loyalty_club_slug/files/:fileable_type/:fileable_id/kind</code></p>

<p>Deletes file of given Fileable (e.g. Offer).</p>

<h4 id="url-parameters">URL Parameters</h4>

<p>See: <a href="#create-file-url-parameters">Create File URL Parameters</a></p>

<h4 id="error-responses">Error responses</h4>

<table><thead>
<tr>
<th>Status</th>
<th>Reason</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">404</code></td>
<td>Fileable not found</td>
</tr>
<tr>
<td><code class="prettyprint">404</code></td>
<td>File not found</td>
</tr>
</tbody></table>

<aside class="notice">
Requires <code>Files:Api:Delete</code> permit
</aside>

          <h1 id="changelog">Changelog</h1>

<h4 id="18-12-2020-piotr-witlicki">18.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Rework <a href="#offer-admin-image-templates-preview">Offers Admin API &bull; ImageTemplates &bull; Preview</a></li>
</ul>

<h4 id="15-12-2020-piotr-witlicki">15.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#messaging-show-settings">Messaging API &bull; Settings &bull; Show</a></li>
</ul>

<h4 id="15-12-2020-piotr-witlicki">15.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#messaging-cancel-sending">Messaging API &bull; Sendings &bull; Cancel</a></li>
</ul>

<h4 id="08-12-2020-piotr-witlicki">08.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">background_url</code> to <code class="prettyprint">ImageTemplate</code> model in <a href="#offers-admin">Offers Admin API</a></li>
</ul>

<h4 id="08-12-2020-piotr-witlicki">08.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">dispatches_count</code> to <code class="prettyprint">Sending</code> and <code class="prettyprint">MessageSending</code> models in <a href="#messaging">Messaging API</a></li>
</ul>

<h4 id="04-12-2020-pawe-buczkowski">04.12.2020 | PaweÅ Buczkowski</h4>

<ul>
<li>Update <a href="#pos-campaign-api">POS Campaigns</a></li>
</ul>

<h4 id="02-12-2020-piotr-witlicki">02.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#operations-documents">Operations API &bull; Documents</a></li>
</ul>

<h4 id="01-12-2020-piotr-witlicki">01.12.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#operations-admin-documents">Operations Admin API &bull; Documents</a></li>
</ul>

<h4 id="23-11-2020-piotr-witlicki">23.11.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#offer-admin-image-templates-preview">Offers Admin API &bull; Image Templates &bull; Preview</a></li>
</ul>

<h4 id="23-11-2020-piotr-witlicki">23.11.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#messaging-list-sending-dispatches">Messaging API &bull; Sending</a></li>
</ul>

<h4 id="23-11-2020-piotr-witlicki">23.11.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add periodic limits feature to <a href="#offers-api">Offers</a></li>
</ul>

<h4 id="20-11-2020-jakub-kruczek">20.11.2020 | Jakub Kruczek</h4>

<ul>
<li>New API hosts after rebranding to Placewise</li>
<li>Rename Boostcom references to Placewise</li>
<li>Add new Placewise logo</li>
</ul>

<h4 id="09-11-2020-piotr-witlicki">09.11.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#grant-offers">Offers &bull; Grant</a></li>
</ul>

<h4 id="30-10-2020-pawe-buczkowski">30.10.2020 | PaweÅ Buczkowski</h4>

<ul>
<li>Add <a href="#points-config">POS Campaigns &bull; PointsConfig</a></li>
</ul>

<h4 id="29-10-2020-natalia-styrska">29.10.2020 | Natalia Styrska</h4>

<ul>
<li>Add <a href="#members-stores-get">Members &bull; Stores</a></li>
</ul>

<h4 id="09-09-2020-piotr-witlicki">09.09.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#image-templates">Offers Admin API &bull; ImageTemplates API</a></li>
<li>Add <a href="#offer-image-template">Offer ImageTemplate model</a></li>
</ul>

<h4 id="09-09-2020-natalia-styrska">09.09.2020 | Natalia Styrska</h4>

<ul>
<li>Update <a href="#transactions-events-create">Transactions &bull; Create events</a></li>
</ul>

<h4 id="17-08-2020-piotr-witlicki">17.08.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#links">Links</a></li>
</ul>

<h4 id="17-08-2020-jakub-kruczek">17.08.2020 | Jakub Kruczek</h4>

<ul>
<li>Use lowercase header keys to match HTTP/2 standard</li>
<li>Add HTTPS (TLS) section <a href="#https-tls-requirement">Introduction &bull; Hosts &bull; HTTPS (TLS) requirement</a></li>
<li>Add new common HTTP code for incorrect headers <a href="#common-http-error-codes">Introduction &bull; Common HTTP error codes</a></li>
</ul>

<h4 id="13-08-2020-piotr-witlicki">13.08.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Restructurize docs (group endpoints into APIs)</li>
</ul>

<h4 id="07-08-2020-natalia-styrska">07.08.2020 | Natalia Styrska</h4>

<ul>
<li>Add <a href="#member-points-list">Points &bull; List</a></li>
</ul>

<h4 id="02-07-2020-natalia-styrska">02.07.2020 | Natalia Styrska</h4>

<ul>
<li>Add <a href="#events-list">Events &bull; Index</a></li>
<li>Add <a href="#event-get">Events &bull; Get</a></li>
<li>Add <a href="#events-validate-member">Events &bull; Validate</a></li>
<li>Add <a href="#events-checkin-member">Events &bull; Checkin</a></li>
<li>Add <a href="#events-invitation">Events &bull; Invitation</a></li>
</ul>

<h4 id="02-06-2020-piotr-witlicki">02.06.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Extend <a href="#members-groups-list">Members Groups &bull; Index</a> with filtering parameters</li>
<li>Add <a href="#members-groups-types">Members Groups &bull; Types</a></li>
</ul>

<h4 id="28-05-2020-natalia-styrska">28.05.2020 | Natalia Styrska</h4>

<ul>
<li>Extend (<a href="#store-list">#  Stores</a>) all endpoints with new properties</li>
<li>Add (<a href="#store-zones-list">Stores &bull; Zones</a>) endpoint </li>
</ul>

<h4 id="21-05-2020-piotr-witlicki">21.05.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Extend <a href="#members-groups">Members Groups</a> to work with audiences (automatic groups)</li>
</ul>

<h4 id="20-04-2020-piotr-witlicki">20.04.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">usable_for_seconds</code> param to <a href="#grant-offer">Grant offer</a> </li>
<li>Add <code class="prettyprint">type</code> to <a href="#offer-model">Offer</a> </li>
</ul>

<h4 id="09-04-2020-piotr-witlicki">09.04.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Restructure members docs</li>
<li>Add <a href="#invalid-parameters-errors-model">Invalid parameters errors</a></li>
<li>Add <a href="#members-groups">Members Groups</a></li>
</ul>

<h4 id="13-03-2020-natalia-styrska">13.03.2020 | Natalia Styrska</h4>

<ul>
<li>Extend <a href="#transactions-events-create">Transaction Events &bull; Create</a> endpoint </li>
</ul>

<h4 id="12-03-2020-natalia-styrska">12.03.2020 | Natalia Styrska</h4>

<ul>
<li>Extend <a href="#points-create">Points &bull; Create</a> endpoint </li>
</ul>

<h4 id="05-03-2020-piotr-witlicki">05.03.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Extend <a href="#loyalty-clubs-list">Loyalty Clubs &bull; List</a> endpoint </li>
</ul>

<h4 id="01-03-2020-piotr-witlicki">01.03.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Extend <a href="#offers">Offers</a> API to work within <a href="offers-oauth-context">Member context</a></li>
<li>Rework <a href="#offers">Offers</a> API to work within <a href="offers-guest-access">Guest context</a> </li>
</ul>

<h4 id="11-02-2020-piotr-witlicki">11.02.2020 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#grant-offer">Offers &bull; Grant offer</a></li>
</ul>

<h4 id="03-02-2020-natalia-styrska">03.02.2020 | Natalia Styrska</h4>

<ul>
<li>Add (<a href="#transactions-events-create">Transactions &bull; Events</a>) endpoint</li>
</ul>

<h4 id="11-12-2019-piotr-witlicki">11.12.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Update <a href="#offers-display-schemas">Offers &bull; Display schemas</a> to have <a href="https://support.smartbear.com/readyapi/docs/testing/jsonpath-reference.html">JSONPath</a> references</li>
</ul>

<h4 id="05-12-2019-piotr-witlicki">05.12.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#links-generate">Links &bull; Generate</a> </li>
</ul>

<h4 id="22-11-2019-piotr-witlicki">22.11.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#loyalty-clubs-get">Loyalty Clubs &bull; Get</a></li>
<li>Add info about new <code class="prettyprint">client</code> <a href="#offers-display-schemas">display schema</a> item type </li>
</ul>

<h4 id="22-10-2019-piotr-witlicki">22.10.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">collection_position</code> order_by key to <a href="#list-offers">Offers &bull; List offers</a></li>
</ul>

<h4 id="18-10-2019-piotr-witlicki">18.10.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#offers-display-schemas">Offer display schemas</a></li>
</ul>

<h4 id="16-10-2019-natalia-styrska">16.10.2019 | Natalia Styrska</h4>

<ul>
<li>Add (<a href="#store-categories-list">Stores &bull; Categories</a>) endpoint</li>
<li>Add (<a href="#department-create">Departments &bull; Create</a>) endpoint</li>
<li>Add (<a href="#department-update">Departments &bull; Update</a>) endpoint</li>
</ul>

<h4 id="23-09-2019-piotr-witlicki">23.09.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">event_occurred_at</code> param to <a href="#member-event-occured-at-param">Members &bull; Update</a> </li>
</ul>

<h4 id="21-09-2019-piotr-witlicki">21.09.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <code class="prettyprint">membership_started_at</code> to <a href="#rewards-program-status">Rewards Program &bull; Get Status</a> </li>
</ul>

<h4 id="19-09-2019-natalia-styrska">19.09.2019 | Natalia Styrska</h4>

<ul>
<li>Add (<a href="#member-points">Points &bull; Member points</a>) endpoint</li>
<li>Add (<a href="#points-create">Points &bull; Create</a>) endpoint</li>
</ul>

<h4 id="02-09-2019-natalia-styrska">02.09.2019 | Natalia Styrska</h4>

<ul>
<li>Change (<a href="#store-list">Stores &bull; List</a>) rename malls to departments</li>
<li>Change (<a href="#store-get">Stores &bull; Get</a>) rename malls to departments</li>
<li>Change (<a href="#store-create">Stores &bull; Create</a>) rename malls to departments</li>
<li>Change (<a href="#store-update">Stores &bull; Update</a>) rename malls to departments</li>
<li>Add (<a href="#department-list">Departments &bull; List</a>) rename malls to departments</li>
<li>Add (<a href="#department-get">Departments &bull; Get</a>) rename malls to departments</li>
</ul>

<h4 id="29-08-2019-piotr-witlicki">29.08.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#members-update-app-token">Members &bull; Update app token</a> endpoint</li>
<li>Add <a href="#me-update-app-token">OAuth &bull; Update app token</a> endpoint</li>
</ul>

<h4 id="27-08-2019-piotr-witlicki">27.08.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#offers-events">Offers Events</a> section</li>
</ul>

<h4 id="23-08-2019-piotr-witlicki">23.08.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#members-validate">Members &bull; Validate</a> endpoint</li>
<li>Change <a href="#offers-list">Offers &bull; List</a> to accept <code class="prettyprint">include_pagination_info</code> instead of <code class="prettyprint">include_total</code> param</li>
</ul>

<h4 id="19-08-2019-piotr-witlicki">19.08.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#reprocess-file">Offers &bull; Reprocess</a></li>
<li>Add <a href="#offers-list-order-by"><code class="prettyprint">order_by</code> param</a> to Offers List</li>
</ul>

<h4 id="09-08-2019-piotr-witlicki">09.08.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Add <a href="#offers-admin">Offers Admin</a> section</li>
<li>Add <a href="#create-file">Files &bull; Create</a></li>
<li>Add <a href="#update-file">Files &bull; Update</a></li>
<li>Add <a href="#delete-file">Files &bull; Delete</a></li>
</ul>

<h4 id="08-08-2019-natalia-styrska">08.08.2019 | Natalia Styrska</h4>

<p>Stores</p>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/stores</code> (<a href="#store-list">Stores &bull; List</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/stores/:id</code> (<a href="#store-get">Stores &bull; Get</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/stores</code> (<a href="#store-create">Stores &bull; Create</a>)</li>
<li>Add <code class="prettyprint">PUT /v3/:loyalty_club_slug/stores</code> (<a href="#store-update">Stores &bull; Update</a>)</li>
<li>Add <code class="prettyprint">DELETE /v3/:loyalty_club_slug/stores</code> (<a href="#store-delete">Stores &bull; Delete</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/stores/malls</code> (<a href="#mall-list">Malls &bull; List</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/stores/malls/:id</code> (<a href="#mall-get">Malls &bull; Get</a>)</li>
</ul>

<h4 id="27-06-2019-piotr-witlicki">27.06.2019 | Piotr Åwitlicki</h4>

<ul>
<li>Introduce <a href="#rewards-program-levels-program">Levels</a> </li>
</ul>

<h4 id="13-05-2019-piotr-witlicki">13.05.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/translations</code> (<a href="#list-translations">Translations &bull; List</a>)</li>
</ul>

<h4 id="06-05-2019-piotr-witlicki">06.05.2019 | Piotr Åwitlicki:</h4>

<p>Offers</p>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/offers/meta</code> (<a href="#offers-meta">Offers &bull; Get offers meta</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/offers/:id</code> (<a href="#get-offer">Offers &bull; Get offer</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/offers</code> (<a href="#list-offers">Offers &bull; List offers</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/me/offers/:id/use</code> (<a href="#use-offer">Offers &bull; Use offer</a>)</li>
<li>Add <code class="prettyprint">PUT /v3/:loyalty_club_slug/members/me/offers/:id/like</code> (<a href="#like-offer">Offers &bull; Like offer</a>)</li>
<li>Add <code class="prettyprint">PUT /v3/:loyalty_club_slug/members/me/offers/:id/unlike</code> (<a href="#unlike-offer">Offers &bull; Unlike offer</a>)</li>
</ul>

<h4 id="16-04-2019-piotr-witlicki">16.04.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">X-Usage-Token</code> header to <a href="#rewards-use">Rewards &bull; Use</a></li>
</ul>

<h4 id="07-03-2019-piotr-witlicki">07.03.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/rewards-program/status/achievements_summary</code> (<a href="#rewards-program-achievements-summary">Rewards Program &bull; Achievements summary</a>)</li>
</ul>

<h4 id="06-03-2019-piotr-witlicki">06.03.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Add file schema info (<a href="#file-schema">General info&bull; Files schema</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/files/schema</code> (<a href="#get-file-schema">Files&bull; Get schema</a>)</li>
</ul>

<h4 id="27-02-2019-jakub-kruczek">27.02.2019 | Jakub Kruczek:</h4>

<ul>
<li>Extend consent definitions example (<a href="#loyalty-clubs-schema">Loyalty Clubs &bull; Get schema</a>)</li>
</ul>

<h4 id="27-02-2019-adam-ku">27.02.2019 | Adam KuÅ:</h4>

<ul>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/transactions</code> (<a href="#transactions-create">Transactions &bull; Create</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/transactions</code> (<a href="#transactions-list">Transactions &bull; List</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/transactions/:id</code> (<a href="#transactions-get">Transactions &bull; Get</a>)</li>
</ul>

<h4 id="19-02-2019-piotr-witlicki">19.02.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/:id/rewards-program/status</code> (<a href="#rewards-program-status-by-member-id">Rewards Program &bull; Get status by member ID</a>)</li>
</ul>

<h4 id="08-02-2019-piotr-witlicki">08.02.2019 | Piotr Åwitlicki:</h4>

<p>Boostcom Rewards draft</p>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/rewards-program/info</code> (<a href="#rewards-program-info">Rewards Program &bull; Get Info</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/me/rewards-program/join</code> (<a href="#rewards-program-join">Rewards Program &bull; Join</a>)</li>
<li>Add <code class="prettyprint">DELETE /v3/:loyalty_club_slug/members/me/rewards-program/leave</code> (<a href="#rewards-program-leave">Rewards Program &bull; Leave</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/rewards-program/status</code> (<a href="#rewards-program-status">Rewards Program &bull; Get status</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/rewards-program/rewards</code> (<a href="#rewards-list">Rewards &bull; List</a>)</li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/me/rewards-program/rewards/purchased</code> (<a href="#rewards-list-purchased">Rewards &bull; List purchased</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/me/rewards-program/rewards/:id/purchase</code> (<a href="#rewards-purchase">Rewards &bull; Purchase</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/me/rewards-program/rewards/:id/use</code> (<a href="#rewards-use">Rewards &bull; Use</a>)</li>
</ul>

<h4 id="07-02-2019-dominik-halat">07.02.2019 | Dominik Halat:</h4>

<ul>
<li>Remove <code class="prettyprint">shortening_enabled</code> param from Emails API (<a href="#emails-create">Emails &bull; Create</a>)</li>
</ul>

<h4 id="07-02-2019-piotr-witlicki">07.02.2019 | Piotr Åwitlicki:</h4>

<ul>
<li>Replace paths: <code class="prettyprint">/v3/loyalty_clubs/:loyalty_club_slug/</code> with <code class="prettyprint">/v3/:loyalty_clubs/</code> (old ones will still work)</li>
</ul>

<h4 id="25-01-2019-dominik-halat">25.01.2019 | Dominik Halat:</h4>

<ul>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/emails</code> (<a href="#emails-create">Emails &bull; Create</a>)</li>
<li>Add <code class="prettyprint">db_and_cache</code> response type for Member#person_id (<a href="#members-person-id">Get person id</a>)</li>
</ul>

<h4 id="14-12-2018-jakub-kruczek">14.12.2018 | Jakub Kruczek:</h4>

<ul>
<li>Add <code class="prettyprint">updated_at</code> to consents value on member</li>
</ul>

<h4 id="04-12-2018-piotr-witlicki">04.12.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">language</code> param to <code class="prettyprint">/v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_registration_password</code></li>
</ul>

<h4 id="13-11-2018-piotr-witlicki">13.11.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">PUT /v3/:loyalty_club_slug/members/channels/msisdn/:msisdn/send_verification</code>(<a href="#members-send-verification-sms">Members &bull; Send MSISDN verification SMS</a>)</li>
<li>Add <code class="prettyprint">PUT /v3/:loyalty_club_slug/members/channels/msisdn/:msisdn/verify</code> (<a href="#members-verify-msisdn">Members &bull; Verify MSISDN</a>)</li>
</ul>

<h4 id="08-11-2018-piotr-witlicki">08.11.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/smses</code> (<a href="#smses-create">SMSes &bull; Create</a>)</li>
</ul>

<h4 id="12-10-2018-piotr-witlicki">12.10.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members/imports/:import_id/bulks//by_request_number/:request_number</code></li>
</ul>

<h4 id="03-08-2018-piotr-witlicki">03.08.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <a href="#members-imports-import-flow">Members Import</a></li>
</ul>

<h4 id="27-04-2018-piotr-witlicki">27.04.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/by_email/:email/send_one_time_password</code> (<a href="#members-send-one-time-password-email">Members &bull; Send one time password E-mail</a>)</li>
</ul>

<h4 id="27-04-2018-piotr-witlicki">27.04.2018 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">channel</code> and <code class="prettyprint">subchannel</code> attributes to <code class="prettyprint">Member</code></li>
<li>Add <code class="prettyprint">validate_partially</code> param in (<a href="members-update">Members &bull; Update</a> and (<a href="#me-update">Me &bull; Update</a></li>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/products</code> (<a href="#loyalty-clubs-products">Loyalty Clubs &bull; List Products</a>)</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/push_notifications</code> (<a href="#push-notification-create">Push Notifications &bull; Create</a>)</li>
</ul>

<h4 id="11-04-2018-dominik-halat">11.04.2018 | Dominik Halat</h4>

<ul>
<li>Add <code class="prettyprint">person_id</code> to <code class="prettyprint">Member</code></li>
<li>Add new endpoint <code class="prettyprint">GET /v3/:loyalty_club_slug/members/person_id</code> (<a href="#members-index">Members &bull; List</a>)</li>
</ul>

<h4 id="01-02-2017-piotr-witlicki">01.02.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">ids</code> query param to <code class="prettyprint">GET /v3/:loyalty_club_slug/members</code> (<a href="#members-index">Members &bull; List</a>)</li>
</ul>

<h4 id="29-01-2017-piotr-witlicki">29.01.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">GET /v3/:loyalty_club_slug/members</code> (<a href="#members-index">Members &bull; List</a>)</li>
</ul>

<h4 id="22-01-2017-jakub-kruczek">22.01.2017 | Jakub Kruczek:</h4>

<ul>
<li>Update staging domain to: <code class="prettyprint">https://api.mpc.dev.placewise.com/</code></li>
</ul>

<h4 id="9-01-2017-piotr-witlicki">9.01.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Update staging domain to: <code class="prettyprint">https://bl-api.bl-stg.boostcom.cc/</code></li>
</ul>

<h4 id="4-01-2017-jakub-kruczek">4.01.2017 | Jakub Kruczek:</h4>

<ul>
<li>Add <code class="prettyprint">consents</code> fields to schema and Member payload</li>
</ul>

<h4 id="15-12-2017-piotr-witlicki">15.12.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_registration_password</code></li>
<li>Add information about <code class="prettyprint">registration_password</code> in <a href="#members-create">Members &bull; Create</a></li>
<li>Add some other minor fixes</li>
</ul>

<h4 id="10-11-2017-piotr-witlicki">10.11.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Restructurize the docs</li>
<li>Add <code class="prettyprint">POST /v3/:loyalty_club_slug/members/by_msisdn/:msisdn/send_one_time_password</code></li>
</ul>

<h4 id="27-10-2017-piotr-witlicki">27.10.2017 | Piotr Åwitlicki:</h4>

<ul>
<li>Rename <code class="prettyprint">/check_existance</code> endpoints to <code class="prettyprint">/public_info</code></li>
<li>Add :can_login attribute to <code class="prettyprint">/public_info</code> response</li>
<li>Remove :exists attribute from <code class="prettyprint">/public_info</code> response and make it to return nil when member does not exist</li>
</ul>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
